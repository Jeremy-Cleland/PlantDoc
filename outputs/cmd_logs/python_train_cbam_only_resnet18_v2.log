=== Command: PYTHONPATH=. python cli/main.py train ===
=== Started: 2025-04-15T17:26:15Z ===
=== Experiment: cbam_only_resnet18_v2 ===

2025-04-15 13:26:19 | INFO     | __main__ - Created new experiment directory: outputs/cbam_only_resnet18_v2
2025-04-15 13:26:19 | INFO     | __main__ - Starting training with model: cbam_only_resnet18
2025-04-15 13:26:19 | INFO     | __main__ - Experiment name: cbam_only_resnet18_v2
2025-04-15 13:26:19 | INFO     | __main__ - Experiment version: 3
2025-04-15 13:26:19 | INFO     | __main__ - Experiment directory: outputs/cbam_only_resnet18_v2
2025-04-15 13:26:19 | INFO     | __main__ - Log directory: outputs/cbam_only_resnet18_v2/logs
2025-04-15 13:26:19 | INFO     | __main__ - Metrics directory: outputs/cbam_only_resnet18_v2/metrics
2025-04-15 13:26:19 | INFO     | utils.mps_utils - Set random seed to 42 (deterministic=False)
2025-04-15 13:26:19 | INFO     | __main__ - ------ Execution Context ------
2025-04-15 13:26:19 | INFO     | __main__ - Command        : train
2025-04-15 13:26:19 | INFO     | __main__ - Model          : cbam_only_resnet18
2025-04-15 13:26:19 | INFO     | __main__ - Dataset        : PlantDisease
2025-04-15 13:26:19 | INFO     | __main__ - Output Dir     : N/A
2025-04-15 13:26:19 | INFO     | __main__ - Time           : 2025-04-15 13:26:19
2025-04-15 13:26:19 | INFO     | __main__ - -------------------------------
2025-04-15 13:26:19 | INFO     | core.data.datamodule - PlantDiseaseDataModule initialized.
2025-04-15 13:26:19 | INFO     | core.data.datamodule - Data directory: data/raw
2025-04-15 13:26:19 | INFO     | core.data.datamodule - Batch size: 128, Num workers: 6
2025-04-15 13:26:19 | INFO     | core.data.datamodule - Data preparation step completed (checking data existence).
2025-04-15 13:26:19 | INFO     | core.data.datamodule - Setting up DataModule for stage: None
2025-04-15 13:26:19 | INFO     | core.data.transforms - Applying training augmentations.
2025-04-15 13:26:19 | INFO     | core.data.transforms - Using RandAugment with 3 ops and magnitude 9
2025-04-15 13:26:19 | INFO     | core.data.transforms - Initialized RandAugment with num_ops=3, magnitude=9
2025-04-15 13:26:19 | INFO     | core.data.transforms - Applying val transformations (Resize -> CenterCrop).
2025-04-15 13:26:19 | INFO     | core.data.transforms - Applying test transformations (Resize -> CenterCrop).
2025-04-15 13:26:19 | INFO     | core.data.datasets - Inferring classes from subdirectories in data/raw.
2025-04-15 13:26:19 | INFO     | core.data.datasets - Loading samples for split 'train' from data/raw...
2025-04-15 13:26:20 | INFO     | core.data.datasets - Found 61486 potential image samples.
2025-04-15 13:26:20 | INFO     | core.data.datasets - Initialized dataset for split 'train' with 61486 samples from 39 classes.
2025-04-15 13:26:20 | INFO     | core.data.datamodule - Found 39 classes: ['Apple_Apple_scab', 'Apple_Black_rot', 'Apple_Cedar_apple_rust', 'Apple_healthy', 'Background_without_leaves', 'Blueberry_healthy', 'Cherry_Powdery_mildew', 'Cherry_healthy', 'Corn_Cercospora_leaf_spot_Gray_leaf_spot', 'Corn_Common_rust', 'Corn_Northern_Leaf_Blight', 'Corn_healthy', 'Grape_Black_rot', 'Grape_Esca_Black_Measles', 'Grape_Leaf_blight_Isariopsis_Leaf_Spot', 'Grape_healthy', 'Orange_Haunglongbing_Citrus_greening', 'Peach_Bacterial_spot', 'Peach_healthy', 'Pepper_bell_Bacterial_spot', 'Pepper_bell_healthy', 'Potato_Early_blight', 'Potato_Late_blight', 'Potato_healthy', 'Raspberry_healthy', 'Soybean_healthy', 'Squash_Powdery_mildew', 'Strawberry_Leaf_scorch', 'Strawberry_healthy', 'Tomato_Bacterial_spot', 'Tomato_Early_blight', 'Tomato_Late_blight', 'Tomato_Leaf_Mold', 'Tomato_Septoria_leaf_spot', 'Tomato_Spider_mites_Two-spotted_spider_mite', 'Tomato_Target_Spot', 'Tomato_Tomato_Yellow_Leaf_Curl_Virus', 'Tomato_Tomato_mosaic_virus', 'Tomato_healthy']
2025-04-15 13:26:20 | INFO     | core.data.datamodule - Pre-split directories not found. Splitting dataset on the fly.
2025-04-15 13:26:20 | INFO     | core.data.datamodule - Using split ratio: [0.7, 0.15, 0.15] and seed: 42
2025-04-15 13:26:20 | INFO     | core.data.datasets - Using provided class list.
2025-04-15 13:26:20 | INFO     | core.data.datasets - Loading samples for split 'all' from data/raw...
2025-04-15 13:26:20 | INFO     | core.data.datasets - Found 61486 potential image samples.
2025-04-15 13:26:20 | INFO     | core.data.datasets - Initialized dataset for split 'all' with 61486 samples from 39 classes.
2025-04-15 13:26:20 | INFO     | core.data.datamodule - Splitting into Train: 43040, Val: 9222, Test: 9224
2025-04-15 13:26:20 | INFO     | core.data.datasets - Using provided class list.
2025-04-15 13:26:20 | INFO     | core.data.datasets - Loading samples for split 'train' from data/raw...
2025-04-15 13:26:20 | INFO     | core.data.datasets - Found 61486 potential image samples.
2025-04-15 13:26:20 | INFO     | core.data.datasets - Initialized dataset for split 'train' with 61486 samples from 39 classes.
2025-04-15 13:26:20 | INFO     | core.data.datasets - Using provided class list.
2025-04-15 13:26:20 | INFO     | core.data.datasets - Loading samples for split 'val' from data/raw...
2025-04-15 13:26:20 | INFO     | core.data.datasets - Found 61486 potential image samples.
2025-04-15 13:26:20 | INFO     | core.data.datasets - Initialized dataset for split 'val' with 61486 samples from 39 classes.
2025-04-15 13:26:20 | INFO     | core.data.datasets - Using provided class list.
2025-04-15 13:26:20 | INFO     | core.data.datasets - Loading samples for split 'test' from data/raw...
2025-04-15 13:26:20 | INFO     | core.data.datasets - Found 61486 potential image samples.
2025-04-15 13:26:20 | INFO     | core.data.datasets - Initialized dataset for split 'test' with 61486 samples from 39 classes.
2025-04-15 13:26:20 | INFO     | core.data.datamodule - DataModule setup complete.
2025-04-15 13:26:20 | INFO     | core.data.datamodule - Train dataset size: 43040
2025-04-15 13:26:20 | INFO     | core.data.datamodule - Validation dataset size: 9222
2025-04-15 13:26:20 | INFO     | core.data.datamodule - Test dataset size: 9224
2025-04-15 13:26:20 | INFO     | core.models.backbones.cbam_resnet18 - Initialized CBAMResNet with cbam_reduction=8, drop_path_prob=0.25, spatial_kernel_size=5
2025-04-15 13:26:20 | INFO     | core.models.backbones.cbam_resnet18 - Loaded pretrained weights for ResNet18
2025-04-15 13:26:20 | INFO     | core.models.backbones.cbam_resnet18 - Froze all layers in CBAMResNet18Backbone
2025-04-15 13:26:20 | INFO     | core.models.backbones.cbam_resnet18 - Initialized feature fusion for multi-scale features
2025-04-15 13:26:20 | INFO     | core.models.backbones.cbam_resnet18 - Initialized CBAMResNet18Backbone with features=512
2025-04-15 13:26:20 | INFO     | core.models.heads.residual - Initialized ResidualHead with in_features=512, hidden_dim=256, num_classes=39
2025-04-15 13:26:20 | INFO     | core.models.base - Initialized BaseModel with backbone=cbam_resnet18, classes=39, pretrained=True, frozen_backbone=True
2025-04-15 13:26:20 | INFO     | core.models.model_cbam18 - Initialized CBAMResNet18Model with feature_fusion=True, use_residual_head=True, reduction_ratio=8, spatial_kernel_size=5
2025-04-15 13:26:20 | INFO     | utils.experiment_registry - Registered experiment: cbam_only_resnet18 v2 in outputs/cbam_only_resnet18_v2
2025-04-15 13:26:20 | INFO     | core.data.datamodule - Setting up weighted random sampler for training.
2025-04-15 13:26:20 | INFO     | core.training.train - No device specified, using: mps
2025-04-15 13:26:20 | INFO     | core.training.train - Created symlink to latest log: outputs/cbam_only_resnet18_v2/logs/latest_train.log
2025-04-15 13:26:20 | INFO     | plantdoc - Logging to file: outputs/cbam_only_resnet18_v2/logs/train_20250415_132620.log
2025-04-15 13:26:20 | INFO     | plantdoc.data - Logging to file: outputs/cbam_only_resnet18_v2/logs/train_20250415_132620.log
2025-04-15 13:26:20 | INFO     | plantdoc.models - Logging to file: outputs/cbam_only_resnet18_v2/logs/train_20250415_132620.log
2025-04-15 13:26:20 | INFO     | plantdoc.training - Logging to file: outputs/cbam_only_resnet18_v2/logs/train_20250415_132620.log
2025-04-15 13:26:20 | INFO     | plantdoc.evaluation - Logging to file: outputs/cbam_only_resnet18_v2/logs/train_20250415_132620.log
2025-04-15 13:26:20 | INFO     | plantdoc.prediction - Logging to file: outputs/cbam_only_resnet18_v2/logs/train_20250415_132620.log
2025-04-15 13:26:20 | INFO     | plantdoc.cli - Logging to file: outputs/cbam_only_resnet18_v2/logs/train_20250415_132620.log
2025-04-15 13:26:20 | INFO     | plantdoc.utils - Logging to file: outputs/cbam_only_resnet18_v2/logs/train_20250415_132620.log
2025-04-15 13:26:20 | INFO     | plantdoc - Initialized log file: outputs/cbam_only_resnet18_v2/logs/train_20250415_132620.log
2025-04-15 13:26:20 | INFO     | plantdoc - Logging initialized. Level: INFO | Log dir: outputs/cbam_only_resnet18_v2/logs
2025-04-15 13:26:20 | INFO     | core.training.train - Logging configured to save in: outputs/cbam_only_resnet18_v2/logs/train_20250415_132620.log
2025-04-15 13:26:20 | INFO     | core.training.train - Experiment directory: outputs/cbam_only_resnet18_v2
2025-04-15 13:26:20 | INFO     | core.training.train - Set up 39 class names for GradCAM visualization
2025-04-15 13:26:20 | INFO     | core.training.train - Setting up test data for GradCAM visualization from validation data
2025-04-15 13:26:20 | INFO     | core.training.train - Set up 10 test samples for GradCAM visualization
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding MetricsLogger callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Using metrics_dir from config: outputs/cbam_only_resnet18_v2/metrics
2025-04-15 13:26:20 | INFO     | core.training.callbacks.metrics_logger - Initialized MetricsLogger: format='json', overwrite=True
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding ModelCheckpoint callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Using checkpoint_dir from experiment_dir: outputs/cbam_only_resnet18_v2/checkpoints
2025-04-15 13:26:20 | INFO     | core.training.callbacks.model_checkpoint - Model checkpoints will be saved to: /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/checkpoints
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding EarlyStopping callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.early_stopping - Initialized EarlyStopping: monitor='val_loss', patience=15, mode='min', min_delta=0.001, restore_best=False
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding GradCAM visualization callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Using gradcam_dir from experiment_dir: outputs/cbam_only_resnet18_v2/gradcam
2025-04-15 13:26:20 | INFO     | core.training.callbacks.gradcam_callback - Initialized GradCAMCallback: frequency=10, n_samples=10
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding ConfidenceMonitor callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.confidence_monitor - Initialized ConfidenceMonitorCallback: Freq=1, Warn=0.70, ECE Bins=15, PerClass=True, SaveViz=True
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding SWA callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.swa - Initialized SWACallback: start_frac=0.5, swa_lr=0.0002, anneal_epochs=10, update_bn_freq=5
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding AdaptiveWeightAdjustment callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.adaptive_weight - Initialized AdaptiveWeightAdjustmentCallback: adjust_freq=5, gamma_range=(2.0, 5.0), center_weight_range=(0.5, 2.0)
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding SHAP callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.shap_callback - Initialized SHAP callback: samples=20, background_samples=20, dataset=test
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding default VisualizationDataSaver callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.visualization_data_saver - VisualizationDataSaver initialized with experiment_dir: outputs/cbam_only_resnet18_v2
2025-04-15 13:26:20 | INFO     | utils.mps_utils - Set random seed to 42 (deterministic=False)
2025-04-15 13:26:20 | INFO     | core.training.train - Set MPS manual seed to 42
2025-04-15 13:26:20 | INFO     | utils.mps_utils - Set MPS memory limit to 85% of available memory
2025-04-15 13:26:20 | INFO     | core.training.train - Set MPS memory limit fraction to 0.85
2025-04-15 13:26:20 | INFO     | core.training.train - Converting model to channels_last format for MPS.
2025-04-15 13:26:20 | INFO     | core.training.optimizers - Creating 'adamw' optimizer.
2025-04-15 13:26:20 | INFO     | core.training.optimizers -   Base LR: 5.00e-04, Weight Decay: 5.00e-05
2025-04-15 13:26:20 | INFO     | core.training.optimizers -   Using differential LR with factor: 0.1
2025-04-15 13:26:20 | INFO     | core.training.optimizers -   Backbone group: LR=5.00e-05, Weight Decay=5.00e-05
2025-04-15 13:26:20 | INFO     | core.training.optimizers -   Head group:     LR=5.00e-04, Weight Decay=5.00e-05
2025-04-15 13:26:20 | INFO     | core.training.optimizers - Optimizer 'AdamW' created successfully.
2025-04-15 13:26:20 | INFO     | core.training.loss - Initializing loss function: 'combined'
2025-04-15 13:26:20 | INFO     | core.training.loss - Initializing loss function: 'weightedcrossentropy'
2025-04-15 13:26:20 | INFO     | core.training.loss -   Added component weighted_cross_entropy with weight 0.7
2025-04-15 13:26:20 | INFO     | core.training.loss - Initializing loss function: 'focal'
2025-04-15 13:26:20 | INFO     | core.training.loss -   Using FocalLoss with alpha=0.25, gamma=2.5, reduction='mean', label_smoothing=0.0
2025-04-15 13:26:20 | INFO     | core.training.loss - Initialized FocalLoss with gamma=2.5, alpha=0.25
2025-04-15 13:26:20 | INFO     | core.training.loss -   Added component focal with weight 0.7
2025-04-15 13:26:20 | INFO     | core.training.schedulers - Creating 'cosineannealingwarmrestarts' learning rate scheduler.
2025-04-15 13:26:20 | WARNING  | core.training.schedulers - Unsupported scheduler: 'cosineannealingwarmrestarts'
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding MetricsLogger callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Using metrics_dir from config: outputs/cbam_only_resnet18_v2/metrics
2025-04-15 13:26:20 | INFO     | core.training.callbacks.metrics_logger - Initialized MetricsLogger: format='json', overwrite=True
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding ModelCheckpoint callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Using checkpoint_dir from experiment_dir: outputs/cbam_only_resnet18_v2/checkpoints
2025-04-15 13:26:20 | INFO     | core.training.callbacks.model_checkpoint - Model checkpoints will be saved to: /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/checkpoints
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding EarlyStopping callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.early_stopping - Initialized EarlyStopping: monitor='val_loss', patience=15, mode='min', min_delta=0.001, restore_best=False
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding ConfidenceMonitor callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.confidence_monitor - Initialized ConfidenceMonitorCallback: Freq=1, Warn=0.70, ECE Bins=15, PerClass=True, SaveViz=True
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding SWA callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.swa - Initialized SWACallback: start_frac=0.5, swa_lr=0.0002, anneal_epochs=10, update_bn_freq=5
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding AdaptiveWeightAdjustment callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.adaptive_weight - Initialized AdaptiveWeightAdjustmentCallback: adjust_freq=5, gamma_range=(2.0, 5.0), center_weight_range=(0.5, 2.0)
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding SHAP callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.shap_callback - Initialized SHAP callback: samples=20, background_samples=20, dataset=test
2025-04-15 13:26:20 | INFO     | core.training.callbacks.utils - Adding default VisualizationDataSaver callback
2025-04-15 13:26:20 | INFO     | core.training.callbacks.visualization_data_saver - VisualizationDataSaver initialized with experiment_dir: outputs/cbam_only_resnet18_v2
2025-04-15 13:26:20 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Using 39 class names from config
2025-04-15 13:26:20 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Set output directory to outputs/cbam_only_resnet18_v2/reports/plots/confidence
2025-04-15 13:26:20 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Using 39 class names from config
2025-04-15 13:26:20 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Set output directory to outputs/cbam_only_resnet18_v2/reports/plots/confidence
2025-04-15 13:26:20 | INFO     | core.training.callbacks.metrics_logger - MetricsLogger received config from trainer context
2025-04-15 13:26:20 | INFO     | core.training.callbacks.metrics_logger - MetricsLogger received experiment_dir: outputs/cbam_only_resnet18_v2
2025-04-15 13:26:20 | INFO     | core.training.callbacks.metrics_logger - MetricsLogger received config from trainer context
2025-04-15 13:26:20 | INFO     | core.training.callbacks.metrics_logger - MetricsLogger received experiment_dir: outputs/cbam_only_resnet18_v2
2025-04-15 13:26:20 | INFO     | core.training.callbacks.visualization_data_saver - VisualizationDataSaver received trainer context: model=True, train_loader=True, val_loader=True, config=True
2025-04-15 13:26:20 | INFO     | core.training.callbacks.visualization_data_saver - VisualizationDataSaver received trainer context: model=True, train_loader=True, val_loader=True, config=True
2025-04-15 13:26:20 | INFO     | core.training.train - Using MPS mixed precision (float16).
2025-04-15 13:26:20 | INFO     | core.training.train - Transfer learning: Backbone frozen for first 10 epochs.
2025-04-15 13:26:20 | INFO     | core.models.backbones.cbam_resnet18 - Froze all layers in CBAMResNet18Backbone
2025-04-15 13:26:20 | INFO     | core.models.model_cbam18 - Froze CBAM-ResNet18 backbone layers
2025-04-15 13:26:20 | INFO     | core.training.train - Trainer initialization complete.
2025-04-15 13:26:20 | INFO     | core.training.train - Copied config to outputs/cbam_only_resnet18_v2/config.yaml
2025-04-15 13:26:21 | INFO     | core.training.train - ===== Starting Training for 100 Epochs =====
2025-04-15 13:26:21 | INFO     | core.training.train - Device: mps
2025-04-15 13:26:21 | INFO     | core.training.train - Mixed Precision: Enabled (mps mode)
2025-04-15 13:26:21 | INFO     | core.training.train - Using 'val_loss' (mode: min) from ModelCheckpoint for best epoch logic.
2025-04-15 13:26:21 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment: Found ConfidenceMonitorCallback instance.
2025-04-15 13:26:21 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment: Found Focal Loss at index 1 of combined loss.
2025-04-15 13:26:21 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment: Found ConfidenceMonitorCallback instance.
2025-04-15 13:26:21 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment: Found Focal Loss at index 1 of combined loss.
2025-04-15 13:26:21 | INFO     | core.training.callbacks.metrics_logger - Saved training parameters to outputs/cbam_only_resnet18_v2/metrics/training_params.json
2025-04-15 13:26:21 | INFO     | core.training.callbacks.metrics_logger - Saved training parameters to outputs/cbam_only_resnet18_v2/metrics/training_params.json
2025-04-15 13:26:21 | INFO     | core.training.callbacks.metrics_logger - Saved training parameters to outputs/cbam_only_resnet18_v2/metrics/training_params.json
2025-04-15 13:26:21 | INFO     | core.training.callbacks.metrics_logger - Saved training parameters to outputs/cbam_only_resnet18_v2/metrics/training_params.json
2025-04-15 13:26:21 | INFO     | core.training.callbacks.swa - SWACallback: Creating internal AveragedModel.
2025-04-15 13:26:21 | INFO     | core.training.callbacks.swa - SWACallback: Target start epoch: 50
2025-04-15 13:26:21 | INFO     | core.training.callbacks.swa - SWACallback: Creating internal AveragedModel.
2025-04-15 13:26:21 | INFO     | core.training.callbacks.swa - SWACallback: Target start epoch: 50
2025-04-15 13:27:38 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:27:38 | INFO     | core.training.train - Epoch 1 [Initial] Train: Loss=48.7869, Acc=0.3070, Prec=0.3363, Rec=0.3070, F1=0.2830 (76.99s)
2025-04-15 13:28:15 | INFO     | core.training.train - Epoch 1 [Initial] Val:   Loss=14.4110, Acc=0.7788, Prec=0.7921, Rec=0.7788, F1=0.7678 (37.23s)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 1): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:28:16 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 1): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 1): Computing metrics during frozen backbone phase.
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 1.
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 1) ---
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.7788
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.4270 | Median: 0.4077 | Min: 0.0607
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    86.03% (7934/9222)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.3518
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.1699 (Count: 42)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.2173 (Count: 94)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.1977 (Count: 113)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.4256 (Count: 179)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.5716 (Count: 134)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.4798 (Count: 197)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.3636 (Count: 109)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.4548 (Count: 124)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.5571 (Count: 109)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.7446 (Count: 163)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.5163 (Count: 127)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.7618 (Count: 144)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.3613 (Count: 141)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.4503 (Count: 105)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.4809 (Count: 156)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.4578 (Count: 140)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.5970 (Count: 766)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.4255 (Count: 273)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.4837 (Count: 135)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.3376 (Count: 84)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.4653 (Count: 172)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.3378 (Count: 132)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.1331 (Count: 49)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.4365 (Count: 125)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.4339 (Count: 121)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.6792 (Count: 723)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.6194 (Count: 262)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.4686 (Count: 125)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.3810 (Count: 117)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.3965 (Count: 233)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.1613 (Count: 27)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.2223 (Count: 115)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.1358 (Count: 29)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.1730 (Count: 124)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.2682 (Count: 225)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.2693 (Count: 128)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.5525 (Count: 759)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.3546 (Count: 148)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.3997 (Count: 233)
2025-04-15 13:28:16 | WARNING  | core.training.callbacks.confidence_monitor - Epoch 1: Mean confidence (0.4270) below threshold (0.70)!
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 1): Computing metrics during frozen backbone phase.
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 1.
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 1) ---
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.7788
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.4270 | Median: 0.4077 | Min: 0.0607
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    86.03% (7934/9222)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.3518
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.1699 (Count: 42)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.2173 (Count: 94)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.1977 (Count: 113)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.4256 (Count: 179)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.5716 (Count: 134)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.4798 (Count: 197)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.3636 (Count: 109)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.4548 (Count: 124)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.5571 (Count: 109)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.7446 (Count: 163)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.5163 (Count: 127)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.7618 (Count: 144)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.3613 (Count: 141)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.4503 (Count: 105)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.4809 (Count: 156)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.4578 (Count: 140)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.5970 (Count: 766)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.4255 (Count: 273)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.4837 (Count: 135)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.3376 (Count: 84)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.4653 (Count: 172)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.3378 (Count: 132)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.1331 (Count: 49)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.4365 (Count: 125)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.4339 (Count: 121)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.6792 (Count: 723)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.6194 (Count: 262)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.4686 (Count: 125)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.3810 (Count: 117)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.3965 (Count: 233)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.1613 (Count: 27)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.2223 (Count: 115)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.1358 (Count: 29)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.1730 (Count: 124)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.2682 (Count: 225)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.2693 (Count: 128)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.5525 (Count: 759)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.3546 (Count: 148)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.3997 (Count: 233)
2025-04-15 13:28:16 | WARNING  | core.training.callbacks.confidence_monitor - Epoch 1: Mean confidence (0.4270) below threshold (0.70)!
2025-04-15 13:28:16 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 1)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 1)
2025-04-15 13:28:16 | INFO     | core.training.callbacks.gradcam_callback - Skipping GradCAM for epoch 1 (backbone frozen).
2025-04-15 13:28:16 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 1: Captured validation outputs and targets for visualization.
2025-04-15 13:28:16 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 1: Captured validation outputs and targets for visualization.
2025-04-15 13:29:06 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:29:06 | INFO     | core.training.train - Epoch 2 [Initial] Train: Loss=27.9503, Acc=0.5224, Prec=0.5161, Rec=0.5224, F1=0.5135 (49.30s)
2025-04-15 13:29:14 | INFO     | core.training.train - Epoch 2 [Initial] Val:   Loss=7.1404, Acc=0.8370, Prec=0.8471, Rec=0.8370, F1=0.8331 (7.66s)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 2): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:29:14 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 2): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 2): Computing metrics during frozen backbone phase.
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 2.
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 2) ---
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.8370
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.6334 | Median: 0.6475 | Min: 0.0943
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    56.81% (5239/9222)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.2036
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.3882 (Count: 81)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.5277 (Count: 121)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.4765 (Count: 127)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.6952 (Count: 219)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.8186 (Count: 148)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.7200 (Count: 200)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.6395 (Count: 111)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.6941 (Count: 128)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6472 (Count: 116)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.8042 (Count: 168)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6206 (Count: 130)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.8771 (Count: 147)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.4683 (Count: 102)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.5968 (Count: 170)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.6012 (Count: 159)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.6045 (Count: 134)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9520 (Count: 787)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.6965 (Count: 303)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.7191 (Count: 145)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.6717 (Count: 132)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.6214 (Count: 180)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.6862 (Count: 155)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.4888 (Count: 102)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.5563 (Count: 127)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.6149 (Count: 130)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.7945 (Count: 756)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.7257 (Count: 266)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.6919 (Count: 163)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.5916 (Count: 109)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.6670 (Count: 280)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.3705 (Count: 50)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.5320 (Count: 160)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.4668 (Count: 71)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.3920 (Count: 178)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.5631 (Count: 239)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.4836 (Count: 139)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.7299 (Count: 729)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.4071 (Count: 83)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.5959 (Count: 174)
2025-04-15 13:29:14 | WARNING  | core.training.callbacks.confidence_monitor - Epoch 2: Mean confidence (0.6334) below threshold (0.70)!
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 2): Computing metrics during frozen backbone phase.
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 2.
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 2) ---
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.8370
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.6334 | Median: 0.6475 | Min: 0.0943
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    56.81% (5239/9222)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.2036
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.3882 (Count: 81)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.5277 (Count: 121)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.4765 (Count: 127)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.6952 (Count: 219)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.8186 (Count: 148)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.7200 (Count: 200)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.6395 (Count: 111)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.6941 (Count: 128)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6472 (Count: 116)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.8042 (Count: 168)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6206 (Count: 130)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.8771 (Count: 147)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.4683 (Count: 102)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.5968 (Count: 170)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.6012 (Count: 159)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.6045 (Count: 134)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9520 (Count: 787)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.6965 (Count: 303)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.7191 (Count: 145)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.6717 (Count: 132)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.6214 (Count: 180)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.6862 (Count: 155)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.4888 (Count: 102)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.5563 (Count: 127)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.6149 (Count: 130)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.7945 (Count: 756)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.7257 (Count: 266)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.6919 (Count: 163)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.5916 (Count: 109)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.6670 (Count: 280)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.3705 (Count: 50)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.5320 (Count: 160)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.4668 (Count: 71)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.3920 (Count: 178)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.5631 (Count: 239)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.4836 (Count: 139)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.7299 (Count: 729)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.4071 (Count: 83)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.5959 (Count: 174)
2025-04-15 13:29:14 | WARNING  | core.training.callbacks.confidence_monitor - Epoch 2: Mean confidence (0.6334) below threshold (0.70)!
2025-04-15 13:29:14 | INFO     | core.training.callbacks.model_checkpoint - Epoch 2: val_loss improved from 14.411038 to 7.140446.
2025-04-15 13:29:14 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 2)
2025-04-15 13:29:14 | INFO     | core.training.callbacks.model_checkpoint - Epoch 2: val_loss improved from 14.411038 to 7.140446.
2025-04-15 13:29:15 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 2)
2025-04-15 13:29:15 | INFO     | core.training.callbacks.early_stopping - Epoch 2: EarlyStopping val_loss improved from 14.411038 to 7.140446
2025-04-15 13:29:15 | INFO     | core.training.callbacks.early_stopping - Epoch 2: EarlyStopping val_loss improved from 14.411038 to 7.140446
2025-04-15 13:29:15 | INFO     | core.training.callbacks.gradcam_callback - Skipping GradCAM for epoch 2 (backbone frozen).
2025-04-15 13:29:15 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 2: Captured validation outputs and targets for visualization.
2025-04-15 13:29:15 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 2: Captured validation outputs and targets for visualization.
2025-04-15 13:30:00 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:30:00 | INFO     | core.training.train - Epoch 3 [Initial] Train: Loss=22.3517, Acc=0.5835, Prec=0.5784, Rec=0.5835, F1=0.5789 (45.76s)
2025-04-15 13:30:08 | INFO     | core.training.train - Epoch 3 [Initial] Val:   Loss=4.8128, Acc=0.8847, Prec=0.8922, Rec=0.8847, F1=0.8839 (7.66s)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 3): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:30:09 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 3): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 3): Computing metrics during frozen backbone phase.
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 3.
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 3) ---
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.8847
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.7176 | Median: 0.7664 | Min: 0.1213
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    41.28% (3807/9222)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1671
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.5735 (Count: 129)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.6836 (Count: 131)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.7135 (Count: 143)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.6930 (Count: 212)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9093 (Count: 152)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.7992 (Count: 199)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.7810 (Count: 117)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8210 (Count: 129)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6668 (Count: 117)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.8483 (Count: 173)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6347 (Count: 140)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9143 (Count: 148)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.5849 (Count: 142)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6321 (Count: 153)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.7444 (Count: 177)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.7566 (Count: 156)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9315 (Count: 785)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.7161 (Count: 309)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.7348 (Count: 134)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.7296 (Count: 127)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.7808 (Count: 211)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.7957 (Count: 155)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.6871 (Count: 118)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.6761 (Count: 131)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.6283 (Count: 121)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8098 (Count: 746)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.8985 (Count: 283)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.8015 (Count: 159)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.6111 (Count: 118)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.7575 (Count: 295)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.4964 (Count: 80)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.5598 (Count: 162)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.6115 (Count: 75)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.6425 (Count: 245)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.6357 (Count: 221)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.5893 (Count: 179)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.8382 (Count: 770)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.5812 (Count: 123)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.6690 (Count: 194)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 3): Computing metrics during frozen backbone phase.
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 3.
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 3) ---
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.8847
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.7176 | Median: 0.7664 | Min: 0.1213
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    41.28% (3807/9222)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1671
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.5735 (Count: 129)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.6836 (Count: 131)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.7135 (Count: 143)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.6930 (Count: 212)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9093 (Count: 152)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.7992 (Count: 199)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.7810 (Count: 117)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8210 (Count: 129)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6668 (Count: 117)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.8483 (Count: 173)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6347 (Count: 140)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9143 (Count: 148)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.5849 (Count: 142)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6321 (Count: 153)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.7444 (Count: 177)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.7566 (Count: 156)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9315 (Count: 785)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.7161 (Count: 309)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.7348 (Count: 134)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.7296 (Count: 127)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.7808 (Count: 211)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.7957 (Count: 155)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.6871 (Count: 118)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.6761 (Count: 131)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.6283 (Count: 121)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8098 (Count: 746)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.8985 (Count: 283)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.8015 (Count: 159)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.6111 (Count: 118)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.7575 (Count: 295)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.4964 (Count: 80)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.5598 (Count: 162)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.6115 (Count: 75)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.6425 (Count: 245)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.6357 (Count: 221)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.5893 (Count: 179)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.8382 (Count: 770)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.5812 (Count: 123)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.6690 (Count: 194)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.model_checkpoint - Epoch 3: val_loss improved from 7.140446 to 4.812849.
2025-04-15 13:30:09 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 3)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.model_checkpoint - Epoch 3: val_loss improved from 7.140446 to 4.812849.
2025-04-15 13:30:09 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 3)
2025-04-15 13:30:09 | INFO     | core.training.callbacks.early_stopping - Epoch 3: EarlyStopping val_loss improved from 7.140446 to 4.812849
2025-04-15 13:30:09 | INFO     | core.training.callbacks.early_stopping - Epoch 3: EarlyStopping val_loss improved from 7.140446 to 4.812849
2025-04-15 13:30:09 | INFO     | core.training.callbacks.gradcam_callback - Skipping GradCAM for epoch 3 (backbone frozen).
2025-04-15 13:30:09 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 3: Captured validation outputs and targets for visualization.
2025-04-15 13:30:09 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 3: Captured validation outputs and targets for visualization.
2025-04-15 13:30:59 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:30:59 | INFO     | core.training.train - Epoch 4 [Initial] Train: Loss=19.8863, Acc=0.6160, Prec=0.6119, Rec=0.6160, F1=0.6127 (49.20s)
2025-04-15 13:31:07 | INFO     | core.training.train - Epoch 4 [Initial] Val:   Loss=4.2490, Acc=0.8950, Prec=0.9037, Rec=0.8950, F1=0.8954 (7.93s)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 4): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:31:07 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 4): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 4): Computing metrics during frozen backbone phase.
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 4.
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 4) ---
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.8950
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.7460 | Median: 0.8002 | Min: 0.1203
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    36.99% (3411/9222)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1490
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.5758 (Count: 123)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.7469 (Count: 128)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.6459 (Count: 131)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.7346 (Count: 220)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.8914 (Count: 151)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.8089 (Count: 201)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.7986 (Count: 122)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8593 (Count: 134)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6929 (Count: 132)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9350 (Count: 176)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6440 (Count: 136)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9449 (Count: 149)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.6489 (Count: 148)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6253 (Count: 139)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.6362 (Count: 156)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.8414 (Count: 154)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.8811 (Count: 759)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.7849 (Count: 315)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8259 (Count: 143)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.7112 (Count: 112)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8496 (Count: 214)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.7959 (Count: 153)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7562 (Count: 126)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7006 (Count: 133)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.6891 (Count: 125)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8322 (Count: 760)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.8734 (Count: 279)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.8523 (Count: 161)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.7266 (Count: 124)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.7964 (Count: 306)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.5257 (Count: 76)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.6195 (Count: 202)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.6412 (Count: 93)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.6289 (Count: 256)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7090 (Count: 223)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7005 (Count: 196)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.8767 (Count: 752)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.6001 (Count: 135)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.7556 (Count: 211)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 4): Computing metrics during frozen backbone phase.
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 4.
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 4) ---
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.8950
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.7460 | Median: 0.8002 | Min: 0.1203
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    36.99% (3411/9222)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1490
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.5758 (Count: 123)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.7469 (Count: 128)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.6459 (Count: 131)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.7346 (Count: 220)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.8914 (Count: 151)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.8089 (Count: 201)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.7986 (Count: 122)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8593 (Count: 134)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6929 (Count: 132)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9350 (Count: 176)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6440 (Count: 136)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9449 (Count: 149)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.6489 (Count: 148)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6253 (Count: 139)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.6362 (Count: 156)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.8414 (Count: 154)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.8811 (Count: 759)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.7849 (Count: 315)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8259 (Count: 143)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.7112 (Count: 112)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8496 (Count: 214)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.7959 (Count: 153)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7562 (Count: 126)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7006 (Count: 133)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.6891 (Count: 125)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8322 (Count: 760)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.8734 (Count: 279)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.8523 (Count: 161)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.7266 (Count: 124)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.7964 (Count: 306)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.5257 (Count: 76)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.6195 (Count: 202)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.6412 (Count: 93)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.6289 (Count: 256)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7090 (Count: 223)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7005 (Count: 196)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.8767 (Count: 752)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.6001 (Count: 135)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.7556 (Count: 211)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.model_checkpoint - Epoch 4: val_loss improved from 4.812849 to 4.249020.
2025-04-15 13:31:07 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 4)
2025-04-15 13:31:07 | INFO     | core.training.callbacks.model_checkpoint - Epoch 4: val_loss improved from 4.812849 to 4.249020.
2025-04-15 13:31:08 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 4)
2025-04-15 13:31:08 | INFO     | core.training.callbacks.early_stopping - Epoch 4: EarlyStopping val_loss improved from 4.812849 to 4.249020
2025-04-15 13:31:08 | INFO     | core.training.callbacks.early_stopping - Epoch 4: EarlyStopping val_loss improved from 4.812849 to 4.249020
2025-04-15 13:31:08 | INFO     | core.training.callbacks.gradcam_callback - Skipping GradCAM for epoch 4 (backbone frozen).
2025-04-15 13:31:08 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 4: Captured validation outputs and targets for visualization.
2025-04-15 13:31:08 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 4: Captured validation outputs and targets for visualization.
2025-04-15 13:31:53 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:31:53 | INFO     | core.training.train - Epoch 5 [Initial] Train: Loss=18.5352, Acc=0.6325, Prec=0.6288, Rec=0.6325, F1=0.6298 (45.66s)
2025-04-15 13:32:01 | INFO     | core.training.train - Epoch 5 [Initial] Val:   Loss=3.2474, Acc=0.9259, Prec=0.9298, Rec=0.9259, F1=0.9256 (7.71s)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 5): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:32:02 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 5): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 5): Computing metrics during frozen backbone phase.
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 5.
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 5) ---
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9259
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.7852 | Median: 0.8496 | Min: 0.1207
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    29.04% (2678/9222)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1408
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.6938 (Count: 129)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.7930 (Count: 132)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.8752 (Count: 149)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.7995 (Count: 231)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9321 (Count: 155)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.8770 (Count: 203)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.8203 (Count: 120)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.7552 (Count: 126)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6618 (Count: 94)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.8938 (Count: 171)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7350 (Count: 152)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9676 (Count: 149)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.6949 (Count: 157)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6349 (Count: 145)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.7689 (Count: 170)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.8098 (Count: 154)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9492 (Count: 788)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.8645 (Count: 342)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8361 (Count: 147)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.7832 (Count: 139)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8316 (Count: 215)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8629 (Count: 158)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7128 (Count: 115)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7369 (Count: 135)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.6626 (Count: 124)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8364 (Count: 752)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9493 (Count: 286)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.8239 (Count: 163)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.6853 (Count: 125)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.7646 (Count: 306)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.5538 (Count: 92)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.6628 (Count: 260)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.5969 (Count: 117)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.6649 (Count: 255)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.6261 (Count: 204)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.6632 (Count: 203)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9004 (Count: 776)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.7932 (Count: 156)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8577 (Count: 244)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 5): Computing metrics during frozen backbone phase.
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 5.
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 5) ---
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9259
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.7852 | Median: 0.8496 | Min: 0.1207
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    29.04% (2678/9222)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1408
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.6938 (Count: 129)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.7930 (Count: 132)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.8752 (Count: 149)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.7995 (Count: 231)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9321 (Count: 155)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.8770 (Count: 203)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.8203 (Count: 120)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.7552 (Count: 126)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6618 (Count: 94)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.8938 (Count: 171)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7350 (Count: 152)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9676 (Count: 149)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.6949 (Count: 157)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6349 (Count: 145)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.7689 (Count: 170)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.8098 (Count: 154)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9492 (Count: 788)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.8645 (Count: 342)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8361 (Count: 147)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.7832 (Count: 139)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8316 (Count: 215)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8629 (Count: 158)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7128 (Count: 115)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7369 (Count: 135)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.6626 (Count: 124)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8364 (Count: 752)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9493 (Count: 286)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.8239 (Count: 163)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.6853 (Count: 125)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.7646 (Count: 306)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.5538 (Count: 92)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.6628 (Count: 260)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.5969 (Count: 117)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.6649 (Count: 255)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.6261 (Count: 204)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.6632 (Count: 203)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9004 (Count: 776)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.7932 (Count: 156)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8577 (Count: 244)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.model_checkpoint - Epoch 5: val_loss improved from 4.249020 to 3.247435.
2025-04-15 13:32:02 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 5)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.model_checkpoint - Epoch 5: val_loss improved from 4.249020 to 3.247435.
2025-04-15 13:32:02 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 5)
2025-04-15 13:32:02 | INFO     | core.training.callbacks.early_stopping - Epoch 5: EarlyStopping val_loss improved from 4.249020 to 3.247435
2025-04-15 13:32:02 | INFO     | core.training.callbacks.early_stopping - Epoch 5: EarlyStopping val_loss improved from 4.249020 to 3.247435
2025-04-15 13:32:02 | INFO     | core.training.callbacks.gradcam_callback - Skipping GradCAM for epoch 5 (backbone frozen).
2025-04-15 13:32:02 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 5: Captured validation outputs and targets for visualization.
2025-04-15 13:32:02 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 5: Captured validation outputs and targets for visualization.
2025-04-15 13:32:53 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:32:53 | INFO     | core.training.train - Epoch 6 [Initial] Train: Loss=17.2779, Acc=0.6538, Prec=0.6507, Rec=0.6538, F1=0.6516 (50.51s)
2025-04-15 13:33:01 | INFO     | core.training.train - Epoch 6 [Initial] Val:   Loss=3.0456, Acc=0.9292, Prec=0.9325, Rec=0.9292, F1=0.9288 (8.06s)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 6): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:33:02 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 6): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 6): Computing metrics during frozen backbone phase.
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 6.
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 6) ---
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9292
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.7964 | Median: 0.8603 | Min: 0.1676
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    28.12% (2593/9222)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1329
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7277 (Count: 139)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.7823 (Count: 130)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.8405 (Count: 149)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8136 (Count: 232)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9389 (Count: 158)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.8713 (Count: 202)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.8320 (Count: 129)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8371 (Count: 129)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6568 (Count: 96)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9083 (Count: 177)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7082 (Count: 151)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9726 (Count: 149)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.6467 (Count: 146)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6754 (Count: 162)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.7720 (Count: 177)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.7777 (Count: 152)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9473 (Count: 787)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.8917 (Count: 342)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.7973 (Count: 146)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8271 (Count: 144)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.7643 (Count: 205)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.7559 (Count: 148)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7314 (Count: 114)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.6280 (Count: 119)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.7445 (Count: 133)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9059 (Count: 772)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.8953 (Count: 279)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.8919 (Count: 164)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.7987 (Count: 131)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8160 (Count: 315)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6076 (Count: 96)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7194 (Count: 255)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.6470 (Count: 114)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7465 (Count: 268)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.6925 (Count: 240)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.6525 (Count: 176)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9063 (Count: 774)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.6697 (Count: 145)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.7654 (Count: 224)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 6): Computing metrics during frozen backbone phase.
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 6.
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 6) ---
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9292
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.7964 | Median: 0.8603 | Min: 0.1676
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    28.12% (2593/9222)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1329
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7277 (Count: 139)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.7823 (Count: 130)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.8405 (Count: 149)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8136 (Count: 232)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9389 (Count: 158)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.8713 (Count: 202)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.8320 (Count: 129)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8371 (Count: 129)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6568 (Count: 96)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9083 (Count: 177)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7082 (Count: 151)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9726 (Count: 149)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.6467 (Count: 146)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6754 (Count: 162)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.7720 (Count: 177)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.7777 (Count: 152)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9473 (Count: 787)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.8917 (Count: 342)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.7973 (Count: 146)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8271 (Count: 144)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.7643 (Count: 205)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.7559 (Count: 148)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7314 (Count: 114)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.6280 (Count: 119)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.7445 (Count: 133)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9059 (Count: 772)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.8953 (Count: 279)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.8919 (Count: 164)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.7987 (Count: 131)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8160 (Count: 315)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6076 (Count: 96)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7194 (Count: 255)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.6470 (Count: 114)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7465 (Count: 268)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.6925 (Count: 240)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.6525 (Count: 176)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9063 (Count: 774)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.6697 (Count: 145)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.7654 (Count: 224)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.model_checkpoint - Epoch 6: val_loss improved from 3.247435 to 3.045561.
2025-04-15 13:33:02 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 6)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.model_checkpoint - Epoch 6: val_loss improved from 3.247435 to 3.045561.
2025-04-15 13:33:02 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 6)
2025-04-15 13:33:02 | INFO     | core.training.callbacks.early_stopping - Epoch 6: EarlyStopping val_loss improved from 3.247435 to 3.045561
2025-04-15 13:33:02 | INFO     | core.training.callbacks.early_stopping - Epoch 6: EarlyStopping val_loss improved from 3.247435 to 3.045561
2025-04-15 13:33:02 | INFO     | core.training.callbacks.gradcam_callback - Skipping GradCAM for epoch 6 (backbone frozen).
2025-04-15 13:33:02 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 6: Captured validation outputs and targets for visualization.
2025-04-15 13:33:02 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 6: Captured validation outputs and targets for visualization.
2025-04-15 13:33:54 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:33:54 | INFO     | core.training.train - Epoch 7 [Initial] Train: Loss=16.8479, Acc=0.6599, Prec=0.6566, Rec=0.6599, F1=0.6575 (51.87s)
2025-04-15 13:34:02 | INFO     | core.training.train - Epoch 7 [Initial] Val:   Loss=3.0280, Acc=0.9289, Prec=0.9331, Rec=0.9289, F1=0.9284 (8.09s)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 7): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:34:03 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 7): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 7): Computing metrics during frozen backbone phase.
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 7.
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 7) ---
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9289
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8050 | Median: 0.8744 | Min: 0.1499
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    26.17% (2413/9222)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1241
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7573 (Count: 141)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8323 (Count: 132)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.8755 (Count: 148)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.7799 (Count: 228)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9277 (Count: 157)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9159 (Count: 203)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9087 (Count: 132)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.7791 (Count: 125)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6718 (Count: 108)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9300 (Count: 178)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6875 (Count: 147)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9708 (Count: 149)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7495 (Count: 165)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6272 (Count: 124)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8718 (Count: 181)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9150 (Count: 156)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9442 (Count: 783)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9276 (Count: 347)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8530 (Count: 150)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8104 (Count: 133)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8554 (Count: 217)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8193 (Count: 155)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7596 (Count: 125)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.6089 (Count: 105)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.6924 (Count: 113)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8428 (Count: 758)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9447 (Count: 284)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.8904 (Count: 164)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8036 (Count: 131)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8295 (Count: 316)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.5961 (Count: 93)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.6733 (Count: 256)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7041 (Count: 128)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.6807 (Count: 251)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.6787 (Count: 218)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.6825 (Count: 196)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.8880 (Count: 774)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8007 (Count: 154)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8238 (Count: 241)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 7): Computing metrics during frozen backbone phase.
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 7.
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 7) ---
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9289
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8050 | Median: 0.8744 | Min: 0.1499
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    26.17% (2413/9222)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1241
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7573 (Count: 141)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8323 (Count: 132)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.8755 (Count: 148)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.7799 (Count: 228)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9277 (Count: 157)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9159 (Count: 203)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9087 (Count: 132)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.7791 (Count: 125)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6718 (Count: 108)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9300 (Count: 178)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6875 (Count: 147)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9708 (Count: 149)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7495 (Count: 165)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6272 (Count: 124)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8718 (Count: 181)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9150 (Count: 156)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9442 (Count: 783)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9276 (Count: 347)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8530 (Count: 150)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8104 (Count: 133)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8554 (Count: 217)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8193 (Count: 155)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7596 (Count: 125)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.6089 (Count: 105)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.6924 (Count: 113)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8428 (Count: 758)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9447 (Count: 284)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.8904 (Count: 164)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8036 (Count: 131)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8295 (Count: 316)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.5961 (Count: 93)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.6733 (Count: 256)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7041 (Count: 128)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.6807 (Count: 251)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.6787 (Count: 218)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.6825 (Count: 196)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.8880 (Count: 774)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8007 (Count: 154)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8238 (Count: 241)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.model_checkpoint - Epoch 7: val_loss improved from 3.045561 to 3.027972.
2025-04-15 13:34:03 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 7)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.model_checkpoint - Epoch 7: val_loss improved from 3.045561 to 3.027972.
2025-04-15 13:34:03 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 7)
2025-04-15 13:34:03 | INFO     | core.training.callbacks.early_stopping - Epoch 7: EarlyStopping val_loss improved from 3.045561 to 3.027972
2025-04-15 13:34:03 | INFO     | core.training.callbacks.early_stopping - Epoch 7: EarlyStopping val_loss improved from 3.045561 to 3.027972
2025-04-15 13:34:03 | INFO     | core.training.callbacks.gradcam_callback - Skipping GradCAM for epoch 7 (backbone frozen).
2025-04-15 13:34:03 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 7: Captured validation outputs and targets for visualization.
2025-04-15 13:34:03 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 7: Captured validation outputs and targets for visualization.
2025-04-15 13:34:50 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:34:50 | INFO     | core.training.train - Epoch 8 [Initial] Train: Loss=15.8671, Acc=0.6775, Prec=0.6753, Rec=0.6775, F1=0.6757 (46.85s)
2025-04-15 13:34:58 | INFO     | core.training.train - Epoch 8 [Initial] Val:   Loss=2.6726, Acc=0.9431, Prec=0.9446, Rec=0.9431, F1=0.9428 (7.80s)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 8): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:34:59 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 8): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 8): Computing metrics during frozen backbone phase.
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 8.
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 8) ---
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9431
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8148 | Median: 0.8794 | Min: 0.1883
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    24.16% (2228/9222)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1284
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7478 (Count: 144)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8163 (Count: 136)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.8601 (Count: 146)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8201 (Count: 236)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9318 (Count: 159)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.8343 (Count: 195)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9316 (Count: 133)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.7479 (Count: 119)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6734 (Count: 117)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9714 (Count: 178)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6794 (Count: 146)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9419 (Count: 150)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7016 (Count: 160)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6327 (Count: 139)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8668 (Count: 179)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.8371 (Count: 153)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9412 (Count: 786)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.8870 (Count: 345)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8044 (Count: 145)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8172 (Count: 148)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8000 (Count: 205)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8703 (Count: 161)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7752 (Count: 125)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7589 (Count: 134)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.7117 (Count: 126)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9027 (Count: 779)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9478 (Count: 287)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9377 (Count: 168)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.7515 (Count: 130)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8466 (Count: 317)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6420 (Count: 97)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7269 (Count: 273)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7157 (Count: 132)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7238 (Count: 254)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.6873 (Count: 216)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7071 (Count: 206)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.8752 (Count: 770)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8033 (Count: 156)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8562 (Count: 247)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 8): Computing metrics during frozen backbone phase.
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 8.
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 8) ---
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9431
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8148 | Median: 0.8794 | Min: 0.1883
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    24.16% (2228/9222)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1284
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7478 (Count: 144)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8163 (Count: 136)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.8601 (Count: 146)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8201 (Count: 236)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9318 (Count: 159)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.8343 (Count: 195)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9316 (Count: 133)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.7479 (Count: 119)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6734 (Count: 117)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9714 (Count: 178)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6794 (Count: 146)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9419 (Count: 150)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7016 (Count: 160)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6327 (Count: 139)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8668 (Count: 179)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.8371 (Count: 153)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9412 (Count: 786)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.8870 (Count: 345)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8044 (Count: 145)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8172 (Count: 148)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8000 (Count: 205)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8703 (Count: 161)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7752 (Count: 125)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7589 (Count: 134)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.7117 (Count: 126)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9027 (Count: 779)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9478 (Count: 287)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9377 (Count: 168)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.7515 (Count: 130)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8466 (Count: 317)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6420 (Count: 97)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7269 (Count: 273)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7157 (Count: 132)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7238 (Count: 254)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.6873 (Count: 216)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7071 (Count: 206)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.8752 (Count: 770)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8033 (Count: 156)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8562 (Count: 247)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.model_checkpoint - Epoch 8: val_loss improved from 3.027972 to 2.672589.
2025-04-15 13:34:59 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 8)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.model_checkpoint - Epoch 8: val_loss improved from 3.027972 to 2.672589.
2025-04-15 13:34:59 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 8)
2025-04-15 13:34:59 | INFO     | core.training.callbacks.early_stopping - Epoch 8: EarlyStopping val_loss improved from 3.027972 to 2.672589
2025-04-15 13:34:59 | INFO     | core.training.callbacks.early_stopping - Epoch 8: EarlyStopping val_loss improved from 3.027972 to 2.672589
2025-04-15 13:34:59 | INFO     | core.training.callbacks.gradcam_callback - Skipping GradCAM for epoch 8 (backbone frozen).
2025-04-15 13:34:59 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 8: Captured validation outputs and targets for visualization.
2025-04-15 13:34:59 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 8: Captured validation outputs and targets for visualization.
2025-04-15 13:35:46 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:35:46 | INFO     | core.training.train - Epoch 9 [Initial] Train: Loss=15.3592, Acc=0.6845, Prec=0.6820, Rec=0.6845, F1=0.6827 (46.79s)
2025-04-15 13:35:54 | INFO     | core.training.train - Epoch 9 [Initial] Val:   Loss=2.8440, Acc=0.9348, Prec=0.9381, Rec=0.9348, F1=0.9354 (8.15s)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 9): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:35:55 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 9): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 9): Computing metrics during frozen backbone phase.
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 9.
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 9) ---
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9348
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8199 | Median: 0.8890 | Min: 0.1594
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    23.55% (2172/9222)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1151
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7765 (Count: 141)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8742 (Count: 135)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9132 (Count: 150)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.7912 (Count: 229)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9501 (Count: 157)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.8772 (Count: 201)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.8853 (Count: 132)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8156 (Count: 124)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6861 (Count: 133)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9409 (Count: 176)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6439 (Count: 137)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9671 (Count: 149)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7406 (Count: 155)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7093 (Count: 156)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8401 (Count: 180)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.8986 (Count: 158)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9473 (Count: 783)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.8553 (Count: 337)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9074 (Count: 152)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8516 (Count: 150)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8509 (Count: 212)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.7935 (Count: 151)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7818 (Count: 117)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7494 (Count: 133)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8339 (Count: 133)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8281 (Count: 746)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9347 (Count: 283)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9115 (Count: 167)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.7867 (Count: 126)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8845 (Count: 321)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7074 (Count: 108)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7623 (Count: 245)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.6933 (Count: 120)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7107 (Count: 235)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7264 (Count: 219)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7616 (Count: 208)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9269 (Count: 776)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.6983 (Count: 150)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8263 (Count: 236)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 9): Computing metrics during frozen backbone phase.
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 9.
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 9) ---
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9348
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8199 | Median: 0.8890 | Min: 0.1594
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    23.55% (2172/9222)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1151
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7765 (Count: 141)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8742 (Count: 135)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9132 (Count: 150)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.7912 (Count: 229)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9501 (Count: 157)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.8772 (Count: 201)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.8853 (Count: 132)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8156 (Count: 124)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6861 (Count: 133)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9409 (Count: 176)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6439 (Count: 137)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9671 (Count: 149)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7406 (Count: 155)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7093 (Count: 156)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8401 (Count: 180)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.8986 (Count: 158)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9473 (Count: 783)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.8553 (Count: 337)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9074 (Count: 152)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8516 (Count: 150)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8509 (Count: 212)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.7935 (Count: 151)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7818 (Count: 117)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7494 (Count: 133)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8339 (Count: 133)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8281 (Count: 746)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9347 (Count: 283)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9115 (Count: 167)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.7867 (Count: 126)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8845 (Count: 321)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7074 (Count: 108)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7623 (Count: 245)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.6933 (Count: 120)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7107 (Count: 235)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7264 (Count: 219)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7616 (Count: 208)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9269 (Count: 776)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.6983 (Count: 150)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8263 (Count: 236)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 9)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 9)
2025-04-15 13:35:55 | INFO     | core.training.callbacks.gradcam_callback - Skipping GradCAM for epoch 9 (backbone frozen).
2025-04-15 13:35:55 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 9: Captured validation outputs and targets for visualization.
2025-04-15 13:35:55 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 9: Captured validation outputs and targets for visualization.
2025-04-15 13:36:46 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:36:46 | INFO     | core.training.train - Epoch 10 [Initial] Train: Loss=15.0449, Acc=0.6934, Prec=0.6909, Rec=0.6934, F1=0.6916 (50.76s)
2025-04-15 13:36:54 | INFO     | core.training.train - Epoch 10 [Initial] Val:   Loss=2.6482, Acc=0.9422, Prec=0.9441, Rec=0.9422, F1=0.9421 (8.18s)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 10): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:36:55 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 10): Skipping weight adjustments during frozen backbone phase.
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 10): Computing metrics during frozen backbone phase.
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 10.
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 10) ---
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9422
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8198 | Median: 0.8826 | Min: 0.1734
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    23.23% (2142/9222)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1226
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7171 (Count: 142)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8352 (Count: 131)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.8794 (Count: 151)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.7839 (Count: 227)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9277 (Count: 159)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9188 (Count: 205)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.8936 (Count: 128)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9197 (Count: 130)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7006 (Count: 125)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9540 (Count: 177)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6804 (Count: 146)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9674 (Count: 150)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.6884 (Count: 149)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7061 (Count: 162)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.7676 (Count: 168)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.8358 (Count: 155)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9705 (Count: 788)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9342 (Count: 349)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8671 (Count: 153)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8136 (Count: 145)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8464 (Count: 219)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8719 (Count: 163)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7566 (Count: 120)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8369 (Count: 139)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.7534 (Count: 122)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8421 (Count: 751)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9177 (Count: 283)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9240 (Count: 168)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8339 (Count: 132)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.7705 (Count: 310)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6665 (Count: 94)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7636 (Count: 266)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7088 (Count: 130)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7268 (Count: 253)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7796 (Count: 242)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.6870 (Count: 195)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.8702 (Count: 756)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8178 (Count: 160)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8410 (Count: 246)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor (Epoch 10): Computing metrics during frozen backbone phase.
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 10.
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 10) ---
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9422
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8198 | Median: 0.8826 | Min: 0.1734
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    23.23% (2142/9222)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1226
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7171 (Count: 142)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8352 (Count: 131)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.8794 (Count: 151)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.7839 (Count: 227)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9277 (Count: 159)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9188 (Count: 205)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.8936 (Count: 128)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9197 (Count: 130)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7006 (Count: 125)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9540 (Count: 177)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6804 (Count: 146)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9674 (Count: 150)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.6884 (Count: 149)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7061 (Count: 162)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.7676 (Count: 168)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.8358 (Count: 155)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9705 (Count: 788)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9342 (Count: 349)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8671 (Count: 153)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8136 (Count: 145)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8464 (Count: 219)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8719 (Count: 163)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7566 (Count: 120)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8369 (Count: 139)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.7534 (Count: 122)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8421 (Count: 751)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9177 (Count: 283)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9240 (Count: 168)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8339 (Count: 132)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.7705 (Count: 310)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6665 (Count: 94)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7636 (Count: 266)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7088 (Count: 130)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7268 (Count: 253)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7796 (Count: 242)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.6870 (Count: 195)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.8702 (Count: 756)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8178 (Count: 160)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8410 (Count: 246)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.model_checkpoint - Epoch 10: val_loss improved from 2.672589 to 2.648209.
2025-04-15 13:36:55 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 10)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.model_checkpoint - Epoch 10: val_loss improved from 2.672589 to 2.648209.
2025-04-15 13:36:55 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 10)
2025-04-15 13:36:55 | INFO     | core.training.callbacks.early_stopping - Epoch 10: EarlyStopping val_loss improved from 2.672589 to 2.648209
2025-04-15 13:36:55 | INFO     | core.training.callbacks.early_stopping - Epoch 10: EarlyStopping val_loss improved from 2.672589 to 2.648209
2025-04-15 13:36:55 | INFO     | core.training.callbacks.gradcam_callback - Skipping GradCAM for epoch 10 (backbone frozen).
2025-04-15 13:36:55 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 10: Captured validation outputs and targets for visualization.
2025-04-15 13:36:55 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 10: Captured validation outputs and targets for visualization.
2025-04-15 13:36:55 | INFO     | core.training.train - Epoch 11: Unfreezing backbone for fine-tuning.
2025-04-15 13:36:56 | INFO     | core.models.backbones.cbam_resnet18 - Unfroze all layers in CBAMResNet18Backbone
2025-04-15 13:36:56 | INFO     | core.models.base - Unfroze cbam_resnet18 backbone for fine-tuning
2025-04-15 13:36:56 | INFO     | core.training.train - Reducing optimizer LR by factor 0.05 for fine-tuning.
2025-04-15 13:38:51 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:38:51 | INFO     | core.training.train - Epoch 11 [Fine-tuning] Train: Loss=13.8461, Acc=0.7147, Prec=0.7133, Rec=0.7147, F1=0.7129 (115.30s)
2025-04-15 13:38:59 | INFO     | core.training.train - Epoch 11 [Fine-tuning] Val:   Loss=2.3610, Acc=0.9527, Prec=0.9540, Rec=0.9527, F1=0.9525 (7.54s)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 11.
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 11) ---
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9527
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8422 | Median: 0.9108 | Min: 0.2021
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    19.42% (1791/9222)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1105
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7531 (Count: 144)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8841 (Count: 135)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9108 (Count: 150)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8184 (Count: 237)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9269 (Count: 159)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.8994 (Count: 205)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9100 (Count: 130)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9026 (Count: 131)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6890 (Count: 115)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9619 (Count: 178)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7067 (Count: 149)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9659 (Count: 149)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7075 (Count: 156)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6932 (Count: 160)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8832 (Count: 179)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.8931 (Count: 158)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9627 (Count: 789)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9019 (Count: 344)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8647 (Count: 151)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8439 (Count: 150)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8550 (Count: 216)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8826 (Count: 160)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7634 (Count: 125)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7808 (Count: 133)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8432 (Count: 136)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8896 (Count: 772)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9435 (Count: 285)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9248 (Count: 167)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8288 (Count: 133)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8840 (Count: 324)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6730 (Count: 101)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7534 (Count: 264)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7204 (Count: 126)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7970 (Count: 270)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7464 (Count: 232)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7004 (Count: 200)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9212 (Count: 778)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.7984 (Count: 155)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8259 (Count: 240)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 11.
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 11) ---
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9527
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8422 | Median: 0.9108 | Min: 0.2021
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    19.42% (1791/9222)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1105
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7531 (Count: 144)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8841 (Count: 135)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9108 (Count: 150)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8184 (Count: 237)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9269 (Count: 159)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.8994 (Count: 205)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9100 (Count: 130)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9026 (Count: 131)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6890 (Count: 115)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9619 (Count: 178)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7067 (Count: 149)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9659 (Count: 149)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7075 (Count: 156)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6932 (Count: 160)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8832 (Count: 179)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.8931 (Count: 158)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9627 (Count: 789)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9019 (Count: 344)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8647 (Count: 151)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8439 (Count: 150)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8550 (Count: 216)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8826 (Count: 160)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7634 (Count: 125)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7808 (Count: 133)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8432 (Count: 136)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8896 (Count: 772)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9435 (Count: 285)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9248 (Count: 167)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8288 (Count: 133)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8840 (Count: 324)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6730 (Count: 101)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7534 (Count: 264)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7204 (Count: 126)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7970 (Count: 270)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7464 (Count: 232)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7004 (Count: 200)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9212 (Count: 778)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.7984 (Count: 155)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8259 (Count: 240)
2025-04-15 13:38:59 | INFO     | core.training.callbacks.model_checkpoint - Epoch 11: val_loss improved from 2.648209 to 2.361001.
2025-04-15 13:39:00 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 11)
2025-04-15 13:39:00 | INFO     | core.training.callbacks.model_checkpoint - Epoch 11: val_loss improved from 2.648209 to 2.361001.
2025-04-15 13:39:00 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 11)
2025-04-15 13:39:01 | INFO     | core.training.callbacks.early_stopping - Epoch 11: EarlyStopping val_loss improved from 2.648209 to 2.361001
2025-04-15 13:39:01 | INFO     | core.training.callbacks.early_stopping - Epoch 11: EarlyStopping val_loss improved from 2.648209 to 2.361001
2025-04-15 13:39:01 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 11: Captured validation outputs and targets for visualization.
2025-04-15 13:39:01 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 11: Captured validation outputs and targets for visualization.
2025-04-15 13:40:50 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:40:50 | INFO     | core.training.train - Epoch 12 [Fine-tuning] Train: Loss=13.0529, Acc=0.7279, Prec=0.7262, Rec=0.7279, F1=0.7264 (109.05s)
2025-04-15 13:40:58 | INFO     | core.training.train - Epoch 12 [Fine-tuning] Val:   Loss=2.3302, Acc=0.9535, Prec=0.9547, Rec=0.9535, F1=0.9533 (7.51s)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 12.
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 12) ---
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9535
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8426 | Median: 0.9101 | Min: 0.1898
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    19.26% (1776/9222)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1109
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7646 (Count: 142)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8789 (Count: 136)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9144 (Count: 150)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8215 (Count: 237)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9286 (Count: 158)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9050 (Count: 205)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9118 (Count: 130)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8767 (Count: 130)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6824 (Count: 115)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9580 (Count: 178)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7082 (Count: 149)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9675 (Count: 149)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7179 (Count: 157)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6887 (Count: 158)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8964 (Count: 181)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9036 (Count: 157)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9614 (Count: 788)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9233 (Count: 347)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8498 (Count: 151)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8532 (Count: 152)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8555 (Count: 217)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8692 (Count: 162)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7907 (Count: 127)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7676 (Count: 135)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8365 (Count: 136)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8832 (Count: 773)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9400 (Count: 284)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9178 (Count: 168)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8437 (Count: 132)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8820 (Count: 324)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6604 (Count: 102)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7444 (Count: 265)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7291 (Count: 129)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7790 (Count: 267)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7533 (Count: 227)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7224 (Count: 202)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9185 (Count: 777)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8120 (Count: 156)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8239 (Count: 240)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 12.
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 12) ---
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9535
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8426 | Median: 0.9101 | Min: 0.1898
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    19.26% (1776/9222)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1109
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7646 (Count: 142)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8789 (Count: 136)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9144 (Count: 150)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8215 (Count: 237)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9286 (Count: 158)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9050 (Count: 205)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9118 (Count: 130)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8767 (Count: 130)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6824 (Count: 115)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9580 (Count: 178)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7082 (Count: 149)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9675 (Count: 149)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7179 (Count: 157)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6887 (Count: 158)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8964 (Count: 181)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9036 (Count: 157)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9614 (Count: 788)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9233 (Count: 347)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8498 (Count: 151)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8532 (Count: 152)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8555 (Count: 217)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8692 (Count: 162)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7907 (Count: 127)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7676 (Count: 135)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8365 (Count: 136)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8832 (Count: 773)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9400 (Count: 284)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9178 (Count: 168)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8437 (Count: 132)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8820 (Count: 324)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6604 (Count: 102)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7444 (Count: 265)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7291 (Count: 129)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7790 (Count: 267)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7533 (Count: 227)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7224 (Count: 202)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9185 (Count: 777)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8120 (Count: 156)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8239 (Count: 240)
2025-04-15 13:40:58 | INFO     | core.training.callbacks.model_checkpoint - Epoch 12: val_loss improved from 2.361001 to 2.330245.
2025-04-15 13:40:58 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 12)
2025-04-15 13:40:59 | INFO     | core.training.callbacks.model_checkpoint - Epoch 12: val_loss improved from 2.361001 to 2.330245.
2025-04-15 13:40:59 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 12)
2025-04-15 13:40:59 | INFO     | core.training.callbacks.early_stopping - Epoch 12: EarlyStopping val_loss improved from 2.361001 to 2.330245
2025-04-15 13:40:59 | INFO     | core.training.callbacks.early_stopping - Epoch 12: EarlyStopping val_loss improved from 2.361001 to 2.330245
2025-04-15 13:40:59 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 12: Captured validation outputs and targets for visualization.
2025-04-15 13:40:59 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 12: Captured validation outputs and targets for visualization.
2025-04-15 13:42:49 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:42:49 | INFO     | core.training.train - Epoch 13 [Fine-tuning] Train: Loss=12.7239, Acc=0.7325, Prec=0.7307, Rec=0.7325, F1=0.7311 (109.52s)
2025-04-15 13:42:56 | INFO     | core.training.train - Epoch 13 [Fine-tuning] Val:   Loss=2.2644, Acc=0.9546, Prec=0.9557, Rec=0.9546, F1=0.9544 (7.43s)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 13.
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 13) ---
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9546
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8472 | Median: 0.9145 | Min: 0.1891
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    18.43% (1700/9222)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1075
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7584 (Count: 143)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8868 (Count: 136)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9178 (Count: 150)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8449 (Count: 241)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9182 (Count: 159)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9084 (Count: 204)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9252 (Count: 131)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8918 (Count: 130)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6815 (Count: 113)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9534 (Count: 178)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7186 (Count: 150)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9591 (Count: 149)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.6971 (Count: 152)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7162 (Count: 163)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8758 (Count: 178)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.8968 (Count: 156)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9635 (Count: 789)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9142 (Count: 345)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8583 (Count: 151)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8683 (Count: 154)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8361 (Count: 215)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8646 (Count: 162)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7951 (Count: 127)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7927 (Count: 136)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8291 (Count: 134)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9029 (Count: 781)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9561 (Count: 284)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9265 (Count: 169)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8408 (Count: 131)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8891 (Count: 325)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6857 (Count: 103)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7386 (Count: 265)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7394 (Count: 131)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7824 (Count: 268)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7579 (Count: 225)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7222 (Count: 203)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9196 (Count: 774)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8102 (Count: 156)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8429 (Count: 242)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 13.
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 13) ---
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9546
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8472 | Median: 0.9145 | Min: 0.1891
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    18.43% (1700/9222)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1075
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7584 (Count: 143)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8868 (Count: 136)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9178 (Count: 150)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8449 (Count: 241)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9182 (Count: 159)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9084 (Count: 204)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9252 (Count: 131)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8918 (Count: 130)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6815 (Count: 113)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9534 (Count: 178)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7186 (Count: 150)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9591 (Count: 149)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.6971 (Count: 152)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7162 (Count: 163)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8758 (Count: 178)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.8968 (Count: 156)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9635 (Count: 789)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9142 (Count: 345)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8583 (Count: 151)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8683 (Count: 154)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8361 (Count: 215)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8646 (Count: 162)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.7951 (Count: 127)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7927 (Count: 136)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8291 (Count: 134)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9029 (Count: 781)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9561 (Count: 284)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9265 (Count: 169)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8408 (Count: 131)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8891 (Count: 325)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6857 (Count: 103)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7386 (Count: 265)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7394 (Count: 131)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7824 (Count: 268)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7579 (Count: 225)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7222 (Count: 203)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9196 (Count: 774)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8102 (Count: 156)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8429 (Count: 242)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.model_checkpoint - Epoch 13: val_loss improved from 2.330245 to 2.264378.
2025-04-15 13:42:57 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 13)
2025-04-15 13:42:57 | INFO     | core.training.callbacks.model_checkpoint - Epoch 13: val_loss improved from 2.330245 to 2.264378.
2025-04-15 13:42:58 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 13)
2025-04-15 13:42:58 | INFO     | core.training.callbacks.early_stopping - Epoch 13: EarlyStopping val_loss improved from 2.330245 to 2.264378
2025-04-15 13:42:58 | INFO     | core.training.callbacks.early_stopping - Epoch 13: EarlyStopping val_loss improved from 2.330245 to 2.264378
2025-04-15 13:42:58 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 13: Captured validation outputs and targets for visualization.
2025-04-15 13:42:58 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 13: Captured validation outputs and targets for visualization.
2025-04-15 13:44:48 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:44:48 | INFO     | core.training.train - Epoch 14 [Fine-tuning] Train: Loss=12.4484, Acc=0.7372, Prec=0.7351, Rec=0.7372, F1=0.7357 (110.03s)
2025-04-15 13:44:56 | INFO     | core.training.train - Epoch 14 [Fine-tuning] Val:   Loss=2.2417, Acc=0.9552, Prec=0.9563, Rec=0.9552, F1=0.9550 (7.48s)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 14.
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 14) ---
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9552
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8502 | Median: 0.9177 | Min: 0.1877
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    18.04% (1664/9222)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1053
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7718 (Count: 146)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8820 (Count: 136)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9215 (Count: 150)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8541 (Count: 241)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9246 (Count: 159)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9191 (Count: 205)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9221 (Count: 132)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8958 (Count: 130)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6821 (Count: 114)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9560 (Count: 178)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7156 (Count: 149)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9637 (Count: 149)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7176 (Count: 156)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6932 (Count: 159)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8860 (Count: 179)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9056 (Count: 156)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9664 (Count: 789)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9143 (Count: 347)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8515 (Count: 150)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8538 (Count: 153)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8574 (Count: 216)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8624 (Count: 160)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8175 (Count: 127)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7855 (Count: 135)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8511 (Count: 137)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9080 (Count: 780)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9508 (Count: 285)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9308 (Count: 169)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8445 (Count: 131)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8766 (Count: 325)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6698 (Count: 103)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7634 (Count: 269)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7561 (Count: 129)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7878 (Count: 269)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7540 (Count: 223)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7195 (Count: 202)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9225 (Count: 773)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8104 (Count: 156)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8410 (Count: 242)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 14.
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 14) ---
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9552
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8502 | Median: 0.9177 | Min: 0.1877
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    18.04% (1664/9222)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1053
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7718 (Count: 146)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8820 (Count: 136)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9215 (Count: 150)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8541 (Count: 241)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9246 (Count: 159)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9191 (Count: 205)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9221 (Count: 132)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8958 (Count: 130)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6821 (Count: 114)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9560 (Count: 178)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7156 (Count: 149)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9637 (Count: 149)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7176 (Count: 156)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6932 (Count: 159)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8860 (Count: 179)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9056 (Count: 156)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9664 (Count: 789)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9143 (Count: 347)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8515 (Count: 150)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8538 (Count: 153)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8574 (Count: 216)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8624 (Count: 160)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8175 (Count: 127)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7855 (Count: 135)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8511 (Count: 137)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9080 (Count: 780)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9508 (Count: 285)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9308 (Count: 169)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8445 (Count: 131)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8766 (Count: 325)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6698 (Count: 103)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7634 (Count: 269)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7561 (Count: 129)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7878 (Count: 269)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7540 (Count: 223)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7195 (Count: 202)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9225 (Count: 773)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8104 (Count: 156)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8410 (Count: 242)
2025-04-15 13:44:56 | INFO     | core.training.callbacks.model_checkpoint - Epoch 14: val_loss improved from 2.264378 to 2.241676.
2025-04-15 13:44:56 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 14)
2025-04-15 13:44:57 | INFO     | core.training.callbacks.model_checkpoint - Epoch 14: val_loss improved from 2.264378 to 2.241676.
2025-04-15 13:44:57 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 14)
2025-04-15 13:44:57 | INFO     | core.training.callbacks.early_stopping - Epoch 14: EarlyStopping val_loss improved from 2.264378 to 2.241676
2025-04-15 13:44:57 | INFO     | core.training.callbacks.early_stopping - Epoch 14: EarlyStopping val_loss improved from 2.264378 to 2.241676
2025-04-15 13:44:57 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 14: Captured validation outputs and targets for visualization.
2025-04-15 13:44:57 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 14: Captured validation outputs and targets for visualization.
2025-04-15 13:46:46 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:46:46 | INFO     | core.training.train - Epoch 15 [Fine-tuning] Train: Loss=12.3057, Acc=0.7379, Prec=0.7365, Rec=0.7379, F1=0.7368 (108.93s)
2025-04-15 13:46:54 | INFO     | core.training.train - Epoch 15 [Fine-tuning] Val:   Loss=2.2048, Acc=0.9567, Prec=0.9580, Rec=0.9567, F1=0.9566 (7.50s)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 15): Current confidence=0.8502, Change=+0.0030
2025-04-15 13:46:54 | INFO     | core.training.callbacks.adaptive_weight -   Adjusted Focal Loss gamma: 2.50 -> 2.38
2025-04-15 13:46:54 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 15): Current confidence=0.8502, Change=+0.0030
2025-04-15 13:46:54 | INFO     | core.training.callbacks.adaptive_weight -   Adjusted Focal Loss gamma: 2.38 -> 2.26
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 15.
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 15) ---
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9567
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8498 | Median: 0.9160 | Min: 0.1940
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    17.77% (1639/9222)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1069
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7738 (Count: 146)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8820 (Count: 135)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9275 (Count: 150)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8371 (Count: 242)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9247 (Count: 159)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9127 (Count: 205)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9096 (Count: 131)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8956 (Count: 130)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6771 (Count: 113)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9620 (Count: 178)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7184 (Count: 149)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9559 (Count: 149)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7287 (Count: 157)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6888 (Count: 156)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8876 (Count: 180)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9017 (Count: 157)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9698 (Count: 789)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9109 (Count: 347)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8619 (Count: 152)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8688 (Count: 154)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8409 (Count: 214)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8517 (Count: 161)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8146 (Count: 128)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7925 (Count: 136)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8399 (Count: 136)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8957 (Count: 772)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9527 (Count: 285)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9340 (Count: 168)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8371 (Count: 131)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8739 (Count: 322)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6747 (Count: 103)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7701 (Count: 272)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7547 (Count: 137)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7776 (Count: 270)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7607 (Count: 228)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7230 (Count: 206)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9286 (Count: 778)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8227 (Count: 156)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8403 (Count: 241)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 15.
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 15) ---
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9567
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8498 | Median: 0.9160 | Min: 0.1940
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    17.77% (1639/9222)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1069
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7738 (Count: 146)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8820 (Count: 135)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9275 (Count: 150)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8371 (Count: 242)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9247 (Count: 159)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9127 (Count: 205)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9096 (Count: 131)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8956 (Count: 130)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6771 (Count: 113)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9620 (Count: 178)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7184 (Count: 149)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9559 (Count: 149)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7287 (Count: 157)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6888 (Count: 156)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8876 (Count: 180)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9017 (Count: 157)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9698 (Count: 789)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9109 (Count: 347)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8619 (Count: 152)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8688 (Count: 154)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8409 (Count: 214)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8517 (Count: 161)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8146 (Count: 128)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7925 (Count: 136)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8399 (Count: 136)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8957 (Count: 772)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9527 (Count: 285)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9340 (Count: 168)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8371 (Count: 131)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8739 (Count: 322)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6747 (Count: 103)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7701 (Count: 272)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7547 (Count: 137)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7776 (Count: 270)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7607 (Count: 228)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7230 (Count: 206)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9286 (Count: 778)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8227 (Count: 156)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8403 (Count: 241)
2025-04-15 13:46:54 | INFO     | core.training.callbacks.model_checkpoint - Epoch 15: val_loss improved from 2.241676 to 2.204812.
2025-04-15 13:46:55 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 15)
2025-04-15 13:46:55 | INFO     | core.training.callbacks.model_checkpoint - Epoch 15: val_loss improved from 2.241676 to 2.204812.
2025-04-15 13:46:55 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 15)
2025-04-15 13:46:55 | INFO     | core.training.callbacks.early_stopping - Epoch 15: EarlyStopping val_loss improved from 2.241676 to 2.204812
2025-04-15 13:46:55 | INFO     | core.training.callbacks.early_stopping - Epoch 15: EarlyStopping val_loss improved from 2.241676 to 2.204812
2025-04-15 13:46:55 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 15: Captured validation outputs and targets for visualization.
2025-04-15 13:46:55 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 15: Captured validation outputs and targets for visualization.
2025-04-15 13:48:45 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:48:45 | INFO     | core.training.train - Epoch 16 [Fine-tuning] Train: Loss=12.5861, Acc=0.7463, Prec=0.7446, Rec=0.7463, F1=0.7450 (109.17s)
2025-04-15 13:48:52 | INFO     | core.training.train - Epoch 16 [Fine-tuning] Val:   Loss=2.2709, Acc=0.9574, Prec=0.9585, Rec=0.9574, F1=0.9572 (7.48s)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 16.
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 16) ---
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9574
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8556 | Median: 0.9227 | Min: 0.1957
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    16.94% (1562/9222)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1019
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7942 (Count: 145)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8897 (Count: 137)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9199 (Count: 150)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8466 (Count: 243)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9430 (Count: 159)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9180 (Count: 204)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9235 (Count: 134)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8838 (Count: 130)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6932 (Count: 117)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9525 (Count: 177)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7047 (Count: 149)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9683 (Count: 150)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7201 (Count: 156)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6959 (Count: 160)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9069 (Count: 180)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9118 (Count: 156)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9675 (Count: 788)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9093 (Count: 344)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8708 (Count: 151)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8599 (Count: 153)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8409 (Count: 215)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8654 (Count: 160)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8226 (Count: 128)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7872 (Count: 139)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8421 (Count: 138)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9056 (Count: 771)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9587 (Count: 285)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9364 (Count: 169)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8588 (Count: 132)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8925 (Count: 326)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6696 (Count: 101)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7848 (Count: 269)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7633 (Count: 134)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7912 (Count: 270)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7619 (Count: 231)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7193 (Count: 202)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9316 (Count: 777)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8516 (Count: 157)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8515 (Count: 242)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 16.
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 16) ---
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9574
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8556 | Median: 0.9227 | Min: 0.1957
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    16.94% (1562/9222)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1019
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7942 (Count: 145)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8897 (Count: 137)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9199 (Count: 150)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8466 (Count: 243)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9430 (Count: 159)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9180 (Count: 204)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9235 (Count: 134)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8838 (Count: 130)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6932 (Count: 117)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9525 (Count: 177)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7047 (Count: 149)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9683 (Count: 150)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7201 (Count: 156)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.6959 (Count: 160)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9069 (Count: 180)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9118 (Count: 156)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9675 (Count: 788)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9093 (Count: 344)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8708 (Count: 151)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8599 (Count: 153)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8409 (Count: 215)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8654 (Count: 160)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8226 (Count: 128)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7872 (Count: 139)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8421 (Count: 138)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9056 (Count: 771)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9587 (Count: 285)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9364 (Count: 169)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8588 (Count: 132)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8925 (Count: 326)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6696 (Count: 101)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7848 (Count: 269)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7633 (Count: 134)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7912 (Count: 270)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7619 (Count: 231)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7193 (Count: 202)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9316 (Count: 777)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8516 (Count: 157)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8515 (Count: 242)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 16)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 16)
2025-04-15 13:48:53 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 16: Captured validation outputs and targets for visualization.
2025-04-15 13:48:53 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 16: Captured validation outputs and targets for visualization.
2025-04-15 13:50:43 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:50:43 | INFO     | core.training.train - Epoch 17 [Fine-tuning] Train: Loss=12.1585, Acc=0.7495, Prec=0.7477, Rec=0.7495, F1=0.7481 (109.32s)
2025-04-15 13:50:50 | INFO     | core.training.train - Epoch 17 [Fine-tuning] Val:   Loss=2.2743, Acc=0.9579, Prec=0.9587, Rec=0.9579, F1=0.9577 (7.45s)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 17.
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 17) ---
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9579
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8554 | Median: 0.9227 | Min: 0.1813
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    16.85% (1554/9222)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1028
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7905 (Count: 145)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8983 (Count: 138)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9191 (Count: 150)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8370 (Count: 240)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9437 (Count: 159)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9194 (Count: 204)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9207 (Count: 133)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8974 (Count: 131)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6950 (Count: 119)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9627 (Count: 178)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6965 (Count: 148)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9635 (Count: 150)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7183 (Count: 156)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7029 (Count: 160)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9153 (Count: 181)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9227 (Count: 158)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9656 (Count: 788)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9227 (Count: 347)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8553 (Count: 150)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8696 (Count: 155)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8509 (Count: 215)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8792 (Count: 162)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8188 (Count: 128)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7856 (Count: 136)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8302 (Count: 135)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9055 (Count: 779)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9610 (Count: 285)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9329 (Count: 169)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8668 (Count: 133)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8842 (Count: 323)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6825 (Count: 101)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7729 (Count: 266)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7643 (Count: 136)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7984 (Count: 270)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7678 (Count: 236)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7151 (Count: 197)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9234 (Count: 773)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8092 (Count: 156)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8608 (Count: 244)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 17.
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 17) ---
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9579
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8554 | Median: 0.9227 | Min: 0.1813
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    16.85% (1554/9222)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1028
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7905 (Count: 145)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8983 (Count: 138)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9191 (Count: 150)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8370 (Count: 240)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9437 (Count: 159)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9194 (Count: 204)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9207 (Count: 133)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8974 (Count: 131)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6950 (Count: 119)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9627 (Count: 178)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6965 (Count: 148)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9635 (Count: 150)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7183 (Count: 156)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7029 (Count: 160)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9153 (Count: 181)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9227 (Count: 158)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9656 (Count: 788)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9227 (Count: 347)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8553 (Count: 150)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8696 (Count: 155)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8509 (Count: 215)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8792 (Count: 162)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8188 (Count: 128)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7856 (Count: 136)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8302 (Count: 135)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9055 (Count: 779)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9610 (Count: 285)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9329 (Count: 169)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8668 (Count: 133)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8842 (Count: 323)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6825 (Count: 101)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7729 (Count: 266)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7643 (Count: 136)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7984 (Count: 270)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7678 (Count: 236)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7151 (Count: 197)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9234 (Count: 773)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8092 (Count: 156)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8608 (Count: 244)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 17)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 17)
2025-04-15 13:50:51 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 17: Captured validation outputs and targets for visualization.
2025-04-15 13:50:51 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 17: Captured validation outputs and targets for visualization.
2025-04-15 13:52:40 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:52:40 | INFO     | core.training.train - Epoch 18 [Fine-tuning] Train: Loss=12.0502, Acc=0.7516, Prec=0.7500, Rec=0.7516, F1=0.7503 (108.78s)
2025-04-15 13:52:48 | INFO     | core.training.train - Epoch 18 [Fine-tuning] Val:   Loss=2.2345, Acc=0.9593, Prec=0.9601, Rec=0.9593, F1=0.9591 (7.52s)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 18.
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 18) ---
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9593
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8566 | Median: 0.9237 | Min: 0.1556
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    16.74% (1544/9222)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1030
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7894 (Count: 147)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8946 (Count: 137)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9327 (Count: 150)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8579 (Count: 244)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9296 (Count: 159)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9170 (Count: 205)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9232 (Count: 133)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8986 (Count: 130)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6881 (Count: 117)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9566 (Count: 178)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7057 (Count: 149)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9653 (Count: 149)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7212 (Count: 155)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7072 (Count: 161)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9066 (Count: 180)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9191 (Count: 157)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9698 (Count: 789)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9207 (Count: 346)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8691 (Count: 153)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8691 (Count: 155)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8530 (Count: 216)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8746 (Count: 161)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8410 (Count: 129)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8014 (Count: 135)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8431 (Count: 134)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9171 (Count: 780)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9622 (Count: 284)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9283 (Count: 170)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8576 (Count: 132)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8690 (Count: 324)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6700 (Count: 105)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7742 (Count: 270)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7516 (Count: 135)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7815 (Count: 269)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7715 (Count: 229)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7238 (Count: 202)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9172 (Count: 775)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8056 (Count: 156)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8669 (Count: 247)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 18.
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 18) ---
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9593
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8566 | Median: 0.9237 | Min: 0.1556
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    16.74% (1544/9222)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1030
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7894 (Count: 147)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8946 (Count: 137)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9327 (Count: 150)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8579 (Count: 244)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9296 (Count: 159)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9170 (Count: 205)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9232 (Count: 133)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.8986 (Count: 130)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6881 (Count: 117)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9566 (Count: 178)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7057 (Count: 149)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9653 (Count: 149)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7212 (Count: 155)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7072 (Count: 161)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9066 (Count: 180)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9191 (Count: 157)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9698 (Count: 789)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9207 (Count: 346)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8691 (Count: 153)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8691 (Count: 155)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8530 (Count: 216)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8746 (Count: 161)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8410 (Count: 129)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8014 (Count: 135)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8431 (Count: 134)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9171 (Count: 780)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9622 (Count: 284)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9283 (Count: 170)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8576 (Count: 132)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8690 (Count: 324)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6700 (Count: 105)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7742 (Count: 270)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7516 (Count: 135)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7815 (Count: 269)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7715 (Count: 229)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7238 (Count: 202)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9172 (Count: 775)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8056 (Count: 156)
2025-04-15 13:52:48 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8669 (Count: 247)
2025-04-15 13:52:49 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 18)
2025-04-15 13:52:49 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 18)
2025-04-15 13:52:49 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 18: Captured validation outputs and targets for visualization.
2025-04-15 13:52:49 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 18: Captured validation outputs and targets for visualization.
2025-04-15 13:54:38 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:54:38 | INFO     | core.training.train - Epoch 19 [Fine-tuning] Train: Loss=11.8230, Acc=0.7563, Prec=0.7546, Rec=0.7563, F1=0.7551 (109.29s)
2025-04-15 13:54:46 | INFO     | core.training.train - Epoch 19 [Fine-tuning] Val:   Loss=2.2279, Acc=0.9589, Prec=0.9598, Rec=0.9589, F1=0.9587 (7.50s)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 19.
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 19) ---
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9589
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8579 | Median: 0.9240 | Min: 0.1947
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    16.48% (1520/9222)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1014
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8040 (Count: 148)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8990 (Count: 137)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9410 (Count: 150)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8521 (Count: 245)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9364 (Count: 159)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9210 (Count: 204)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9183 (Count: 134)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9007 (Count: 130)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6979 (Count: 120)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9539 (Count: 178)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6876 (Count: 147)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9659 (Count: 150)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7193 (Count: 156)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7140 (Count: 162)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9088 (Count: 180)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9188 (Count: 157)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9684 (Count: 789)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9241 (Count: 345)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8607 (Count: 152)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8641 (Count: 155)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8542 (Count: 215)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8759 (Count: 160)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8400 (Count: 129)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7845 (Count: 138)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8437 (Count: 135)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9033 (Count: 776)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9662 (Count: 285)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9369 (Count: 169)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8604 (Count: 132)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8956 (Count: 326)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6786 (Count: 101)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7683 (Count: 268)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7533 (Count: 130)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7833 (Count: 268)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7776 (Count: 228)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7324 (Count: 204)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9227 (Count: 775)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8240 (Count: 157)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8724 (Count: 249)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 19.
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 19) ---
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9589
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8579 | Median: 0.9240 | Min: 0.1947
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    16.48% (1520/9222)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1014
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8040 (Count: 148)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.8990 (Count: 137)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9410 (Count: 150)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8521 (Count: 245)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9364 (Count: 159)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9210 (Count: 204)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9183 (Count: 134)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9007 (Count: 130)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6979 (Count: 120)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9539 (Count: 178)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6876 (Count: 147)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9659 (Count: 150)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7193 (Count: 156)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7140 (Count: 162)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9088 (Count: 180)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9188 (Count: 157)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9684 (Count: 789)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9241 (Count: 345)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8607 (Count: 152)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8641 (Count: 155)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8542 (Count: 215)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8759 (Count: 160)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8400 (Count: 129)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7845 (Count: 138)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8437 (Count: 135)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9033 (Count: 776)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9662 (Count: 285)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9369 (Count: 169)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8604 (Count: 132)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8956 (Count: 326)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6786 (Count: 101)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7683 (Count: 268)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7533 (Count: 130)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7833 (Count: 268)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7776 (Count: 228)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7324 (Count: 204)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9227 (Count: 775)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8240 (Count: 157)
2025-04-15 13:54:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8724 (Count: 249)
2025-04-15 13:54:47 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 19)
2025-04-15 13:54:47 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 19)
2025-04-15 13:54:47 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 19: Captured validation outputs and targets for visualization.
2025-04-15 13:54:47 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 19: Captured validation outputs and targets for visualization.
2025-04-15 13:56:36 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:56:36 | INFO     | core.training.train - Epoch 20 [Fine-tuning] Train: Loss=11.6674, Acc=0.7581, Prec=0.7564, Rec=0.7581, F1=0.7569 (109.38s)
2025-04-15 13:56:44 | INFO     | core.training.train - Epoch 20 [Fine-tuning] Val:   Loss=2.2238, Acc=0.9605, Prec=0.9615, Rec=0.9605, F1=0.9604 (7.43s)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 20): Current confidence=0.8579, Change=+0.0013
2025-04-15 13:56:45 | INFO     | core.training.callbacks.adaptive_weight -   Adjusted Focal Loss gamma: 2.26 -> 2.14
2025-04-15 13:56:45 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 20): Current confidence=0.8579, Change=+0.0013
2025-04-15 13:56:45 | INFO     | core.training.callbacks.adaptive_weight -   Adjusted Focal Loss gamma: 2.14 -> 2.04
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 20.
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 20) ---
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9605
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8592 | Median: 0.9261 | Min: 0.1899
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    16.48% (1520/9222)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1014
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7921 (Count: 150)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9154 (Count: 137)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9394 (Count: 150)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8386 (Count: 245)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9405 (Count: 159)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9168 (Count: 204)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9141 (Count: 134)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9003 (Count: 131)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6960 (Count: 119)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9574 (Count: 177)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6900 (Count: 150)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9682 (Count: 150)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7120 (Count: 154)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7230 (Count: 164)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9156 (Count: 181)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9336 (Count: 156)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9695 (Count: 789)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9174 (Count: 346)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8571 (Count: 149)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8711 (Count: 154)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8559 (Count: 216)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8810 (Count: 162)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8320 (Count: 131)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7773 (Count: 137)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8297 (Count: 138)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9026 (Count: 778)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9739 (Count: 286)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9400 (Count: 170)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8714 (Count: 133)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9006 (Count: 326)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6793 (Count: 101)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7623 (Count: 266)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7552 (Count: 136)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8054 (Count: 271)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7687 (Count: 224)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7345 (Count: 204)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9242 (Count: 777)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8265 (Count: 157)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8644 (Count: 246)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 20.
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 20) ---
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9605
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8592 | Median: 0.9261 | Min: 0.1899
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    16.48% (1520/9222)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1014
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7921 (Count: 150)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9154 (Count: 137)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9394 (Count: 150)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8386 (Count: 245)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9405 (Count: 159)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9168 (Count: 204)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9141 (Count: 134)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9003 (Count: 131)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6960 (Count: 119)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9574 (Count: 177)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6900 (Count: 150)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9682 (Count: 150)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7120 (Count: 154)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7230 (Count: 164)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9156 (Count: 181)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9336 (Count: 156)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9695 (Count: 789)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9174 (Count: 346)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8571 (Count: 149)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8711 (Count: 154)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8559 (Count: 216)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8810 (Count: 162)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8320 (Count: 131)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7773 (Count: 137)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8297 (Count: 138)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9026 (Count: 778)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9739 (Count: 286)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9400 (Count: 170)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8714 (Count: 133)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9006 (Count: 326)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6793 (Count: 101)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7623 (Count: 266)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7552 (Count: 136)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8054 (Count: 271)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7687 (Count: 224)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7345 (Count: 204)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9242 (Count: 777)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8265 (Count: 157)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8644 (Count: 246)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 20)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 20)
2025-04-15 13:56:45 | INFO     | core.training.callbacks.gradcam_callback - Generating GradCAM visualizations at epoch 20
2025-04-15 13:56:45 | INFO     | core.models.model_cbam18 - Using layer4[-1].conv2 as GradCAM target layer
2025-04-15 13:56:45 | INFO     | core.evaluation.interpretability - Using model's recommended GradCAM target layer
2025-04-15 13:56:45 | INFO     | core.evaluation.interpretability - GradCAM initialized with target layer: Conv2d
2025-04-15 13:56:46 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:47 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:47 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:47 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:48 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:48 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:49 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:49 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:50 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:50 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:50 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:51 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:51 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:52 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:52 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:53 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:53 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:53 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:54 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:54 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:55 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:55 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:56 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:56 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:58 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:59 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:56:59 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:57:00 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:57:00 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:57:00 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:57:01 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:57:01 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:57:02 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:57:02 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:57:03 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:57:03 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 13:57:03 | INFO     | core.training.callbacks.gradcam_callback - Generated summary HTML: outputs/cbam_only_resnet18_v2/gradcam/epoch_020/gradcam_summary.html
2025-04-15 13:57:03 | INFO     | core.training.callbacks.gradcam_callback - GradCAM visualizations saved to outputs/cbam_only_resnet18_v2/gradcam/epoch_020
2025-04-15 13:57:03 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 20: Captured validation outputs and targets for visualization.
2025-04-15 13:57:03 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 20: Captured validation outputs and targets for visualization.
2025-04-15 13:58:53 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 13:58:53 | INFO     | core.training.train - Epoch 21 [Fine-tuning] Train: Loss=11.7214, Acc=0.7643, Prec=0.7628, Rec=0.7643, F1=0.7631 (109.92s)
2025-04-15 13:59:01 | INFO     | core.training.train - Epoch 21 [Fine-tuning] Val:   Loss=2.2655, Acc=0.9617, Prec=0.9625, Rec=0.9617, F1=0.9616 (7.56s)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 21.
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 21) ---
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9617
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8615 | Median: 0.9267 | Min: 0.1865
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    15.98% (1474/9222)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1008
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7996 (Count: 147)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9026 (Count: 137)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9346 (Count: 150)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8652 (Count: 245)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9448 (Count: 159)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9260 (Count: 205)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9283 (Count: 135)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9007 (Count: 130)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6959 (Count: 119)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9568 (Count: 177)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6999 (Count: 149)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9521 (Count: 150)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7135 (Count: 154)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7203 (Count: 163)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9176 (Count: 181)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9226 (Count: 156)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9693 (Count: 788)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9281 (Count: 347)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8730 (Count: 152)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8801 (Count: 155)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8509 (Count: 217)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8816 (Count: 162)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8293 (Count: 129)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7818 (Count: 138)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8578 (Count: 137)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9000 (Count: 775)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9647 (Count: 285)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9390 (Count: 170)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8712 (Count: 134)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8810 (Count: 323)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6970 (Count: 108)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7787 (Count: 269)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7825 (Count: 138)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7982 (Count: 271)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7653 (Count: 230)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7372 (Count: 205)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9304 (Count: 779)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8442 (Count: 157)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8576 (Count: 243)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 21.
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 21) ---
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9617
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8615 | Median: 0.9267 | Min: 0.1865
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    15.98% (1474/9222)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.1008
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7996 (Count: 147)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9026 (Count: 137)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9346 (Count: 150)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8652 (Count: 245)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9448 (Count: 159)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9260 (Count: 205)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9283 (Count: 135)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9007 (Count: 130)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6959 (Count: 119)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9568 (Count: 177)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6999 (Count: 149)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9521 (Count: 150)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7135 (Count: 154)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7203 (Count: 163)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9176 (Count: 181)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9226 (Count: 156)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9693 (Count: 788)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9281 (Count: 347)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8730 (Count: 152)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8801 (Count: 155)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8509 (Count: 217)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8816 (Count: 162)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8293 (Count: 129)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7818 (Count: 138)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8578 (Count: 137)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9000 (Count: 775)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9647 (Count: 285)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9390 (Count: 170)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8712 (Count: 134)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8810 (Count: 323)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6970 (Count: 108)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7787 (Count: 269)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7825 (Count: 138)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7982 (Count: 271)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7653 (Count: 230)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7372 (Count: 205)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9304 (Count: 779)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8442 (Count: 157)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8576 (Count: 243)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 21)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 21)
2025-04-15 13:59:02 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 21: Captured validation outputs and targets for visualization.
2025-04-15 13:59:02 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 21: Captured validation outputs and targets for visualization.
2025-04-15 14:00:51 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:00:51 | INFO     | core.training.train - Epoch 22 [Fine-tuning] Train: Loss=11.6957, Acc=0.7626, Prec=0.7609, Rec=0.7626, F1=0.7613 (109.31s)
2025-04-15 14:00:59 | INFO     | core.training.train - Epoch 22 [Fine-tuning] Val:   Loss=2.2531, Acc=0.9620, Prec=0.9628, Rec=0.9620, F1=0.9619 (7.46s)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 22.
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 22) ---
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9620
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8648 | Median: 0.9316 | Min: 0.1434
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    15.57% (1436/9222)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0972
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7940 (Count: 148)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9107 (Count: 137)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9306 (Count: 150)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8629 (Count: 245)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9382 (Count: 159)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9302 (Count: 205)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9267 (Count: 134)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9148 (Count: 130)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7028 (Count: 120)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9600 (Count: 177)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6965 (Count: 147)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9714 (Count: 150)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7262 (Count: 156)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7205 (Count: 161)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9151 (Count: 181)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9200 (Count: 157)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9723 (Count: 788)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9200 (Count: 347)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8674 (Count: 152)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8638 (Count: 153)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8617 (Count: 219)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8707 (Count: 161)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8429 (Count: 130)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7774 (Count: 137)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8506 (Count: 137)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9193 (Count: 780)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9623 (Count: 286)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9417 (Count: 169)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8873 (Count: 134)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8794 (Count: 320)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6736 (Count: 103)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7767 (Count: 271)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7783 (Count: 138)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8088 (Count: 271)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7725 (Count: 229)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7387 (Count: 209)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9351 (Count: 777)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8498 (Count: 157)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8708 (Count: 247)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 22.
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 22) ---
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9620
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8648 | Median: 0.9316 | Min: 0.1434
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    15.57% (1436/9222)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0972
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.7940 (Count: 148)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9107 (Count: 137)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9306 (Count: 150)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8629 (Count: 245)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9382 (Count: 159)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9302 (Count: 205)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9267 (Count: 134)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9148 (Count: 130)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7028 (Count: 120)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9600 (Count: 177)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6965 (Count: 147)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9714 (Count: 150)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7262 (Count: 156)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7205 (Count: 161)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9151 (Count: 181)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9200 (Count: 157)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9723 (Count: 788)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9200 (Count: 347)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8674 (Count: 152)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8638 (Count: 153)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8617 (Count: 219)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8707 (Count: 161)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8429 (Count: 130)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7774 (Count: 137)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8506 (Count: 137)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9193 (Count: 780)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9623 (Count: 286)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9417 (Count: 169)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8873 (Count: 134)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8794 (Count: 320)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6736 (Count: 103)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7767 (Count: 271)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7783 (Count: 138)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8088 (Count: 271)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7725 (Count: 229)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7387 (Count: 209)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9351 (Count: 777)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8498 (Count: 157)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8708 (Count: 247)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 22)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 22)
2025-04-15 14:01:00 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 22: Captured validation outputs and targets for visualization.
2025-04-15 14:01:00 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 22: Captured validation outputs and targets for visualization.
2025-04-15 14:02:49 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:02:49 | INFO     | core.training.train - Epoch 23 [Fine-tuning] Train: Loss=11.5228, Acc=0.7666, Prec=0.7650, Rec=0.7666, F1=0.7654 (109.28s)
2025-04-15 14:02:57 | INFO     | core.training.train - Epoch 23 [Fine-tuning] Val:   Loss=2.2419, Acc=0.9619, Prec=0.9626, Rec=0.9619, F1=0.9618 (7.53s)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 23.
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 23) ---
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9619
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8645 | Median: 0.9318 | Min: 0.1731
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    15.59% (1438/9222)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0975
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8040 (Count: 149)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9041 (Count: 137)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9394 (Count: 150)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8488 (Count: 244)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9415 (Count: 159)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9242 (Count: 205)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9354 (Count: 134)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9105 (Count: 131)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6967 (Count: 119)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9605 (Count: 177)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6959 (Count: 149)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9626 (Count: 150)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7182 (Count: 156)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7268 (Count: 163)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9177 (Count: 181)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9291 (Count: 157)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9731 (Count: 789)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9239 (Count: 346)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8781 (Count: 151)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8830 (Count: 154)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8452 (Count: 216)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8753 (Count: 161)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8373 (Count: 128)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7944 (Count: 136)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8535 (Count: 136)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9205 (Count: 782)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9687 (Count: 287)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9380 (Count: 169)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8742 (Count: 130)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8966 (Count: 324)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6907 (Count: 105)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7883 (Count: 272)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7873 (Count: 139)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7867 (Count: 270)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7655 (Count: 236)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7290 (Count: 200)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9340 (Count: 782)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8168 (Count: 156)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8614 (Count: 241)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 23.
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 23) ---
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9619
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8645 | Median: 0.9318 | Min: 0.1731
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    15.59% (1438/9222)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0975
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8040 (Count: 149)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9041 (Count: 137)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9394 (Count: 150)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8488 (Count: 244)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9415 (Count: 159)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9242 (Count: 205)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9354 (Count: 134)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9105 (Count: 131)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6967 (Count: 119)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9605 (Count: 177)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6959 (Count: 149)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9626 (Count: 150)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7182 (Count: 156)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7268 (Count: 163)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9177 (Count: 181)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9291 (Count: 157)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9731 (Count: 789)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9239 (Count: 346)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8781 (Count: 151)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8830 (Count: 154)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8452 (Count: 216)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8753 (Count: 161)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8373 (Count: 128)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7944 (Count: 136)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8535 (Count: 136)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9205 (Count: 782)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9687 (Count: 287)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9380 (Count: 169)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8742 (Count: 130)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8966 (Count: 324)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6907 (Count: 105)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7883 (Count: 272)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7873 (Count: 139)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7867 (Count: 270)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7655 (Count: 236)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7290 (Count: 200)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9340 (Count: 782)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8168 (Count: 156)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8614 (Count: 241)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 23)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 23)
2025-04-15 14:02:58 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 23: Captured validation outputs and targets for visualization.
2025-04-15 14:02:58 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 23: Captured validation outputs and targets for visualization.
2025-04-15 14:04:48 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:04:48 | INFO     | core.training.train - Epoch 24 [Fine-tuning] Train: Loss=11.4130, Acc=0.7684, Prec=0.7669, Rec=0.7684, F1=0.7674 (109.69s)
2025-04-15 14:04:56 | INFO     | core.training.train - Epoch 24 [Fine-tuning] Val:   Loss=2.2546, Acc=0.9618, Prec=0.9628, Rec=0.9618, F1=0.9618 (7.55s)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 24.
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 24) ---
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9618
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8631 | Median: 0.9285 | Min: 0.1955
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    15.64% (1442/9222)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0991
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8094 (Count: 152)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9122 (Count: 137)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9445 (Count: 150)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8445 (Count: 245)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9461 (Count: 159)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9214 (Count: 204)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9223 (Count: 134)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9172 (Count: 130)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6836 (Count: 119)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9548 (Count: 178)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7133 (Count: 151)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9624 (Count: 149)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7340 (Count: 157)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7214 (Count: 160)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9159 (Count: 181)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9337 (Count: 157)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9722 (Count: 788)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9376 (Count: 348)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8628 (Count: 152)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8910 (Count: 155)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8461 (Count: 212)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8912 (Count: 160)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8337 (Count: 130)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7870 (Count: 137)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8472 (Count: 137)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8989 (Count: 777)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9617 (Count: 285)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9413 (Count: 170)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8605 (Count: 133)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8902 (Count: 325)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6979 (Count: 110)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7898 (Count: 271)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7851 (Count: 142)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8081 (Count: 271)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7606 (Count: 229)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7266 (Count: 202)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9309 (Count: 778)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8291 (Count: 156)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8577 (Count: 239)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 24.
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 24) ---
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9618
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8631 | Median: 0.9285 | Min: 0.1955
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    15.64% (1442/9222)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0991
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8094 (Count: 152)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9122 (Count: 137)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9445 (Count: 150)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8445 (Count: 245)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9461 (Count: 159)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9214 (Count: 204)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9223 (Count: 134)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9172 (Count: 130)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6836 (Count: 119)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9548 (Count: 178)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7133 (Count: 151)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9624 (Count: 149)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7340 (Count: 157)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7214 (Count: 160)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9159 (Count: 181)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9337 (Count: 157)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9722 (Count: 788)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9376 (Count: 348)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8628 (Count: 152)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8910 (Count: 155)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8461 (Count: 212)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8912 (Count: 160)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8337 (Count: 130)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7870 (Count: 137)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8472 (Count: 137)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8989 (Count: 777)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9617 (Count: 285)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9413 (Count: 170)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8605 (Count: 133)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8902 (Count: 325)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6979 (Count: 110)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7898 (Count: 271)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7851 (Count: 142)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8081 (Count: 271)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7606 (Count: 229)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7266 (Count: 202)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9309 (Count: 778)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8291 (Count: 156)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8577 (Count: 239)
2025-04-15 14:04:56 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 24)
2025-04-15 14:04:57 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 24)
2025-04-15 14:04:57 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 24: Captured validation outputs and targets for visualization.
2025-04-15 14:04:57 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 24: Captured validation outputs and targets for visualization.
2025-04-15 14:06:46 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:06:46 | INFO     | core.training.train - Epoch 25 [Fine-tuning] Train: Loss=11.3953, Acc=0.7683, Prec=0.7668, Rec=0.7683, F1=0.7671 (108.92s)
2025-04-15 14:06:53 | INFO     | core.training.train - Epoch 25 [Fine-tuning] Val:   Loss=2.2070, Acc=0.9627, Prec=0.9634, Rec=0.9627, F1=0.9625 (7.45s)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 25): Current confidence=0.8631, Change=-0.0014
2025-04-15 14:06:54 | INFO     | core.training.callbacks.adaptive_weight -   Adjusted Focal Loss gamma: 2.04 -> 2.00
2025-04-15 14:06:54 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 25): Current confidence=0.8631, Change=-0.0014
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 25.
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 25) ---
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9627
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8690 | Median: 0.9344 | Min: 0.1835
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    14.93% (1377/9222)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0938
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8052 (Count: 149)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9158 (Count: 137)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9405 (Count: 150)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8628 (Count: 244)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9408 (Count: 159)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9336 (Count: 205)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9328 (Count: 133)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9183 (Count: 131)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7034 (Count: 120)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9659 (Count: 178)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6982 (Count: 148)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9705 (Count: 150)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7244 (Count: 156)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7324 (Count: 163)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9218 (Count: 180)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9371 (Count: 158)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9732 (Count: 787)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9287 (Count: 347)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8801 (Count: 150)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8837 (Count: 154)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8636 (Count: 219)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8915 (Count: 161)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8259 (Count: 129)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8028 (Count: 137)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8542 (Count: 137)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9145 (Count: 782)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9707 (Count: 286)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9415 (Count: 170)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8819 (Count: 133)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8807 (Count: 321)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6778 (Count: 104)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7879 (Count: 272)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7915 (Count: 137)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8152 (Count: 272)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7896 (Count: 234)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7416 (Count: 204)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9321 (Count: 777)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8399 (Count: 156)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8830 (Count: 248)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 25.
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 25) ---
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9627
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8690 | Median: 0.9344 | Min: 0.1835
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    14.93% (1377/9222)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0938
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8052 (Count: 149)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9158 (Count: 137)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9405 (Count: 150)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8628 (Count: 244)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9408 (Count: 159)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9336 (Count: 205)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9328 (Count: 133)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9183 (Count: 131)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7034 (Count: 120)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9659 (Count: 178)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6982 (Count: 148)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9705 (Count: 150)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7244 (Count: 156)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7324 (Count: 163)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9218 (Count: 180)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9371 (Count: 158)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9732 (Count: 787)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9287 (Count: 347)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8801 (Count: 150)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8837 (Count: 154)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8636 (Count: 219)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8915 (Count: 161)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8259 (Count: 129)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8028 (Count: 137)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8542 (Count: 137)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9145 (Count: 782)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9707 (Count: 286)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9415 (Count: 170)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8819 (Count: 133)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8807 (Count: 321)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6778 (Count: 104)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7879 (Count: 272)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7915 (Count: 137)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8152 (Count: 272)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7896 (Count: 234)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7416 (Count: 204)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9321 (Count: 777)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8399 (Count: 156)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8830 (Count: 248)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 25)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 25)
2025-04-15 14:06:54 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 25: Captured validation outputs and targets for visualization.
2025-04-15 14:06:54 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 25: Captured validation outputs and targets for visualization.
2025-04-15 14:08:44 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:08:44 | INFO     | core.training.train - Epoch 26 [Fine-tuning] Train: Loss=11.3749, Acc=0.7715, Prec=0.7700, Rec=0.7715, F1=0.7705 (109.41s)
2025-04-15 14:08:51 | INFO     | core.training.train - Epoch 26 [Fine-tuning] Val:   Loss=2.2182, Acc=0.9620, Prec=0.9630, Rec=0.9620, F1=0.9620 (7.50s)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 26.
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 26) ---
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9620
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8700 | Median: 0.9353 | Min: 0.1891
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    14.47% (1334/9222)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0921
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8281 (Count: 152)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9125 (Count: 137)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9421 (Count: 150)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8513 (Count: 246)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9486 (Count: 159)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9218 (Count: 204)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9291 (Count: 134)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9162 (Count: 130)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6931 (Count: 119)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9669 (Count: 178)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7143 (Count: 150)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9649 (Count: 150)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7252 (Count: 156)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7374 (Count: 163)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9229 (Count: 180)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9370 (Count: 158)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9752 (Count: 788)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9311 (Count: 346)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8861 (Count: 153)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8977 (Count: 156)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8490 (Count: 215)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8828 (Count: 162)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8441 (Count: 129)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8101 (Count: 138)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8756 (Count: 135)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9168 (Count: 780)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9676 (Count: 285)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9356 (Count: 170)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8788 (Count: 132)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8979 (Count: 325)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6982 (Count: 107)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7950 (Count: 271)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7992 (Count: 139)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8148 (Count: 273)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7864 (Count: 226)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7484 (Count: 206)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9328 (Count: 775)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8322 (Count: 156)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8560 (Count: 239)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 26.
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 26) ---
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9620
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8700 | Median: 0.9353 | Min: 0.1891
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    14.47% (1334/9222)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0921
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8281 (Count: 152)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9125 (Count: 137)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9421 (Count: 150)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8513 (Count: 246)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9486 (Count: 159)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9218 (Count: 204)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9291 (Count: 134)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9162 (Count: 130)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6931 (Count: 119)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9669 (Count: 178)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7143 (Count: 150)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9649 (Count: 150)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7252 (Count: 156)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7374 (Count: 163)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9229 (Count: 180)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9370 (Count: 158)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9752 (Count: 788)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9311 (Count: 346)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8861 (Count: 153)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8977 (Count: 156)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8490 (Count: 215)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8828 (Count: 162)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8441 (Count: 129)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8101 (Count: 138)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8756 (Count: 135)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9168 (Count: 780)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9676 (Count: 285)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9356 (Count: 170)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8788 (Count: 132)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8979 (Count: 325)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6982 (Count: 107)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7950 (Count: 271)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7992 (Count: 139)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8148 (Count: 273)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7864 (Count: 226)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7484 (Count: 206)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9328 (Count: 775)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8322 (Count: 156)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8560 (Count: 239)
2025-04-15 14:08:52 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 26)
2025-04-15 14:08:53 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 26)
2025-04-15 14:08:53 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 26: Captured validation outputs and targets for visualization.
2025-04-15 14:08:53 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 26: Captured validation outputs and targets for visualization.
2025-04-15 14:10:42 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:10:42 | INFO     | core.training.train - Epoch 27 [Fine-tuning] Train: Loss=11.0583, Acc=0.7780, Prec=0.7767, Rec=0.7780, F1=0.7770 (109.28s)
2025-04-15 14:10:50 | INFO     | core.training.train - Epoch 27 [Fine-tuning] Val:   Loss=2.1853, Acc=0.9639, Prec=0.9647, Rec=0.9639, F1=0.9638 (7.50s)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 27.
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 27) ---
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9639
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8706 | Median: 0.9362 | Min: 0.1707
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    14.47% (1334/9222)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0934
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8240 (Count: 153)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9037 (Count: 137)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9480 (Count: 150)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8693 (Count: 245)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9426 (Count: 159)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9305 (Count: 205)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9312 (Count: 134)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9095 (Count: 130)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7089 (Count: 121)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9665 (Count: 178)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6944 (Count: 149)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9643 (Count: 150)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7361 (Count: 157)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7356 (Count: 162)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9344 (Count: 181)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9416 (Count: 157)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9782 (Count: 788)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9260 (Count: 346)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8872 (Count: 151)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8902 (Count: 155)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8610 (Count: 218)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8709 (Count: 163)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8435 (Count: 131)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8060 (Count: 139)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8617 (Count: 138)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9085 (Count: 779)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9692 (Count: 286)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9372 (Count: 169)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8759 (Count: 132)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8979 (Count: 324)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7220 (Count: 107)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7960 (Count: 276)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7836 (Count: 139)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7968 (Count: 273)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7919 (Count: 230)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7527 (Count: 203)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9396 (Count: 779)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8171 (Count: 156)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8644 (Count: 239)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 27.
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 27) ---
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9639
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8706 | Median: 0.9362 | Min: 0.1707
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    14.47% (1334/9222)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0934
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8240 (Count: 153)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9037 (Count: 137)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9480 (Count: 150)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8693 (Count: 245)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9426 (Count: 159)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9305 (Count: 205)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9312 (Count: 134)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9095 (Count: 130)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7089 (Count: 121)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9665 (Count: 178)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6944 (Count: 149)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9643 (Count: 150)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7361 (Count: 157)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7356 (Count: 162)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9344 (Count: 181)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9416 (Count: 157)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9782 (Count: 788)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9260 (Count: 346)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8872 (Count: 151)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8902 (Count: 155)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8610 (Count: 218)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8709 (Count: 163)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8435 (Count: 131)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8060 (Count: 139)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8617 (Count: 138)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9085 (Count: 779)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9692 (Count: 286)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9372 (Count: 169)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8759 (Count: 132)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8979 (Count: 324)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7220 (Count: 107)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7960 (Count: 276)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7836 (Count: 139)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.7968 (Count: 273)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7919 (Count: 230)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7527 (Count: 203)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9396 (Count: 779)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8171 (Count: 156)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8644 (Count: 239)
2025-04-15 14:10:50 | INFO     | core.training.callbacks.model_checkpoint - Epoch 27: val_loss improved from 2.204812 to 2.185314.
2025-04-15 14:10:50 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 27)
2025-04-15 14:10:51 | INFO     | core.training.callbacks.model_checkpoint - Epoch 27: val_loss improved from 2.204812 to 2.185314.
2025-04-15 14:10:51 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 27)
2025-04-15 14:10:51 | INFO     | core.training.callbacks.early_stopping - Epoch 27: EarlyStopping val_loss improved from 2.204812 to 2.185314
2025-04-15 14:10:51 | INFO     | core.training.callbacks.early_stopping - Epoch 27: EarlyStopping val_loss improved from 2.204812 to 2.185314
2025-04-15 14:10:51 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 27: Captured validation outputs and targets for visualization.
2025-04-15 14:10:51 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 27: Captured validation outputs and targets for visualization.
2025-04-15 14:12:41 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:12:41 | INFO     | core.training.train - Epoch 28 [Fine-tuning] Train: Loss=11.0016, Acc=0.7765, Prec=0.7749, Rec=0.7765, F1=0.7753 (109.67s)
2025-04-15 14:12:49 | INFO     | core.training.train - Epoch 28 [Fine-tuning] Val:   Loss=2.1764, Acc=0.9638, Prec=0.9646, Rec=0.9638, F1=0.9637 (7.64s)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 28.
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 28) ---
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9638
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8716 | Median: 0.9375 | Min: 0.2006
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    14.08% (1298/9222)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0922
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8242 (Count: 148)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9355 (Count: 137)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9494 (Count: 150)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8643 (Count: 245)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9467 (Count: 160)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9304 (Count: 204)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9333 (Count: 134)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9184 (Count: 130)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7035 (Count: 120)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9692 (Count: 178)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7047 (Count: 150)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9694 (Count: 150)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7353 (Count: 155)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7352 (Count: 163)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9137 (Count: 180)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9417 (Count: 158)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9694 (Count: 788)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9245 (Count: 346)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8812 (Count: 150)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8768 (Count: 154)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8652 (Count: 218)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8907 (Count: 161)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8388 (Count: 132)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7881 (Count: 139)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8626 (Count: 138)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9134 (Count: 780)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9695 (Count: 285)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9505 (Count: 170)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8804 (Count: 133)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8915 (Count: 322)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7073 (Count: 106)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7965 (Count: 273)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7897 (Count: 140)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8276 (Count: 273)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7893 (Count: 229)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7518 (Count: 207)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9339 (Count: 779)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8454 (Count: 157)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8737 (Count: 246)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 28.
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 28) ---
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9638
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8716 | Median: 0.9375 | Min: 0.2006
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    14.08% (1298/9222)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0922
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8242 (Count: 148)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9355 (Count: 137)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9494 (Count: 150)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8643 (Count: 245)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9467 (Count: 160)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9304 (Count: 204)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9333 (Count: 134)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9184 (Count: 130)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7035 (Count: 120)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9692 (Count: 178)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7047 (Count: 150)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9694 (Count: 150)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7353 (Count: 155)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7352 (Count: 163)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9137 (Count: 180)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9417 (Count: 158)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9694 (Count: 788)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9245 (Count: 346)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8812 (Count: 150)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8768 (Count: 154)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8652 (Count: 218)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8907 (Count: 161)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8388 (Count: 132)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7881 (Count: 139)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8626 (Count: 138)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9134 (Count: 780)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9695 (Count: 285)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9505 (Count: 170)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8804 (Count: 133)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8915 (Count: 322)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7073 (Count: 106)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7965 (Count: 273)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7897 (Count: 140)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8276 (Count: 273)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7893 (Count: 229)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7518 (Count: 207)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9339 (Count: 779)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8454 (Count: 157)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8737 (Count: 246)
2025-04-15 14:12:49 | INFO     | core.training.callbacks.model_checkpoint - Epoch 28: val_loss improved from 2.185314 to 2.176398.
2025-04-15 14:12:50 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 28)
2025-04-15 14:12:50 | INFO     | core.training.callbacks.model_checkpoint - Epoch 28: val_loss improved from 2.185314 to 2.176398.
2025-04-15 14:12:50 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 28)
2025-04-15 14:12:50 | INFO     | core.training.callbacks.early_stopping - Epoch 28: EarlyStopping val_loss improved from 2.185314 to 2.176398
2025-04-15 14:12:50 | INFO     | core.training.callbacks.early_stopping - Epoch 28: EarlyStopping val_loss improved from 2.185314 to 2.176398
2025-04-15 14:12:50 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 28: Captured validation outputs and targets for visualization.
2025-04-15 14:12:50 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 28: Captured validation outputs and targets for visualization.
2025-04-15 14:14:40 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:14:40 | INFO     | core.training.train - Epoch 29 [Fine-tuning] Train: Loss=10.9174, Acc=0.7781, Prec=0.7766, Rec=0.7781, F1=0.7769 (109.97s)
2025-04-15 14:14:48 | INFO     | core.training.train - Epoch 29 [Fine-tuning] Val:   Loss=2.1903, Acc=0.9641, Prec=0.9649, Rec=0.9641, F1=0.9640 (7.52s)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 29.
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 29) ---
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9641
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8728 | Median: 0.9384 | Min: 0.1864
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    14.06% (1297/9222)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0918
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8467 (Count: 151)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9288 (Count: 137)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9459 (Count: 150)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8646 (Count: 246)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9441 (Count: 159)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9327 (Count: 205)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9330 (Count: 135)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9258 (Count: 131)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7193 (Count: 125)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9612 (Count: 177)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6905 (Count: 147)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9662 (Count: 150)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7268 (Count: 155)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7461 (Count: 165)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9338 (Count: 181)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9420 (Count: 159)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9716 (Count: 788)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9258 (Count: 345)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8758 (Count: 151)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8900 (Count: 156)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8642 (Count: 218)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8948 (Count: 162)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8328 (Count: 131)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7932 (Count: 138)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8722 (Count: 138)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9152 (Count: 780)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9676 (Count: 287)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9491 (Count: 170)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8799 (Count: 133)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9018 (Count: 324)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6913 (Count: 103)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8027 (Count: 272)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8003 (Count: 140)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8305 (Count: 273)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7853 (Count: 228)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7513 (Count: 205)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9317 (Count: 776)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8326 (Count: 155)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8662 (Count: 245)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 29.
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 29) ---
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9641
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8728 | Median: 0.9384 | Min: 0.1864
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    14.06% (1297/9222)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0918
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8467 (Count: 151)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9288 (Count: 137)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9459 (Count: 150)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8646 (Count: 246)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9441 (Count: 159)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9327 (Count: 205)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9330 (Count: 135)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9258 (Count: 131)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7193 (Count: 125)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9612 (Count: 177)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.6905 (Count: 147)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9662 (Count: 150)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7268 (Count: 155)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7461 (Count: 165)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9338 (Count: 181)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9420 (Count: 159)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9716 (Count: 788)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9258 (Count: 345)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8758 (Count: 151)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8900 (Count: 156)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8642 (Count: 218)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8948 (Count: 162)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8328 (Count: 131)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7932 (Count: 138)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8722 (Count: 138)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9152 (Count: 780)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9676 (Count: 287)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9491 (Count: 170)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8799 (Count: 133)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9018 (Count: 324)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6913 (Count: 103)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8027 (Count: 272)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8003 (Count: 140)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8305 (Count: 273)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7853 (Count: 228)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7513 (Count: 205)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9317 (Count: 776)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8326 (Count: 155)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8662 (Count: 245)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 29)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 29)
2025-04-15 14:14:49 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 29: Captured validation outputs and targets for visualization.
2025-04-15 14:14:49 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 29: Captured validation outputs and targets for visualization.
2025-04-15 14:16:39 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:16:39 | INFO     | core.training.train - Epoch 30 [Fine-tuning] Train: Loss=10.9648, Acc=0.7776, Prec=0.7760, Rec=0.7776, F1=0.7764 (109.65s)
2025-04-15 14:16:47 | INFO     | core.training.train - Epoch 30 [Fine-tuning] Val:   Loss=2.1434, Acc=0.9639, Prec=0.9647, Rec=0.9639, F1=0.9638 (7.53s)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 30): Current confidence=0.8728, Change=+0.0012
2025-04-15 14:16:47 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 30): Current confidence=0.8728, Change=+0.0012
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 30.
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 30) ---
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9639
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8739 | Median: 0.9389 | Min: 0.1834
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    13.68% (1262/9222)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0901
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8438 (Count: 150)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9198 (Count: 137)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9572 (Count: 150)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8697 (Count: 245)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9459 (Count: 160)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9367 (Count: 205)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9338 (Count: 134)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9251 (Count: 131)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7002 (Count: 119)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9650 (Count: 178)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7090 (Count: 150)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9598 (Count: 150)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7405 (Count: 156)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7400 (Count: 163)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9304 (Count: 180)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9395 (Count: 157)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9747 (Count: 788)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9328 (Count: 347)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8748 (Count: 151)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8987 (Count: 155)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8621 (Count: 215)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8838 (Count: 162)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8496 (Count: 132)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8035 (Count: 139)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8663 (Count: 137)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9106 (Count: 779)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9688 (Count: 285)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9368 (Count: 170)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8798 (Count: 133)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8936 (Count: 321)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7272 (Count: 107)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8066 (Count: 276)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8060 (Count: 140)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8127 (Count: 273)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7923 (Count: 233)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7501 (Count: 204)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9383 (Count: 779)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8390 (Count: 156)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8742 (Count: 242)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 30.
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 30) ---
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9639
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8739 | Median: 0.9389 | Min: 0.1834
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    13.68% (1262/9222)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0901
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8438 (Count: 150)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9198 (Count: 137)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9572 (Count: 150)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8697 (Count: 245)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9459 (Count: 160)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9367 (Count: 205)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9338 (Count: 134)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9251 (Count: 131)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7002 (Count: 119)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9650 (Count: 178)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7090 (Count: 150)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9598 (Count: 150)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7405 (Count: 156)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7400 (Count: 163)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9304 (Count: 180)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9395 (Count: 157)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9747 (Count: 788)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9328 (Count: 347)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8748 (Count: 151)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8987 (Count: 155)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8621 (Count: 215)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8838 (Count: 162)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8496 (Count: 132)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8035 (Count: 139)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8663 (Count: 137)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9106 (Count: 779)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9688 (Count: 285)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9368 (Count: 170)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8798 (Count: 133)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8936 (Count: 321)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7272 (Count: 107)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8066 (Count: 276)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8060 (Count: 140)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8127 (Count: 273)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7923 (Count: 233)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7501 (Count: 204)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9383 (Count: 779)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8390 (Count: 156)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8742 (Count: 242)
2025-04-15 14:16:47 | INFO     | core.training.callbacks.model_checkpoint - Epoch 30: val_loss improved from 2.176398 to 2.143403.
2025-04-15 14:16:47 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 30)
2025-04-15 14:16:48 | INFO     | core.training.callbacks.model_checkpoint - Epoch 30: val_loss improved from 2.176398 to 2.143403.
2025-04-15 14:16:48 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 30)
2025-04-15 14:16:48 | INFO     | core.training.callbacks.early_stopping - Epoch 30: EarlyStopping val_loss improved from 2.176398 to 2.143403
2025-04-15 14:16:48 | INFO     | core.training.callbacks.early_stopping - Epoch 30: EarlyStopping val_loss improved from 2.176398 to 2.143403
2025-04-15 14:16:48 | INFO     | core.training.callbacks.gradcam_callback - Generating GradCAM visualizations at epoch 30
2025-04-15 14:16:48 | INFO     | core.models.model_cbam18 - Using layer4[-1].conv2 as GradCAM target layer
2025-04-15 14:16:48 | INFO     | core.evaluation.interpretability - Using model's recommended GradCAM target layer
2025-04-15 14:16:48 | INFO     | core.evaluation.interpretability - GradCAM initialized with target layer: Conv2d
2025-04-15 14:16:48 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:49 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:49 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:50 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:50 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:50 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:51 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:51 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:52 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:52 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:53 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:53 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:53 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:54 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:54 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:55 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:55 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:56 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:56 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:56 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:57 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:57 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:58 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:16:58 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:17:00 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:17:01 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:17:01 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:17:02 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:17:02 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:17:03 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:17:03 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:17:03 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:17:04 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:17:04 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:17:05 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:17:06 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:17:06 | INFO     | core.training.callbacks.gradcam_callback - Generated summary HTML: outputs/cbam_only_resnet18_v2/gradcam/epoch_030/gradcam_summary.html
2025-04-15 14:17:06 | INFO     | core.training.callbacks.gradcam_callback - GradCAM visualizations saved to outputs/cbam_only_resnet18_v2/gradcam/epoch_030
2025-04-15 14:17:06 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 30: Captured validation outputs and targets for visualization.
2025-04-15 14:17:06 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 30: Captured validation outputs and targets for visualization.
2025-04-15 14:18:59 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:18:59 | INFO     | core.training.train - Epoch 31 [Fine-tuning] Train: Loss=10.6372, Acc=0.7857, Prec=0.7842, Rec=0.7857, F1=0.7847 (112.67s)
2025-04-15 14:19:07 | INFO     | core.training.train - Epoch 31 [Fine-tuning] Val:   Loss=2.1673, Acc=0.9653, Prec=0.9662, Rec=0.9653, F1=0.9652 (7.85s)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 31.
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 31) ---
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9653
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8768 | Median: 0.9417 | Min: 0.1826
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    13.45% (1240/9222)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0885
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8489 (Count: 153)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9381 (Count: 137)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9611 (Count: 150)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8603 (Count: 245)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9414 (Count: 160)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9324 (Count: 205)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9417 (Count: 135)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9335 (Count: 131)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7062 (Count: 122)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9618 (Count: 178)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7043 (Count: 150)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9654 (Count: 150)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7362 (Count: 155)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7483 (Count: 165)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9189 (Count: 180)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9461 (Count: 158)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9738 (Count: 788)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9241 (Count: 348)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8714 (Count: 152)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8861 (Count: 155)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8660 (Count: 217)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8764 (Count: 160)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8507 (Count: 131)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8095 (Count: 138)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8808 (Count: 136)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9148 (Count: 780)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9755 (Count: 286)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9447 (Count: 170)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8795 (Count: 133)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8971 (Count: 323)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6938 (Count: 104)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8073 (Count: 273)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7918 (Count: 141)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8315 (Count: 274)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7912 (Count: 224)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7698 (Count: 209)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9439 (Count: 781)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8690 (Count: 159)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8760 (Count: 246)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 31.
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 31) ---
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9653
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8768 | Median: 0.9417 | Min: 0.1826
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    13.45% (1240/9222)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0885
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8489 (Count: 153)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9381 (Count: 137)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9611 (Count: 150)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8603 (Count: 245)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9414 (Count: 160)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9324 (Count: 205)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9417 (Count: 135)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9335 (Count: 131)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7062 (Count: 122)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9618 (Count: 178)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7043 (Count: 150)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9654 (Count: 150)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7362 (Count: 155)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7483 (Count: 165)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9189 (Count: 180)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9461 (Count: 158)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9738 (Count: 788)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9241 (Count: 348)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8714 (Count: 152)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8861 (Count: 155)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8660 (Count: 217)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8764 (Count: 160)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8507 (Count: 131)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8095 (Count: 138)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8808 (Count: 136)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9148 (Count: 780)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9755 (Count: 286)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9447 (Count: 170)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8795 (Count: 133)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8971 (Count: 323)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6938 (Count: 104)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8073 (Count: 273)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7918 (Count: 141)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8315 (Count: 274)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7912 (Count: 224)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7698 (Count: 209)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9439 (Count: 781)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8690 (Count: 159)
2025-04-15 14:19:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8760 (Count: 246)
2025-04-15 14:19:08 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 31)
2025-04-15 14:19:08 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 31)
2025-04-15 14:19:08 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 31: Captured validation outputs and targets for visualization.
2025-04-15 14:19:08 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 31: Captured validation outputs and targets for visualization.
2025-04-15 14:21:00 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:21:00 | INFO     | core.training.train - Epoch 32 [Fine-tuning] Train: Loss=10.6883, Acc=0.7819, Prec=0.7808, Rec=0.7819, F1=0.7810 (112.13s)
2025-04-15 14:21:08 | INFO     | core.training.train - Epoch 32 [Fine-tuning] Val:   Loss=2.1362, Acc=0.9655, Prec=0.9663, Rec=0.9655, F1=0.9654 (7.81s)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 32.
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 32) ---
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9655
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8771 | Median: 0.9422 | Min: 0.1587
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    13.38% (1234/9222)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0885
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8458 (Count: 154)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9270 (Count: 137)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9589 (Count: 150)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8723 (Count: 244)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9393 (Count: 159)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9453 (Count: 205)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9433 (Count: 135)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9357 (Count: 132)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7076 (Count: 119)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9560 (Count: 178)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7127 (Count: 151)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9627 (Count: 150)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7540 (Count: 156)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7346 (Count: 161)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9342 (Count: 180)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9466 (Count: 158)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9739 (Count: 788)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9262 (Count: 347)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8778 (Count: 151)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8938 (Count: 154)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8829 (Count: 217)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8887 (Count: 161)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8419 (Count: 130)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7961 (Count: 137)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8735 (Count: 138)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9053 (Count: 778)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9710 (Count: 286)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9395 (Count: 170)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8913 (Count: 133)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8978 (Count: 323)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7044 (Count: 108)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8114 (Count: 277)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7965 (Count: 141)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8321 (Count: 275)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7954 (Count: 236)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7472 (Count: 202)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9471 (Count: 782)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8533 (Count: 157)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8767 (Count: 244)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 32.
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 32) ---
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9655
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8771 | Median: 0.9422 | Min: 0.1587
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    13.38% (1234/9222)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0885
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8458 (Count: 154)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9270 (Count: 137)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9589 (Count: 150)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8723 (Count: 244)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9393 (Count: 159)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9453 (Count: 205)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9433 (Count: 135)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9357 (Count: 132)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7076 (Count: 119)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9560 (Count: 178)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7127 (Count: 151)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9627 (Count: 150)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7540 (Count: 156)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7346 (Count: 161)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9342 (Count: 180)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9466 (Count: 158)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9739 (Count: 788)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9262 (Count: 347)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8778 (Count: 151)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8938 (Count: 154)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8829 (Count: 217)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8887 (Count: 161)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8419 (Count: 130)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7961 (Count: 137)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8735 (Count: 138)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9053 (Count: 778)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9710 (Count: 286)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9395 (Count: 170)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8913 (Count: 133)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8978 (Count: 323)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7044 (Count: 108)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8114 (Count: 277)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.7965 (Count: 141)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8321 (Count: 275)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7954 (Count: 236)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7472 (Count: 202)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9471 (Count: 782)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8533 (Count: 157)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8767 (Count: 244)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.model_checkpoint - Epoch 32: val_loss improved from 2.143403 to 2.136218.
2025-04-15 14:21:09 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 32)
2025-04-15 14:21:09 | INFO     | core.training.callbacks.model_checkpoint - Epoch 32: val_loss improved from 2.143403 to 2.136218.
2025-04-15 14:21:10 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 32)
2025-04-15 14:21:10 | INFO     | core.training.callbacks.early_stopping - Epoch 32: EarlyStopping val_loss improved from 2.143403 to 2.136218
2025-04-15 14:21:10 | INFO     | core.training.callbacks.early_stopping - Epoch 32: EarlyStopping val_loss improved from 2.143403 to 2.136218
2025-04-15 14:21:10 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 32: Captured validation outputs and targets for visualization.
2025-04-15 14:21:10 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 32: Captured validation outputs and targets for visualization.
2025-04-15 14:23:04 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:23:04 | INFO     | core.training.train - Epoch 33 [Fine-tuning] Train: Loss=10.3919, Acc=0.7880, Prec=0.7867, Rec=0.7880, F1=0.7870 (114.69s)
2025-04-15 14:23:13 | INFO     | core.training.train - Epoch 33 [Fine-tuning] Val:   Loss=2.1465, Acc=0.9640, Prec=0.9648, Rec=0.9640, F1=0.9639 (7.92s)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 33.
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 33) ---
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9640
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8757 | Median: 0.9404 | Min: 0.1613
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    13.36% (1232/9222)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0883
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8501 (Count: 151)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9215 (Count: 138)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9627 (Count: 150)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8805 (Count: 246)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9403 (Count: 160)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9295 (Count: 205)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9356 (Count: 135)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9375 (Count: 130)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7139 (Count: 120)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9652 (Count: 178)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7051 (Count: 150)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9581 (Count: 149)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7442 (Count: 155)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7480 (Count: 162)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9316 (Count: 180)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9433 (Count: 158)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9733 (Count: 788)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9338 (Count: 350)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8654 (Count: 152)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9072 (Count: 156)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8579 (Count: 215)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8897 (Count: 162)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8426 (Count: 132)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8065 (Count: 137)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8710 (Count: 138)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9066 (Count: 780)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9697 (Count: 286)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9442 (Count: 170)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8741 (Count: 133)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9066 (Count: 324)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7450 (Count: 106)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8028 (Count: 271)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8031 (Count: 141)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8198 (Count: 271)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7949 (Count: 229)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7569 (Count: 206)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9413 (Count: 779)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8414 (Count: 156)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8670 (Count: 241)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 33.
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 33) ---
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9640
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8757 | Median: 0.9404 | Min: 0.1613
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    13.36% (1232/9222)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0883
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8501 (Count: 151)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9215 (Count: 138)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9627 (Count: 150)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8805 (Count: 246)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9403 (Count: 160)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9295 (Count: 205)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9356 (Count: 135)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9375 (Count: 130)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7139 (Count: 120)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9652 (Count: 178)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7051 (Count: 150)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9581 (Count: 149)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7442 (Count: 155)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7480 (Count: 162)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9316 (Count: 180)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9433 (Count: 158)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9733 (Count: 788)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9338 (Count: 350)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8654 (Count: 152)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9072 (Count: 156)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8579 (Count: 215)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8897 (Count: 162)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8426 (Count: 132)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8065 (Count: 137)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8710 (Count: 138)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9066 (Count: 780)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9697 (Count: 286)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9442 (Count: 170)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8741 (Count: 133)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9066 (Count: 324)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7450 (Count: 106)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8028 (Count: 271)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8031 (Count: 141)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8198 (Count: 271)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7949 (Count: 229)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7569 (Count: 206)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9413 (Count: 779)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8414 (Count: 156)
2025-04-15 14:23:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8670 (Count: 241)
2025-04-15 14:23:14 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 33)
2025-04-15 14:23:14 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 33)
2025-04-15 14:23:14 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 33: Captured validation outputs and targets for visualization.
2025-04-15 14:23:14 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 33: Captured validation outputs and targets for visualization.
2025-04-15 14:25:07 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:25:07 | INFO     | core.training.train - Epoch 34 [Fine-tuning] Train: Loss=10.3644, Acc=0.7888, Prec=0.7873, Rec=0.7888, F1=0.7877 (113.49s)
2025-04-15 14:25:16 | INFO     | core.training.train - Epoch 34 [Fine-tuning] Val:   Loss=2.1373, Acc=0.9663, Prec=0.9672, Rec=0.9663, F1=0.9661 (8.15s)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 34.
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 34) ---
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9663
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8795 | Median: 0.9447 | Min: 0.1877
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    13.01% (1200/9222)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0868
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8441 (Count: 153)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9275 (Count: 138)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9563 (Count: 150)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8766 (Count: 246)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9407 (Count: 160)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9456 (Count: 205)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9353 (Count: 135)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9405 (Count: 131)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6851 (Count: 115)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9672 (Count: 178)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7347 (Count: 151)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9691 (Count: 150)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7439 (Count: 155)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7529 (Count: 166)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9374 (Count: 180)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9470 (Count: 159)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9757 (Count: 788)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9329 (Count: 350)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8836 (Count: 152)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8924 (Count: 154)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8783 (Count: 219)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8908 (Count: 162)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8425 (Count: 131)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7995 (Count: 137)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8692 (Count: 135)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9165 (Count: 782)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9706 (Count: 285)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9557 (Count: 170)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8896 (Count: 133)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9124 (Count: 324)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7149 (Count: 106)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8138 (Count: 277)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8144 (Count: 142)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8188 (Count: 274)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7848 (Count: 236)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7544 (Count: 203)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9398 (Count: 780)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8424 (Count: 156)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8711 (Count: 243)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 34.
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 34) ---
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9663
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8795 | Median: 0.9447 | Min: 0.1877
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    13.01% (1200/9222)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0868
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8441 (Count: 153)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9275 (Count: 138)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9563 (Count: 150)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8766 (Count: 246)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9407 (Count: 160)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9456 (Count: 205)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9353 (Count: 135)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9405 (Count: 131)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6851 (Count: 115)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9672 (Count: 178)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7347 (Count: 151)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9691 (Count: 150)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7439 (Count: 155)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7529 (Count: 166)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9374 (Count: 180)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9470 (Count: 159)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9757 (Count: 788)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9329 (Count: 350)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8836 (Count: 152)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8924 (Count: 154)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8783 (Count: 219)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8908 (Count: 162)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8425 (Count: 131)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7995 (Count: 137)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8692 (Count: 135)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9165 (Count: 782)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9706 (Count: 285)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9557 (Count: 170)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8896 (Count: 133)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9124 (Count: 324)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7149 (Count: 106)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8138 (Count: 277)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8144 (Count: 142)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8188 (Count: 274)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7848 (Count: 236)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7544 (Count: 203)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9398 (Count: 780)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8424 (Count: 156)
2025-04-15 14:25:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8711 (Count: 243)
2025-04-15 14:25:17 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 34)
2025-04-15 14:25:17 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 34)
2025-04-15 14:25:17 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 34: Captured validation outputs and targets for visualization.
2025-04-15 14:25:17 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 34: Captured validation outputs and targets for visualization.
2025-04-15 14:27:10 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:27:10 | INFO     | core.training.train - Epoch 35 [Fine-tuning] Train: Loss=10.3014, Acc=0.7890, Prec=0.7876, Rec=0.7890, F1=0.7879 (113.21s)
2025-04-15 14:27:18 | INFO     | core.training.train - Epoch 35 [Fine-tuning] Val:   Loss=2.0968, Acc=0.9669, Prec=0.9677, Rec=0.9669, F1=0.9668 (7.99s)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 35): Current confidence=0.8795, Change=+0.0038
2025-04-15 14:27:19 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 35): Current confidence=0.8795, Change=+0.0038
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 35.
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 35) ---
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9669
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8790 | Median: 0.9430 | Min: 0.1542
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    13.12% (1210/9222)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0881
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8319 (Count: 150)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9264 (Count: 137)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9579 (Count: 150)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8784 (Count: 246)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9403 (Count: 160)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9339 (Count: 206)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9400 (Count: 135)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9334 (Count: 131)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7054 (Count: 120)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9560 (Count: 178)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7070 (Count: 151)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9689 (Count: 150)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7436 (Count: 157)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7507 (Count: 164)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9304 (Count: 180)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9514 (Count: 157)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9728 (Count: 787)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9277 (Count: 349)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8809 (Count: 150)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8878 (Count: 154)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8769 (Count: 220)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8856 (Count: 162)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8550 (Count: 132)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7974 (Count: 138)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8788 (Count: 138)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9215 (Count: 784)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9712 (Count: 285)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9591 (Count: 170)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8869 (Count: 133)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9039 (Count: 323)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7079 (Count: 107)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8159 (Count: 277)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8152 (Count: 141)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8173 (Count: 273)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7918 (Count: 239)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7572 (Count: 203)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9463 (Count: 782)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8560 (Count: 157)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8605 (Count: 241)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 35.
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 35) ---
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9669
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8790 | Median: 0.9430 | Min: 0.1542
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    13.12% (1210/9222)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0881
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8319 (Count: 150)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9264 (Count: 137)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9579 (Count: 150)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8784 (Count: 246)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9403 (Count: 160)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9339 (Count: 206)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9400 (Count: 135)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9334 (Count: 131)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7054 (Count: 120)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9560 (Count: 178)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7070 (Count: 151)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9689 (Count: 150)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7436 (Count: 157)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7507 (Count: 164)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9304 (Count: 180)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9514 (Count: 157)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9728 (Count: 787)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9277 (Count: 349)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8809 (Count: 150)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8878 (Count: 154)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8769 (Count: 220)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8856 (Count: 162)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8550 (Count: 132)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7974 (Count: 138)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8788 (Count: 138)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9215 (Count: 784)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9712 (Count: 285)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9591 (Count: 170)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8869 (Count: 133)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9039 (Count: 323)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7079 (Count: 107)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8159 (Count: 277)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8152 (Count: 141)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8173 (Count: 273)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7918 (Count: 239)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7572 (Count: 203)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9463 (Count: 782)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8560 (Count: 157)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8605 (Count: 241)
2025-04-15 14:27:19 | INFO     | core.training.callbacks.model_checkpoint - Epoch 35: val_loss improved from 2.136218 to 2.096751.
2025-04-15 14:27:19 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 35)
2025-04-15 14:27:20 | INFO     | core.training.callbacks.model_checkpoint - Epoch 35: val_loss improved from 2.136218 to 2.096751.
2025-04-15 14:27:20 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 35)
2025-04-15 14:27:20 | INFO     | core.training.callbacks.early_stopping - Epoch 35: EarlyStopping val_loss improved from 2.136218 to 2.096751
2025-04-15 14:27:20 | INFO     | core.training.callbacks.early_stopping - Epoch 35: EarlyStopping val_loss improved from 2.136218 to 2.096751
2025-04-15 14:27:20 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 35: Captured validation outputs and targets for visualization.
2025-04-15 14:27:20 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 35: Captured validation outputs and targets for visualization.
2025-04-15 14:29:14 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:29:14 | INFO     | core.training.train - Epoch 36 [Fine-tuning] Train: Loss=10.2168, Acc=0.7927, Prec=0.7916, Rec=0.7927, F1=0.7919 (113.42s)
2025-04-15 14:29:22 | INFO     | core.training.train - Epoch 36 [Fine-tuning] Val:   Loss=2.0821, Acc=0.9670, Prec=0.9678, Rec=0.9670, F1=0.9669 (7.76s)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 36.
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 36) ---
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9670
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8796 | Median: 0.9444 | Min: 0.1618
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    13.01% (1200/9222)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0879
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8448 (Count: 152)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9275 (Count: 138)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9607 (Count: 150)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8732 (Count: 246)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9386 (Count: 158)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9431 (Count: 205)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9407 (Count: 135)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9403 (Count: 131)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6956 (Count: 118)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9630 (Count: 178)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7149 (Count: 150)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9650 (Count: 150)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7489 (Count: 157)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7477 (Count: 166)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9381 (Count: 180)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9410 (Count: 158)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9759 (Count: 788)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9293 (Count: 349)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8728 (Count: 148)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8925 (Count: 155)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8739 (Count: 218)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8759 (Count: 162)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8523 (Count: 132)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8111 (Count: 138)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8740 (Count: 138)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9122 (Count: 780)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9747 (Count: 285)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9520 (Count: 170)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8918 (Count: 133)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9124 (Count: 324)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7049 (Count: 106)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8157 (Count: 278)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8285 (Count: 142)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8201 (Count: 274)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7887 (Count: 236)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7423 (Count: 202)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9482 (Count: 783)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8407 (Count: 157)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8856 (Count: 248)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 36.
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 36) ---
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9670
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8796 | Median: 0.9444 | Min: 0.1618
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    13.01% (1200/9222)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0879
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8448 (Count: 152)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9275 (Count: 138)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9607 (Count: 150)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8732 (Count: 246)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9386 (Count: 158)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9431 (Count: 205)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9407 (Count: 135)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9403 (Count: 131)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6956 (Count: 118)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9630 (Count: 178)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7149 (Count: 150)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9650 (Count: 150)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7489 (Count: 157)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7477 (Count: 166)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9381 (Count: 180)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9410 (Count: 158)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9759 (Count: 788)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9293 (Count: 349)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8728 (Count: 148)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8925 (Count: 155)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8739 (Count: 218)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8759 (Count: 162)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8523 (Count: 132)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8111 (Count: 138)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8740 (Count: 138)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9122 (Count: 780)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9747 (Count: 285)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9520 (Count: 170)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8918 (Count: 133)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9124 (Count: 324)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7049 (Count: 106)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8157 (Count: 278)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8285 (Count: 142)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8201 (Count: 274)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7887 (Count: 236)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7423 (Count: 202)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9482 (Count: 783)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8407 (Count: 157)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8856 (Count: 248)
2025-04-15 14:29:22 | INFO     | core.training.callbacks.model_checkpoint - Epoch 36: val_loss improved from 2.096751 to 2.082085.
2025-04-15 14:29:23 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 36)
2025-04-15 14:29:23 | INFO     | core.training.callbacks.model_checkpoint - Epoch 36: val_loss improved from 2.096751 to 2.082085.
2025-04-15 14:29:23 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 36)
2025-04-15 14:29:24 | INFO     | core.training.callbacks.early_stopping - Epoch 36: EarlyStopping val_loss improved from 2.096751 to 2.082085
2025-04-15 14:29:24 | INFO     | core.training.callbacks.early_stopping - Epoch 36: EarlyStopping val_loss improved from 2.096751 to 2.082085
2025-04-15 14:29:24 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 36: Captured validation outputs and targets for visualization.
2025-04-15 14:29:24 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 36: Captured validation outputs and targets for visualization.
2025-04-15 14:31:16 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:31:16 | INFO     | core.training.train - Epoch 37 [Fine-tuning] Train: Loss=9.9808, Acc=0.7963, Prec=0.7951, Rec=0.7963, F1=0.7954 (111.63s)
2025-04-15 14:31:24 | INFO     | core.training.train - Epoch 37 [Fine-tuning] Val:   Loss=2.0911, Acc=0.9670, Prec=0.9678, Rec=0.9670, F1=0.9669 (7.68s)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 37.
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 37) ---
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9670
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8811 | Median: 0.9459 | Min: 0.2142
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    12.80% (1180/9222)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0859
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8513 (Count: 154)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9310 (Count: 138)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9582 (Count: 150)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8824 (Count: 247)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9285 (Count: 160)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9444 (Count: 206)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9426 (Count: 135)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9405 (Count: 131)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7103 (Count: 122)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9612 (Count: 178)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7020 (Count: 151)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9644 (Count: 150)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7685 (Count: 157)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7412 (Count: 161)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9427 (Count: 180)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9490 (Count: 158)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9779 (Count: 788)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9279 (Count: 349)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8761 (Count: 150)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8899 (Count: 155)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8686 (Count: 218)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8923 (Count: 162)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8475 (Count: 132)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8039 (Count: 137)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8736 (Count: 137)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9178 (Count: 783)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9757 (Count: 287)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9489 (Count: 170)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8948 (Count: 133)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9097 (Count: 324)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7317 (Count: 106)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8034 (Count: 277)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8072 (Count: 140)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8282 (Count: 274)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7916 (Count: 228)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7655 (Count: 207)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9455 (Count: 781)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8442 (Count: 156)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8849 (Count: 246)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 37.
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 37) ---
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9670
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8811 | Median: 0.9459 | Min: 0.2142
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    12.80% (1180/9222)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0859
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8513 (Count: 154)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9310 (Count: 138)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9582 (Count: 150)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8824 (Count: 247)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9285 (Count: 160)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9444 (Count: 206)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9426 (Count: 135)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9405 (Count: 131)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7103 (Count: 122)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9612 (Count: 178)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7020 (Count: 151)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9644 (Count: 150)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7685 (Count: 157)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7412 (Count: 161)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9427 (Count: 180)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9490 (Count: 158)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9779 (Count: 788)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9279 (Count: 349)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8761 (Count: 150)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8899 (Count: 155)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8686 (Count: 218)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8923 (Count: 162)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8475 (Count: 132)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8039 (Count: 137)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8736 (Count: 137)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9178 (Count: 783)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9757 (Count: 287)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9489 (Count: 170)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8948 (Count: 133)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9097 (Count: 324)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7317 (Count: 106)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8034 (Count: 277)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8072 (Count: 140)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8282 (Count: 274)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7916 (Count: 228)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7655 (Count: 207)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9455 (Count: 781)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8442 (Count: 156)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8849 (Count: 246)
2025-04-15 14:31:24 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 37)
2025-04-15 14:31:25 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 37)
2025-04-15 14:31:25 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 37: Captured validation outputs and targets for visualization.
2025-04-15 14:31:25 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 37: Captured validation outputs and targets for visualization.
2025-04-15 14:33:16 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:33:16 | INFO     | core.training.train - Epoch 38 [Fine-tuning] Train: Loss=10.0389, Acc=0.7948, Prec=0.7936, Rec=0.7948, F1=0.7939 (111.44s)
2025-04-15 14:33:24 | INFO     | core.training.train - Epoch 38 [Fine-tuning] Val:   Loss=2.0572, Acc=0.9686, Prec=0.9692, Rec=0.9686, F1=0.9684 (7.73s)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 38.
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 38) ---
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9686
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8833 | Median: 0.9473 | Min: 0.1697
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    12.41% (1144/9222)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0853
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8451 (Count: 155)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9256 (Count: 138)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9565 (Count: 150)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8812 (Count: 246)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9332 (Count: 160)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9481 (Count: 206)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9379 (Count: 135)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9414 (Count: 131)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7012 (Count: 119)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9637 (Count: 178)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7134 (Count: 151)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9641 (Count: 150)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7320 (Count: 154)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7654 (Count: 171)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9336 (Count: 181)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9468 (Count: 158)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9723 (Count: 788)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9390 (Count: 350)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8829 (Count: 152)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8964 (Count: 156)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8778 (Count: 218)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9073 (Count: 162)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8528 (Count: 132)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8317 (Count: 139)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8857 (Count: 136)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9226 (Count: 781)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9774 (Count: 287)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9575 (Count: 170)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8848 (Count: 132)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9066 (Count: 323)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7231 (Count: 104)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8035 (Count: 275)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8098 (Count: 142)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8398 (Count: 276)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7955 (Count: 235)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7619 (Count: 203)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9424 (Count: 781)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8609 (Count: 159)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8910 (Count: 248)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 38.
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 38) ---
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9686
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8833 | Median: 0.9473 | Min: 0.1697
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    12.41% (1144/9222)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0853
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8451 (Count: 155)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9256 (Count: 138)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9565 (Count: 150)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8812 (Count: 246)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9332 (Count: 160)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9481 (Count: 206)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9379 (Count: 135)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9414 (Count: 131)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7012 (Count: 119)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9637 (Count: 178)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7134 (Count: 151)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9641 (Count: 150)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7320 (Count: 154)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7654 (Count: 171)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9336 (Count: 181)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9468 (Count: 158)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9723 (Count: 788)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9390 (Count: 350)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8829 (Count: 152)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8964 (Count: 156)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8778 (Count: 218)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9073 (Count: 162)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8528 (Count: 132)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8317 (Count: 139)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8857 (Count: 136)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9226 (Count: 781)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9774 (Count: 287)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9575 (Count: 170)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8848 (Count: 132)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9066 (Count: 323)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7231 (Count: 104)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8035 (Count: 275)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8098 (Count: 142)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8398 (Count: 276)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7955 (Count: 235)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7619 (Count: 203)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9424 (Count: 781)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8609 (Count: 159)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8910 (Count: 248)
2025-04-15 14:33:25 | INFO     | core.training.callbacks.model_checkpoint - Epoch 38: val_loss improved from 2.082085 to 2.057169.
2025-04-15 14:33:25 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 38)
2025-04-15 14:33:26 | INFO     | core.training.callbacks.model_checkpoint - Epoch 38: val_loss improved from 2.082085 to 2.057169.
2025-04-15 14:33:26 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 38)
2025-04-15 14:33:27 | INFO     | core.training.callbacks.early_stopping - Epoch 38: EarlyStopping val_loss improved from 2.082085 to 2.057169
2025-04-15 14:33:27 | INFO     | core.training.callbacks.early_stopping - Epoch 38: EarlyStopping val_loss improved from 2.082085 to 2.057169
2025-04-15 14:33:27 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 38: Captured validation outputs and targets for visualization.
2025-04-15 14:33:27 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 38: Captured validation outputs and targets for visualization.
2025-04-15 14:35:18 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:35:18 | INFO     | core.training.train - Epoch 39 [Fine-tuning] Train: Loss=9.9839, Acc=0.7970, Prec=0.7958, Rec=0.7970, F1=0.7961 (111.19s)
2025-04-15 14:35:26 | INFO     | core.training.train - Epoch 39 [Fine-tuning] Val:   Loss=2.0923, Acc=0.9669, Prec=0.9677, Rec=0.9669, F1=0.9667 (7.78s)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 39.
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 39) ---
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9669
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8826 | Median: 0.9465 | Min: 0.1845
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    12.60% (1162/9222)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0844
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8253 (Count: 148)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9339 (Count: 137)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9566 (Count: 150)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8841 (Count: 246)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9383 (Count: 160)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9460 (Count: 206)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9479 (Count: 135)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9435 (Count: 132)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7064 (Count: 118)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9611 (Count: 178)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7127 (Count: 150)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9769 (Count: 150)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7393 (Count: 155)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7618 (Count: 170)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9147 (Count: 180)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9471 (Count: 158)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9753 (Count: 787)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9357 (Count: 350)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8877 (Count: 153)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8966 (Count: 154)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8830 (Count: 222)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8947 (Count: 161)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8560 (Count: 133)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8336 (Count: 138)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8642 (Count: 136)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9224 (Count: 781)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9727 (Count: 288)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9595 (Count: 170)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9030 (Count: 133)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8996 (Count: 324)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7186 (Count: 105)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8047 (Count: 270)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8075 (Count: 142)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8339 (Count: 273)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8081 (Count: 235)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7639 (Count: 205)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9439 (Count: 782)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8546 (Count: 158)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8810 (Count: 244)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 39.
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 39) ---
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9669
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8826 | Median: 0.9465 | Min: 0.1845
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    12.60% (1162/9222)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0844
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8253 (Count: 148)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9339 (Count: 137)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9566 (Count: 150)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8841 (Count: 246)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9383 (Count: 160)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9460 (Count: 206)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9479 (Count: 135)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9435 (Count: 132)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7064 (Count: 118)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9611 (Count: 178)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7127 (Count: 150)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9769 (Count: 150)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7393 (Count: 155)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7618 (Count: 170)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9147 (Count: 180)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9471 (Count: 158)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9753 (Count: 787)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9357 (Count: 350)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8877 (Count: 153)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8966 (Count: 154)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8830 (Count: 222)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8947 (Count: 161)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8560 (Count: 133)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8336 (Count: 138)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8642 (Count: 136)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9224 (Count: 781)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9727 (Count: 288)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9595 (Count: 170)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9030 (Count: 133)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8996 (Count: 324)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7186 (Count: 105)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8047 (Count: 270)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8075 (Count: 142)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8339 (Count: 273)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8081 (Count: 235)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7639 (Count: 205)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9439 (Count: 782)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8546 (Count: 158)
2025-04-15 14:35:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8810 (Count: 244)
2025-04-15 14:35:27 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 39)
2025-04-15 14:35:27 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 39)
2025-04-15 14:35:27 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 39: Captured validation outputs and targets for visualization.
2025-04-15 14:35:27 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 39: Captured validation outputs and targets for visualization.
2025-04-15 14:37:19 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:37:19 | INFO     | core.training.train - Epoch 40 [Fine-tuning] Train: Loss=9.7697, Acc=0.7996, Prec=0.7982, Rec=0.7996, F1=0.7986 (111.71s)
2025-04-15 14:37:27 | INFO     | core.training.train - Epoch 40 [Fine-tuning] Val:   Loss=2.0726, Acc=0.9666, Prec=0.9675, Rec=0.9666, F1=0.9665 (7.74s)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 40): Current confidence=0.8826, Change=-0.0008
2025-04-15 14:37:27 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 40): Current confidence=0.8826, Change=-0.0008
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 40.
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 40) ---
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9666
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8845 | Median: 0.9470 | Min: 0.1749
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    12.05% (1111/9222)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0822
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8662 (Count: 154)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9332 (Count: 138)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9616 (Count: 151)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8681 (Count: 246)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9418 (Count: 160)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9345 (Count: 205)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9512 (Count: 135)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9157 (Count: 131)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7147 (Count: 122)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9530 (Count: 177)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7048 (Count: 151)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9643 (Count: 149)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7654 (Count: 157)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7592 (Count: 165)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9272 (Count: 181)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9517 (Count: 158)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9749 (Count: 787)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9337 (Count: 349)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8905 (Count: 151)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9049 (Count: 156)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8796 (Count: 218)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8992 (Count: 162)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8609 (Count: 131)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8386 (Count: 140)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8800 (Count: 136)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9215 (Count: 779)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9770 (Count: 288)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9515 (Count: 170)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8971 (Count: 133)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9134 (Count: 325)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7578 (Count: 106)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8190 (Count: 274)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8139 (Count: 141)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8394 (Count: 274)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7928 (Count: 224)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7770 (Count: 208)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9474 (Count: 780)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8544 (Count: 158)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8807 (Count: 244)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 40.
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 40) ---
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9666
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8845 | Median: 0.9470 | Min: 0.1749
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    12.05% (1111/9222)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0822
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8662 (Count: 154)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9332 (Count: 138)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9616 (Count: 151)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8681 (Count: 246)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9418 (Count: 160)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9345 (Count: 205)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9512 (Count: 135)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9157 (Count: 131)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7147 (Count: 122)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9530 (Count: 177)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7048 (Count: 151)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9643 (Count: 149)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7654 (Count: 157)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7592 (Count: 165)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9272 (Count: 181)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9517 (Count: 158)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9749 (Count: 787)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9337 (Count: 349)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8905 (Count: 151)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9049 (Count: 156)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8796 (Count: 218)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8992 (Count: 162)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8609 (Count: 131)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8386 (Count: 140)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8800 (Count: 136)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9215 (Count: 779)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9770 (Count: 288)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9515 (Count: 170)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8971 (Count: 133)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9134 (Count: 325)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7578 (Count: 106)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8190 (Count: 274)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8139 (Count: 141)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8394 (Count: 274)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7928 (Count: 224)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7770 (Count: 208)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9474 (Count: 780)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8544 (Count: 158)
2025-04-15 14:37:27 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8807 (Count: 244)
2025-04-15 14:37:28 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 40)
2025-04-15 14:37:28 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 40)
2025-04-15 14:37:28 | INFO     | core.training.callbacks.gradcam_callback - Generating GradCAM visualizations at epoch 40
2025-04-15 14:37:28 | INFO     | core.models.model_cbam18 - Using layer4[-1].conv2 as GradCAM target layer
2025-04-15 14:37:28 | INFO     | core.evaluation.interpretability - Using model's recommended GradCAM target layer
2025-04-15 14:37:28 | INFO     | core.evaluation.interpretability - GradCAM initialized with target layer: Conv2d
2025-04-15 14:37:28 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:29 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:29 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:29 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:30 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:30 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:31 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:31 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:32 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:32 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:32 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:33 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:33 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:34 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:34 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:35 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:37 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:37 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:38 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:38 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:40 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:41 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:41 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:42 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:44 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:44 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:45 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:45 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:37:46 | INFO     | core.training.callbacks.gradcam_callback - Generated summary HTML: outputs/cbam_only_resnet18_v2/gradcam/epoch_040/gradcam_summary.html
2025-04-15 14:37:46 | INFO     | core.training.callbacks.gradcam_callback - GradCAM visualizations saved to outputs/cbam_only_resnet18_v2/gradcam/epoch_040
2025-04-15 14:37:46 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 40: Captured validation outputs and targets for visualization.
2025-04-15 14:37:46 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 40: Captured validation outputs and targets for visualization.
2025-04-15 14:39:40 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:39:40 | INFO     | core.training.train - Epoch 41 [Fine-tuning] Train: Loss=9.8696, Acc=0.7971, Prec=0.7962, Rec=0.7971, F1=0.7964 (114.09s)
2025-04-15 14:39:48 | INFO     | core.training.train - Epoch 41 [Fine-tuning] Val:   Loss=2.0392, Acc=0.9678, Prec=0.9686, Rec=0.9678, F1=0.9677 (8.44s)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 41.
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 41) ---
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9678
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8869 | Median: 0.9492 | Min: 0.1708
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.70% (1079/9222)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0811
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8533 (Count: 153)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9363 (Count: 138)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9650 (Count: 150)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8793 (Count: 246)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9415 (Count: 160)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9357 (Count: 205)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9520 (Count: 135)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9288 (Count: 131)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6979 (Count: 121)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9684 (Count: 178)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7194 (Count: 150)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9673 (Count: 150)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7825 (Count: 160)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7463 (Count: 162)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9449 (Count: 180)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9548 (Count: 159)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9690 (Count: 787)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9344 (Count: 350)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8905 (Count: 151)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8997 (Count: 155)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8883 (Count: 222)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9002 (Count: 162)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8649 (Count: 132)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8405 (Count: 139)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8861 (Count: 136)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9259 (Count: 780)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9764 (Count: 288)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9540 (Count: 170)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9001 (Count: 133)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9157 (Count: 324)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7443 (Count: 104)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8188 (Count: 273)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8310 (Count: 141)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8392 (Count: 276)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7975 (Count: 232)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7701 (Count: 209)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9460 (Count: 779)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8547 (Count: 158)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8944 (Count: 246)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 41.
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 41) ---
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9678
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8869 | Median: 0.9492 | Min: 0.1708
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.70% (1079/9222)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0811
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8533 (Count: 153)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9363 (Count: 138)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9650 (Count: 150)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8793 (Count: 246)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9415 (Count: 160)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9357 (Count: 205)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9520 (Count: 135)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9288 (Count: 131)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6979 (Count: 121)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9684 (Count: 178)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7194 (Count: 150)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9673 (Count: 150)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7825 (Count: 160)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7463 (Count: 162)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9449 (Count: 180)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9548 (Count: 159)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9690 (Count: 787)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9344 (Count: 350)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8905 (Count: 151)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8997 (Count: 155)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8883 (Count: 222)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9002 (Count: 162)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8649 (Count: 132)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8405 (Count: 139)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8861 (Count: 136)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9259 (Count: 780)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9764 (Count: 288)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9540 (Count: 170)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9001 (Count: 133)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9157 (Count: 324)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7443 (Count: 104)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8188 (Count: 273)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8310 (Count: 141)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8392 (Count: 276)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7975 (Count: 232)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7701 (Count: 209)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9460 (Count: 779)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8547 (Count: 158)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8944 (Count: 246)
2025-04-15 14:39:49 | INFO     | core.training.callbacks.model_checkpoint - Epoch 41: val_loss improved from 2.057169 to 2.039170.
2025-04-15 14:39:49 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 41)
2025-04-15 14:39:50 | INFO     | core.training.callbacks.model_checkpoint - Epoch 41: val_loss improved from 2.057169 to 2.039170.
2025-04-15 14:39:50 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 41)
2025-04-15 14:39:50 | INFO     | core.training.callbacks.early_stopping - Epoch 41: EarlyStopping val_loss improved from 2.057169 to 2.039170
2025-04-15 14:39:50 | INFO     | core.training.callbacks.early_stopping - Epoch 41: EarlyStopping val_loss improved from 2.057169 to 2.039170
2025-04-15 14:39:50 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 41: Captured validation outputs and targets for visualization.
2025-04-15 14:39:50 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 41: Captured validation outputs and targets for visualization.
2025-04-15 14:41:42 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:41:42 | INFO     | core.training.train - Epoch 42 [Fine-tuning] Train: Loss=9.7515, Acc=0.8000, Prec=0.7990, Rec=0.8000, F1=0.7992 (111.64s)
2025-04-15 14:41:50 | INFO     | core.training.train - Epoch 42 [Fine-tuning] Val:   Loss=2.0419, Acc=0.9680, Prec=0.9689, Rec=0.9680, F1=0.9679 (7.73s)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 42.
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 42) ---
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9680
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8875 | Median: 0.9497 | Min: 0.1891
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.73% (1082/9222)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0806
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8636 (Count: 154)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9347 (Count: 138)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9659 (Count: 150)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8786 (Count: 246)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9428 (Count: 160)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9457 (Count: 206)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9574 (Count: 135)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9351 (Count: 131)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6968 (Count: 118)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9686 (Count: 178)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7232 (Count: 150)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9685 (Count: 150)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7540 (Count: 154)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7775 (Count: 168)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9419 (Count: 180)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9498 (Count: 159)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9736 (Count: 789)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9287 (Count: 349)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8941 (Count: 153)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9078 (Count: 154)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8881 (Count: 222)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9059 (Count: 162)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8763 (Count: 134)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8307 (Count: 139)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8868 (Count: 138)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9156 (Count: 779)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9781 (Count: 288)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9594 (Count: 170)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9046 (Count: 134)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9185 (Count: 324)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7395 (Count: 106)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8136 (Count: 278)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8165 (Count: 141)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8319 (Count: 274)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7981 (Count: 232)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7712 (Count: 206)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9529 (Count: 779)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8633 (Count: 158)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8870 (Count: 241)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 42.
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 42) ---
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9680
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8875 | Median: 0.9497 | Min: 0.1891
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.73% (1082/9222)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0806
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8636 (Count: 154)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9347 (Count: 138)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9659 (Count: 150)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8786 (Count: 246)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9428 (Count: 160)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9457 (Count: 206)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9574 (Count: 135)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9351 (Count: 131)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6968 (Count: 118)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9686 (Count: 178)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7232 (Count: 150)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9685 (Count: 150)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7540 (Count: 154)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7775 (Count: 168)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9419 (Count: 180)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9498 (Count: 159)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9736 (Count: 789)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9287 (Count: 349)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8941 (Count: 153)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9078 (Count: 154)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8881 (Count: 222)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9059 (Count: 162)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8763 (Count: 134)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8307 (Count: 139)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8868 (Count: 138)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9156 (Count: 779)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9781 (Count: 288)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9594 (Count: 170)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9046 (Count: 134)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9185 (Count: 324)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7395 (Count: 106)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8136 (Count: 278)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8165 (Count: 141)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8319 (Count: 274)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7981 (Count: 232)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7712 (Count: 206)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9529 (Count: 779)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8633 (Count: 158)
2025-04-15 14:41:50 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8870 (Count: 241)
2025-04-15 14:41:51 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 42)
2025-04-15 14:41:51 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 42)
2025-04-15 14:41:51 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 42: Captured validation outputs and targets for visualization.
2025-04-15 14:41:51 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 42: Captured validation outputs and targets for visualization.
2025-04-15 14:43:43 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:43:43 | INFO     | core.training.train - Epoch 43 [Fine-tuning] Train: Loss=9.6811, Acc=0.8041, Prec=0.8028, Rec=0.8041, F1=0.8032 (112.03s)
2025-04-15 14:43:51 | INFO     | core.training.train - Epoch 43 [Fine-tuning] Val:   Loss=2.0422, Acc=0.9678, Prec=0.9688, Rec=0.9678, F1=0.9677 (7.91s)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 43.
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 43) ---
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9678
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8876 | Median: 0.9496 | Min: 0.1760
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.66% (1075/9222)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0803
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8557 (Count: 154)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9332 (Count: 138)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9689 (Count: 150)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8782 (Count: 247)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9319 (Count: 159)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9375 (Count: 205)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9464 (Count: 135)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9374 (Count: 131)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7081 (Count: 121)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9676 (Count: 178)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7128 (Count: 150)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9690 (Count: 150)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7893 (Count: 160)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7531 (Count: 161)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9358 (Count: 180)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9535 (Count: 159)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9745 (Count: 788)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9409 (Count: 350)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8762 (Count: 149)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9022 (Count: 156)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8837 (Count: 221)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9015 (Count: 162)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8743 (Count: 133)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8258 (Count: 139)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8883 (Count: 137)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9281 (Count: 781)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9809 (Count: 287)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9559 (Count: 171)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8978 (Count: 132)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9148 (Count: 324)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7319 (Count: 106)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8200 (Count: 278)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8272 (Count: 141)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8317 (Count: 275)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8031 (Count: 229)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7793 (Count: 208)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9495 (Count: 780)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8553 (Count: 158)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8791 (Count: 242)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 43.
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 43) ---
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9678
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8876 | Median: 0.9496 | Min: 0.1760
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.66% (1075/9222)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0803
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8557 (Count: 154)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9332 (Count: 138)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9689 (Count: 150)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8782 (Count: 247)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9319 (Count: 159)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9375 (Count: 205)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9464 (Count: 135)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9374 (Count: 131)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7081 (Count: 121)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9676 (Count: 178)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7128 (Count: 150)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9690 (Count: 150)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7893 (Count: 160)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7531 (Count: 161)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9358 (Count: 180)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9535 (Count: 159)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9745 (Count: 788)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9409 (Count: 350)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8762 (Count: 149)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9022 (Count: 156)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8837 (Count: 221)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9015 (Count: 162)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8743 (Count: 133)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8258 (Count: 139)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8883 (Count: 137)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9281 (Count: 781)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9809 (Count: 287)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9559 (Count: 171)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8978 (Count: 132)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9148 (Count: 324)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7319 (Count: 106)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8200 (Count: 278)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8272 (Count: 141)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8317 (Count: 275)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8031 (Count: 229)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7793 (Count: 208)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9495 (Count: 780)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8553 (Count: 158)
2025-04-15 14:43:51 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8791 (Count: 242)
2025-04-15 14:43:52 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 43)
2025-04-15 14:43:52 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 43)
2025-04-15 14:43:52 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 43: Captured validation outputs and targets for visualization.
2025-04-15 14:43:52 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 43: Captured validation outputs and targets for visualization.
2025-04-15 14:45:45 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:45:45 | INFO     | core.training.train - Epoch 44 [Fine-tuning] Train: Loss=9.6309, Acc=0.8043, Prec=0.8034, Rec=0.8043, F1=0.8036 (112.70s)
2025-04-15 14:45:53 | INFO     | core.training.train - Epoch 44 [Fine-tuning] Val:   Loss=2.0492, Acc=0.9693, Prec=0.9701, Rec=0.9693, F1=0.9692 (7.77s)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 44.
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 44) ---
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9693
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8871 | Median: 0.9493 | Min: 0.1889
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.87% (1095/9222)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0823
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8518 (Count: 156)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9348 (Count: 138)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9658 (Count: 150)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8783 (Count: 246)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9364 (Count: 160)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9466 (Count: 206)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9510 (Count: 135)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9492 (Count: 132)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7125 (Count: 122)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9601 (Count: 178)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7114 (Count: 150)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9655 (Count: 150)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7626 (Count: 159)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7570 (Count: 168)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9331 (Count: 181)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9481 (Count: 159)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9798 (Count: 788)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9368 (Count: 350)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8623 (Count: 149)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9082 (Count: 155)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8804 (Count: 222)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9055 (Count: 161)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8691 (Count: 132)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8084 (Count: 138)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8844 (Count: 138)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9180 (Count: 784)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9771 (Count: 288)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9630 (Count: 171)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9079 (Count: 134)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9160 (Count: 324)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7290 (Count: 105)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8163 (Count: 275)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8436 (Count: 144)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8432 (Count: 275)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7870 (Count: 234)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7819 (Count: 206)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9518 (Count: 780)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8512 (Count: 158)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8779 (Count: 238)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 44.
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 44) ---
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9693
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8871 | Median: 0.9493 | Min: 0.1889
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.87% (1095/9222)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0823
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8518 (Count: 156)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9348 (Count: 138)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9658 (Count: 150)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8783 (Count: 246)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9364 (Count: 160)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9466 (Count: 206)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9510 (Count: 135)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9492 (Count: 132)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7125 (Count: 122)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9601 (Count: 178)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7114 (Count: 150)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9655 (Count: 150)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7626 (Count: 159)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7570 (Count: 168)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9331 (Count: 181)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9481 (Count: 159)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9798 (Count: 788)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9368 (Count: 350)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8623 (Count: 149)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9082 (Count: 155)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8804 (Count: 222)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9055 (Count: 161)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8691 (Count: 132)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8084 (Count: 138)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8844 (Count: 138)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9180 (Count: 784)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9771 (Count: 288)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9630 (Count: 171)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9079 (Count: 134)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9160 (Count: 324)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7290 (Count: 105)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8163 (Count: 275)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8436 (Count: 144)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8432 (Count: 275)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7870 (Count: 234)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7819 (Count: 206)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9518 (Count: 780)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8512 (Count: 158)
2025-04-15 14:45:53 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8779 (Count: 238)
2025-04-15 14:45:54 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 44)
2025-04-15 14:45:54 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 44)
2025-04-15 14:45:54 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 44: Captured validation outputs and targets for visualization.
2025-04-15 14:45:54 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 44: Captured validation outputs and targets for visualization.
2025-04-15 14:47:46 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:47:46 | INFO     | core.training.train - Epoch 45 [Fine-tuning] Train: Loss=9.4208, Acc=0.8053, Prec=0.8042, Rec=0.8053, F1=0.8045 (111.25s)
2025-04-15 14:47:54 | INFO     | core.training.train - Epoch 45 [Fine-tuning] Val:   Loss=2.0216, Acc=0.9695, Prec=0.9703, Rec=0.9695, F1=0.9694 (7.92s)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 45): Current confidence=0.8871, Change=-0.0004
2025-04-15 14:47:54 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 45): Current confidence=0.8871, Change=-0.0004
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 45.
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 45) ---
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9695
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8874 | Median: 0.9503 | Min: 0.2222
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.85% (1093/9222)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0822
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8577 (Count: 154)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9462 (Count: 138)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9608 (Count: 150)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8776 (Count: 246)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9454 (Count: 160)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9417 (Count: 205)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9543 (Count: 135)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9440 (Count: 132)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7069 (Count: 121)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9646 (Count: 178)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7132 (Count: 150)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9730 (Count: 150)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7571 (Count: 156)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7750 (Count: 168)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9396 (Count: 180)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9574 (Count: 159)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9729 (Count: 787)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9363 (Count: 350)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8983 (Count: 153)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8954 (Count: 157)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8738 (Count: 220)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9028 (Count: 161)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8569 (Count: 132)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8337 (Count: 138)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8777 (Count: 138)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9281 (Count: 784)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9761 (Count: 288)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9590 (Count: 170)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9068 (Count: 134)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9053 (Count: 324)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7261 (Count: 108)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8124 (Count: 278)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8259 (Count: 141)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8462 (Count: 277)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7892 (Count: 226)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7674 (Count: 208)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9428 (Count: 779)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8766 (Count: 160)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8916 (Count: 246)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 45.
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 45) ---
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9695
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8874 | Median: 0.9503 | Min: 0.2222
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.85% (1093/9222)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0822
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8577 (Count: 154)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9462 (Count: 138)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9608 (Count: 150)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8776 (Count: 246)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9454 (Count: 160)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9417 (Count: 205)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9543 (Count: 135)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9440 (Count: 132)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7069 (Count: 121)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9646 (Count: 178)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7132 (Count: 150)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9730 (Count: 150)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7571 (Count: 156)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7750 (Count: 168)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9396 (Count: 180)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9574 (Count: 159)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9729 (Count: 787)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9363 (Count: 350)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8983 (Count: 153)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8954 (Count: 157)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8738 (Count: 220)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9028 (Count: 161)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8569 (Count: 132)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8337 (Count: 138)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8777 (Count: 138)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9281 (Count: 784)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9761 (Count: 288)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9590 (Count: 170)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9068 (Count: 134)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9053 (Count: 324)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7261 (Count: 108)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8124 (Count: 278)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8259 (Count: 141)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8462 (Count: 277)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7892 (Count: 226)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7674 (Count: 208)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9428 (Count: 779)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8766 (Count: 160)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8916 (Count: 246)
2025-04-15 14:47:54 | INFO     | core.training.callbacks.model_checkpoint - Epoch 45: val_loss improved from 2.039170 to 2.021644.
2025-04-15 14:47:55 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 45)
2025-04-15 14:47:55 | INFO     | core.training.callbacks.model_checkpoint - Epoch 45: val_loss improved from 2.039170 to 2.021644.
2025-04-15 14:47:55 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 45)
2025-04-15 14:47:55 | INFO     | core.training.callbacks.early_stopping - Epoch 45: EarlyStopping val_loss improved from 2.039170 to 2.021644
2025-04-15 14:47:55 | INFO     | core.training.callbacks.early_stopping - Epoch 45: EarlyStopping val_loss improved from 2.039170 to 2.021644
2025-04-15 14:47:55 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 45: Captured validation outputs and targets for visualization.
2025-04-15 14:47:55 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 45: Captured validation outputs and targets for visualization.
2025-04-15 14:49:49 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:49:49 | INFO     | core.training.train - Epoch 46 [Fine-tuning] Train: Loss=9.4212, Acc=0.8086, Prec=0.8078, Rec=0.8086, F1=0.8080 (113.11s)
2025-04-15 14:49:57 | INFO     | core.training.train - Epoch 46 [Fine-tuning] Val:   Loss=2.0135, Acc=0.9701, Prec=0.9708, Rec=0.9701, F1=0.9700 (7.90s)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 46.
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 46) ---
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9701
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8892 | Median: 0.9509 | Min: 0.1755
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.46% (1057/9222)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0810
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8772 (Count: 158)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9377 (Count: 138)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9653 (Count: 150)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8759 (Count: 246)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9377 (Count: 160)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9464 (Count: 206)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9581 (Count: 136)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9385 (Count: 132)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7040 (Count: 122)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9671 (Count: 178)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7157 (Count: 151)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9690 (Count: 150)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7732 (Count: 158)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7650 (Count: 168)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9419 (Count: 180)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9573 (Count: 159)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9746 (Count: 788)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9383 (Count: 350)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8747 (Count: 151)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9102 (Count: 156)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8783 (Count: 220)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9101 (Count: 161)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8728 (Count: 133)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8390 (Count: 140)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9049 (Count: 138)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9150 (Count: 780)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9719 (Count: 288)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9629 (Count: 171)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8957 (Count: 133)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9147 (Count: 323)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7390 (Count: 108)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8129 (Count: 275)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8469 (Count: 143)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8412 (Count: 276)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8065 (Count: 235)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7740 (Count: 203)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9509 (Count: 781)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8747 (Count: 158)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8824 (Count: 243)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 46.
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 46) ---
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9701
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8892 | Median: 0.9509 | Min: 0.1755
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.46% (1057/9222)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0810
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8772 (Count: 158)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9377 (Count: 138)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9653 (Count: 150)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8759 (Count: 246)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9377 (Count: 160)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9464 (Count: 206)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9581 (Count: 136)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9385 (Count: 132)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7040 (Count: 122)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9671 (Count: 178)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7157 (Count: 151)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9690 (Count: 150)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7732 (Count: 158)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7650 (Count: 168)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9419 (Count: 180)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9573 (Count: 159)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9746 (Count: 788)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9383 (Count: 350)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8747 (Count: 151)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9102 (Count: 156)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8783 (Count: 220)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9101 (Count: 161)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8728 (Count: 133)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8390 (Count: 140)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9049 (Count: 138)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9150 (Count: 780)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9719 (Count: 288)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9629 (Count: 171)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8957 (Count: 133)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9147 (Count: 323)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7390 (Count: 108)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8129 (Count: 275)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8469 (Count: 143)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8412 (Count: 276)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8065 (Count: 235)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7740 (Count: 203)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9509 (Count: 781)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8747 (Count: 158)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8824 (Count: 243)
2025-04-15 14:49:57 | INFO     | core.training.callbacks.model_checkpoint - Epoch 46: val_loss improved from 2.021644 to 2.013540.
2025-04-15 14:49:58 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 46)
2025-04-15 14:49:58 | INFO     | core.training.callbacks.model_checkpoint - Epoch 46: val_loss improved from 2.021644 to 2.013540.
2025-04-15 14:49:58 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 46)
2025-04-15 14:49:59 | INFO     | core.training.callbacks.early_stopping - Epoch 46: EarlyStopping val_loss improved from 2.021644 to 2.013540
2025-04-15 14:49:59 | INFO     | core.training.callbacks.early_stopping - Epoch 46: EarlyStopping val_loss improved from 2.021644 to 2.013540
2025-04-15 14:49:59 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 46: Captured validation outputs and targets for visualization.
2025-04-15 14:49:59 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 46: Captured validation outputs and targets for visualization.
2025-04-15 14:51:53 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:51:53 | INFO     | core.training.train - Epoch 47 [Fine-tuning] Train: Loss=9.3189, Acc=0.8087, Prec=0.8078, Rec=0.8087, F1=0.8081 (114.39s)
2025-04-15 14:52:01 | INFO     | core.training.train - Epoch 47 [Fine-tuning] Val:   Loss=1.9946, Acc=0.9708, Prec=0.9714, Rec=0.9708, F1=0.9707 (7.87s)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 47.
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 47) ---
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9708
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8880 | Median: 0.9501 | Min: 0.1701
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.72% (1081/9222)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0829
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8642 (Count: 157)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9356 (Count: 138)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9635 (Count: 151)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8847 (Count: 246)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9444 (Count: 160)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9445 (Count: 206)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9565 (Count: 135)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9348 (Count: 132)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7124 (Count: 123)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9618 (Count: 178)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7131 (Count: 150)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9641 (Count: 150)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7589 (Count: 158)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7742 (Count: 168)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9534 (Count: 180)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9530 (Count: 158)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9776 (Count: 789)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9373 (Count: 351)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8856 (Count: 151)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9006 (Count: 156)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8779 (Count: 220)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9215 (Count: 162)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8756 (Count: 133)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8119 (Count: 138)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8976 (Count: 138)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9238 (Count: 782)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9739 (Count: 288)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9584 (Count: 170)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8994 (Count: 133)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9029 (Count: 323)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7282 (Count: 110)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8257 (Count: 279)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8400 (Count: 143)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8317 (Count: 276)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7972 (Count: 236)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7502 (Count: 202)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9464 (Count: 782)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8605 (Count: 158)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8803 (Count: 243)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 47.
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 47) ---
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9708
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8880 | Median: 0.9501 | Min: 0.1701
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.72% (1081/9222)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0829
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8642 (Count: 157)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9356 (Count: 138)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9635 (Count: 151)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8847 (Count: 246)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9444 (Count: 160)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9445 (Count: 206)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9565 (Count: 135)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9348 (Count: 132)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7124 (Count: 123)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9618 (Count: 178)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7131 (Count: 150)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9641 (Count: 150)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7589 (Count: 158)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7742 (Count: 168)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9534 (Count: 180)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9530 (Count: 158)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9776 (Count: 789)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9373 (Count: 351)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8856 (Count: 151)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9006 (Count: 156)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8779 (Count: 220)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9215 (Count: 162)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8756 (Count: 133)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8119 (Count: 138)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8976 (Count: 138)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9238 (Count: 782)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9739 (Count: 288)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9584 (Count: 170)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8994 (Count: 133)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9029 (Count: 323)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7282 (Count: 110)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8257 (Count: 279)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8400 (Count: 143)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8317 (Count: 276)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7972 (Count: 236)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7502 (Count: 202)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9464 (Count: 782)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8605 (Count: 158)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8803 (Count: 243)
2025-04-15 14:52:02 | INFO     | core.training.callbacks.model_checkpoint - Epoch 47: val_loss improved from 2.013540 to 1.994576.
2025-04-15 14:52:02 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 47)
2025-04-15 14:52:03 | INFO     | core.training.callbacks.model_checkpoint - Epoch 47: val_loss improved from 2.013540 to 1.994576.
2025-04-15 14:52:03 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 47)
2025-04-15 14:52:04 | INFO     | core.training.callbacks.early_stopping - Epoch 47: EarlyStopping val_loss improved from 2.013540 to 1.994576
2025-04-15 14:52:04 | INFO     | core.training.callbacks.early_stopping - Epoch 47: EarlyStopping val_loss improved from 2.013540 to 1.994576
2025-04-15 14:52:04 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 47: Captured validation outputs and targets for visualization.
2025-04-15 14:52:04 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 47: Captured validation outputs and targets for visualization.
2025-04-15 14:53:59 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:53:59 | INFO     | core.training.train - Epoch 48 [Fine-tuning] Train: Loss=9.2965, Acc=0.8097, Prec=0.8087, Rec=0.8097, F1=0.8089 (115.29s)
2025-04-15 14:54:07 | INFO     | core.training.train - Epoch 48 [Fine-tuning] Val:   Loss=1.9886, Acc=0.9712, Prec=0.9718, Rec=0.9712, F1=0.9710 (7.92s)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 48.
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 48) ---
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9712
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8902 | Median: 0.9510 | Min: 0.1787
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.20% (1033/9222)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0812
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8735 (Count: 156)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9403 (Count: 138)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9682 (Count: 150)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8839 (Count: 246)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9405 (Count: 160)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9451 (Count: 206)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9613 (Count: 135)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9437 (Count: 132)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7091 (Count: 122)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9632 (Count: 178)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7223 (Count: 151)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9675 (Count: 149)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7872 (Count: 159)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7683 (Count: 165)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9458 (Count: 180)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9543 (Count: 159)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9752 (Count: 788)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9348 (Count: 351)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8921 (Count: 152)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8995 (Count: 157)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8848 (Count: 221)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9032 (Count: 161)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8769 (Count: 132)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8162 (Count: 138)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8936 (Count: 136)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9215 (Count: 784)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9772 (Count: 288)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9467 (Count: 170)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9002 (Count: 134)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9014 (Count: 323)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7527 (Count: 108)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8140 (Count: 278)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8304 (Count: 142)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8443 (Count: 277)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8039 (Count: 233)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7777 (Count: 209)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9510 (Count: 782)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8635 (Count: 159)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8893 (Count: 247)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 48.
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 48) ---
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9712
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8902 | Median: 0.9510 | Min: 0.1787
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.20% (1033/9222)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0812
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8735 (Count: 156)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9403 (Count: 138)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9682 (Count: 150)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8839 (Count: 246)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9405 (Count: 160)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9451 (Count: 206)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9613 (Count: 135)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9437 (Count: 132)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7091 (Count: 122)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9632 (Count: 178)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7223 (Count: 151)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9675 (Count: 149)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7872 (Count: 159)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7683 (Count: 165)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9458 (Count: 180)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9543 (Count: 159)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9752 (Count: 788)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9348 (Count: 351)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8921 (Count: 152)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8995 (Count: 157)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8848 (Count: 221)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9032 (Count: 161)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8769 (Count: 132)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8162 (Count: 138)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8936 (Count: 136)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9215 (Count: 784)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9772 (Count: 288)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9467 (Count: 170)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9002 (Count: 134)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9014 (Count: 323)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7527 (Count: 108)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8140 (Count: 278)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8304 (Count: 142)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8443 (Count: 277)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8039 (Count: 233)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7777 (Count: 209)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9510 (Count: 782)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8635 (Count: 159)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8893 (Count: 247)
2025-04-15 14:54:08 | INFO     | core.training.callbacks.model_checkpoint - Epoch 48: val_loss improved from 1.994576 to 1.988625.
2025-04-15 14:54:08 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 48)
2025-04-15 14:54:09 | INFO     | core.training.callbacks.model_checkpoint - Epoch 48: val_loss improved from 1.994576 to 1.988625.
2025-04-15 14:54:09 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 48)
2025-04-15 14:54:10 | INFO     | core.training.callbacks.early_stopping - Epoch 48: EarlyStopping val_loss improved from 1.994576 to 1.988625
2025-04-15 14:54:10 | INFO     | core.training.callbacks.early_stopping - Epoch 48: EarlyStopping val_loss improved from 1.994576 to 1.988625
2025-04-15 14:54:10 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 48: Captured validation outputs and targets for visualization.
2025-04-15 14:54:10 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 48: Captured validation outputs and targets for visualization.
2025-04-15 14:56:05 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:56:05 | INFO     | core.training.train - Epoch 49 [Fine-tuning] Train: Loss=9.2310, Acc=0.8102, Prec=0.8092, Rec=0.8102, F1=0.8095 (115.20s)
2025-04-15 14:56:13 | INFO     | core.training.train - Epoch 49 [Fine-tuning] Val:   Loss=1.9970, Acc=0.9705, Prec=0.9712, Rec=0.9705, F1=0.9704 (7.91s)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 49.
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 49) ---
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9705
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8907 | Median: 0.9516 | Min: 0.1797
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.27% (1039/9222)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0798
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8672 (Count: 158)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9452 (Count: 138)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9721 (Count: 150)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8873 (Count: 247)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9290 (Count: 160)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9450 (Count: 206)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9562 (Count: 135)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9488 (Count: 133)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7146 (Count: 122)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9545 (Count: 178)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7166 (Count: 151)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9651 (Count: 149)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7803 (Count: 159)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7661 (Count: 169)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9490 (Count: 180)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9593 (Count: 159)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9759 (Count: 789)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9334 (Count: 349)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8805 (Count: 152)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9114 (Count: 157)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8777 (Count: 218)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9087 (Count: 162)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8755 (Count: 133)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8173 (Count: 137)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9070 (Count: 137)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9233 (Count: 782)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9745 (Count: 287)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9554 (Count: 171)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8977 (Count: 134)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9246 (Count: 325)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7525 (Count: 108)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8242 (Count: 277)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8467 (Count: 142)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8291 (Count: 275)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8010 (Count: 231)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7839 (Count: 206)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9490 (Count: 780)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8610 (Count: 159)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8828 (Count: 245)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 49.
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 49) ---
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9705
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8907 | Median: 0.9516 | Min: 0.1797
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.27% (1039/9222)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0798
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8672 (Count: 158)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9452 (Count: 138)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9721 (Count: 150)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8873 (Count: 247)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9290 (Count: 160)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9450 (Count: 206)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9562 (Count: 135)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9488 (Count: 133)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7146 (Count: 122)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9545 (Count: 178)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7166 (Count: 151)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9651 (Count: 149)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7803 (Count: 159)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7661 (Count: 169)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9490 (Count: 180)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9593 (Count: 159)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9759 (Count: 789)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9334 (Count: 349)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8805 (Count: 152)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9114 (Count: 157)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8777 (Count: 218)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9087 (Count: 162)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8755 (Count: 133)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8173 (Count: 137)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9070 (Count: 137)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9233 (Count: 782)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9745 (Count: 287)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9554 (Count: 171)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8977 (Count: 134)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9246 (Count: 325)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7525 (Count: 108)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8242 (Count: 277)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8467 (Count: 142)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8291 (Count: 275)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8010 (Count: 231)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7839 (Count: 206)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9490 (Count: 780)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8610 (Count: 159)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8828 (Count: 245)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 49)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 49)
2025-04-15 14:56:14 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 49: Captured validation outputs and targets for visualization.
2025-04-15 14:56:14 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 49: Captured validation outputs and targets for visualization.
2025-04-15 14:58:10 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 14:58:10 | INFO     | core.training.train - Epoch 50 [Fine-tuning] Train: Loss=9.1385, Acc=0.8130, Prec=0.8121, Rec=0.8130, F1=0.8123 (115.18s)
2025-04-15 14:58:18 | INFO     | core.training.train - Epoch 50 [Fine-tuning] Val:   Loss=1.9697, Acc=0.9710, Prec=0.9717, Rec=0.9710, F1=0.9709 (8.38s)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 50): Current confidence=0.8907, Change=+0.0005
2025-04-15 14:58:19 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 50): Current confidence=0.8907, Change=+0.0005
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 50.
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 50) ---
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9710
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8916 | Median: 0.9520 | Min: 0.1552
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.04% (1018/9222)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0799
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8688 (Count: 156)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9427 (Count: 138)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9685 (Count: 150)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8821 (Count: 247)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9384 (Count: 160)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9431 (Count: 206)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9566 (Count: 135)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9402 (Count: 132)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7083 (Count: 125)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9625 (Count: 178)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7183 (Count: 150)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9639 (Count: 149)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7805 (Count: 159)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7720 (Count: 169)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9543 (Count: 180)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9552 (Count: 159)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9742 (Count: 788)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9343 (Count: 350)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8913 (Count: 153)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9136 (Count: 157)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8849 (Count: 219)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9160 (Count: 162)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8657 (Count: 132)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8299 (Count: 139)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9014 (Count: 137)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9229 (Count: 780)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9775 (Count: 288)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9585 (Count: 171)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9059 (Count: 134)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9190 (Count: 324)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7510 (Count: 106)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8314 (Count: 281)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8449 (Count: 141)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8373 (Count: 276)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7936 (Count: 230)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7825 (Count: 209)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9499 (Count: 782)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8811 (Count: 159)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8823 (Count: 244)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 50.
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 50) ---
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9710
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8916 | Median: 0.9520 | Min: 0.1552
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.04% (1018/9222)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0799
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8688 (Count: 156)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9427 (Count: 138)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9685 (Count: 150)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8821 (Count: 247)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9384 (Count: 160)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9431 (Count: 206)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9566 (Count: 135)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9402 (Count: 132)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7083 (Count: 125)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9625 (Count: 178)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7183 (Count: 150)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9639 (Count: 149)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7805 (Count: 159)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7720 (Count: 169)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9543 (Count: 180)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9552 (Count: 159)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9742 (Count: 788)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9343 (Count: 350)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8913 (Count: 153)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9136 (Count: 157)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8849 (Count: 219)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9160 (Count: 162)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8657 (Count: 132)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8299 (Count: 139)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9014 (Count: 137)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9229 (Count: 780)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9775 (Count: 288)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9585 (Count: 171)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9059 (Count: 134)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9190 (Count: 324)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7510 (Count: 106)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8314 (Count: 281)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8449 (Count: 141)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8373 (Count: 276)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7936 (Count: 230)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7825 (Count: 209)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9499 (Count: 782)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8811 (Count: 159)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8823 (Count: 244)
2025-04-15 14:58:19 | INFO     | core.training.callbacks.model_checkpoint - Epoch 50: val_loss improved from 1.988625 to 1.969701.
2025-04-15 14:58:19 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 50)
2025-04-15 14:58:20 | INFO     | core.training.callbacks.model_checkpoint - Epoch 50: val_loss improved from 1.988625 to 1.969701.
2025-04-15 14:58:20 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 50)
2025-04-15 14:58:20 | INFO     | core.training.callbacks.early_stopping - Epoch 50: EarlyStopping val_loss improved from 1.988625 to 1.969701
2025-04-15 14:58:20 | INFO     | core.training.callbacks.early_stopping - Epoch 50: EarlyStopping val_loss improved from 1.988625 to 1.969701
2025-04-15 14:58:20 | INFO     | core.training.callbacks.gradcam_callback - Generating GradCAM visualizations at epoch 50
2025-04-15 14:58:20 | INFO     | core.models.model_cbam18 - Using layer4[-1].conv2 as GradCAM target layer
2025-04-15 14:58:20 | INFO     | core.evaluation.interpretability - Using model's recommended GradCAM target layer
2025-04-15 14:58:20 | INFO     | core.evaluation.interpretability - GradCAM initialized with target layer: Conv2d
2025-04-15 14:58:21 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:21 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:21 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:22 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:22 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:23 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:23 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:24 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:24 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:25 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:25 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:26 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:26 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:26 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:27 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:27 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:30 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:30 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:31 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:31 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:37 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:37 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:38 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:38 | WARNING  | core.evaluation.interpretability - CAM is all zeros or very small after ReLU - using enhanced approach
2025-04-15 14:58:39 | INFO     | core.training.callbacks.gradcam_callback - Generated summary HTML: outputs/cbam_only_resnet18_v2/gradcam/epoch_050/gradcam_summary.html
2025-04-15 14:58:39 | INFO     | core.training.callbacks.gradcam_callback - GradCAM visualizations saved to outputs/cbam_only_resnet18_v2/gradcam/epoch_050
2025-04-15 14:58:39 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 50: Captured validation outputs and targets for visualization.
2025-04-15 14:58:39 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 50: Captured validation outputs and targets for visualization.
2025-04-15 14:58:39 | INFO     | core.training.callbacks.swa - Epoch 51: Starting SWA phase.
2025-04-15 14:58:39 | INFO     | core.training.callbacks.swa -   Initialized SWALR scheduler with swa_lr=0.0002
2025-04-15 14:58:39 | INFO     | core.training.callbacks.swa - Epoch 51: Starting SWA phase.
2025-04-15 14:58:39 | INFO     | core.training.callbacks.swa -   Initialized SWALR scheduler with swa_lr=0.0002
2025-04-15 15:00:33 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:00:33 | INFO     | core.training.train - Epoch 51 [Fine-tuning] Train: Loss=9.1441, Acc=0.8105, Prec=0.8097, Rec=0.8105, F1=0.8099 (114.47s)
2025-04-15 15:00:42 | INFO     | core.training.train - Epoch 51 [Fine-tuning] Val:   Loss=1.9906, Acc=0.9709, Prec=0.9715, Rec=0.9709, F1=0.9708 (8.33s)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 51.
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 51) ---
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9709
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8928 | Median: 0.9543 | Min: 0.1422
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.19% (1032/9222)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0783
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8579 (Count: 153)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9381 (Count: 138)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9716 (Count: 150)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8890 (Count: 247)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9399 (Count: 160)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9495 (Count: 206)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9494 (Count: 135)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9477 (Count: 132)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7028 (Count: 122)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9708 (Count: 178)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7243 (Count: 151)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9681 (Count: 150)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7663 (Count: 158)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7749 (Count: 170)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9489 (Count: 180)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9426 (Count: 159)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9823 (Count: 789)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9478 (Count: 351)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8890 (Count: 152)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9174 (Count: 156)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8842 (Count: 219)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8989 (Count: 161)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8587 (Count: 133)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8290 (Count: 138)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8985 (Count: 138)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9230 (Count: 784)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9757 (Count: 287)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9569 (Count: 171)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9065 (Count: 133)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9196 (Count: 323)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7697 (Count: 110)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8258 (Count: 278)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8391 (Count: 143)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8467 (Count: 274)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8058 (Count: 237)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7648 (Count: 205)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9583 (Count: 783)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8547 (Count: 158)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8812 (Count: 242)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 51.
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 51) ---
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9709
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8928 | Median: 0.9543 | Min: 0.1422
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.19% (1032/9222)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0783
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8579 (Count: 153)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9381 (Count: 138)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9716 (Count: 150)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8890 (Count: 247)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9399 (Count: 160)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9495 (Count: 206)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9494 (Count: 135)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9477 (Count: 132)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7028 (Count: 122)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9708 (Count: 178)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7243 (Count: 151)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9681 (Count: 150)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7663 (Count: 158)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7749 (Count: 170)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9489 (Count: 180)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9426 (Count: 159)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9823 (Count: 789)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9478 (Count: 351)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8890 (Count: 152)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9174 (Count: 156)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8842 (Count: 219)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8989 (Count: 161)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8587 (Count: 133)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8290 (Count: 138)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.8985 (Count: 138)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9230 (Count: 784)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9757 (Count: 287)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9569 (Count: 171)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9065 (Count: 133)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9196 (Count: 323)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7697 (Count: 110)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8258 (Count: 278)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8391 (Count: 143)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8467 (Count: 274)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8058 (Count: 237)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7648 (Count: 205)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9583 (Count: 783)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8547 (Count: 158)
2025-04-15 15:00:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8812 (Count: 242)
2025-04-15 15:00:43 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 51)
2025-04-15 15:00:43 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 51)
2025-04-15 15:00:43 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 51: Captured validation outputs and targets for visualization.
2025-04-15 15:00:43 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 51: Captured validation outputs and targets for visualization.
2025-04-15 15:02:37 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:02:37 | INFO     | core.training.train - Epoch 52 [Fine-tuning] Train: Loss=9.1736, Acc=0.8127, Prec=0.8118, Rec=0.8127, F1=0.8120 (113.49s)
2025-04-15 15:02:45 | INFO     | core.training.train - Epoch 52 [Fine-tuning] Val:   Loss=1.9677, Acc=0.9726, Prec=0.9734, Rec=0.9726, F1=0.9724 (7.70s)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 52.
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 52) ---
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9726
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8926 | Median: 0.9529 | Min: 0.1772
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    10.93% (1008/9222)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0800
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8467 (Count: 154)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9529 (Count: 138)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9701 (Count: 150)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8997 (Count: 249)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9363 (Count: 160)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9421 (Count: 205)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9625 (Count: 134)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9413 (Count: 133)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7026 (Count: 126)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9539 (Count: 178)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7134 (Count: 152)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9732 (Count: 150)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7849 (Count: 157)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7905 (Count: 170)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9348 (Count: 180)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9644 (Count: 159)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9759 (Count: 789)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9377 (Count: 350)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8817 (Count: 151)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9079 (Count: 156)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8685 (Count: 220)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9006 (Count: 160)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8583 (Count: 132)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8050 (Count: 139)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9030 (Count: 139)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9263 (Count: 783)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9735 (Count: 287)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9676 (Count: 170)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9002 (Count: 135)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9210 (Count: 323)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7423 (Count: 104)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8326 (Count: 286)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8494 (Count: 146)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8451 (Count: 275)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7926 (Count: 227)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7856 (Count: 209)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9552 (Count: 789)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8662 (Count: 158)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8844 (Count: 246)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 52.
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 52) ---
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9726
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8926 | Median: 0.9529 | Min: 0.1772
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    10.93% (1008/9222)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0800
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8467 (Count: 154)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9529 (Count: 138)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9701 (Count: 150)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8997 (Count: 249)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9363 (Count: 160)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9421 (Count: 205)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9625 (Count: 134)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9413 (Count: 133)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7026 (Count: 126)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9539 (Count: 178)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7134 (Count: 152)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9732 (Count: 150)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7849 (Count: 157)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7905 (Count: 170)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9348 (Count: 180)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9644 (Count: 159)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9759 (Count: 789)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9377 (Count: 350)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8817 (Count: 151)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9079 (Count: 156)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8685 (Count: 220)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9006 (Count: 160)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8583 (Count: 132)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8050 (Count: 139)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9030 (Count: 139)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9263 (Count: 783)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9735 (Count: 287)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9676 (Count: 170)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9002 (Count: 135)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9210 (Count: 323)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7423 (Count: 104)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8326 (Count: 286)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8494 (Count: 146)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8451 (Count: 275)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7926 (Count: 227)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7856 (Count: 209)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9552 (Count: 789)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8662 (Count: 158)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8844 (Count: 246)
2025-04-15 15:02:45 | INFO     | core.training.callbacks.model_checkpoint - Epoch 52: val_loss improved from 1.969701 to 1.967668.
2025-04-15 15:02:46 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 52)
2025-04-15 15:02:46 | INFO     | core.training.callbacks.model_checkpoint - Epoch 52: val_loss improved from 1.969701 to 1.967668.
2025-04-15 15:02:46 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 52)
2025-04-15 15:02:47 | INFO     | core.training.callbacks.early_stopping - Epoch 52: EarlyStopping val_loss improved from 1.969701 to 1.967668
2025-04-15 15:02:47 | INFO     | core.training.callbacks.early_stopping - Epoch 52: EarlyStopping val_loss improved from 1.969701 to 1.967668
2025-04-15 15:02:47 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 52: Captured validation outputs and targets for visualization.
2025-04-15 15:02:47 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 52: Captured validation outputs and targets for visualization.
2025-04-15 15:04:38 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:04:38 | INFO     | core.training.train - Epoch 53 [Fine-tuning] Train: Loss=9.4808, Acc=0.8057, Prec=0.8048, Rec=0.8057, F1=0.8050 (111.16s)
2025-04-15 15:04:46 | INFO     | core.training.train - Epoch 53 [Fine-tuning] Val:   Loss=1.9904, Acc=0.9703, Prec=0.9712, Rec=0.9703, F1=0.9701 (7.67s)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 53.
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 53) ---
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9703
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8931 | Median: 0.9547 | Min: 0.2066
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.24% (1037/9222)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0775
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8637 (Count: 154)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9134 (Count: 137)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9762 (Count: 150)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8901 (Count: 242)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9335 (Count: 160)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9365 (Count: 206)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9537 (Count: 134)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9701 (Count: 132)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7016 (Count: 123)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9597 (Count: 178)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7200 (Count: 151)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9692 (Count: 149)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.8237 (Count: 166)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7375 (Count: 161)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9524 (Count: 180)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9657 (Count: 159)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9751 (Count: 787)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9560 (Count: 352)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8966 (Count: 152)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9285 (Count: 157)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8876 (Count: 221)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9075 (Count: 161)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8524 (Count: 132)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7942 (Count: 135)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9012 (Count: 135)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9308 (Count: 786)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9899 (Count: 288)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9658 (Count: 170)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8757 (Count: 132)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9147 (Count: 324)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7476 (Count: 105)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8662 (Count: 285)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8602 (Count: 146)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8380 (Count: 273)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8140 (Count: 242)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7323 (Count: 199)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9644 (Count: 790)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8127 (Count: 157)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8556 (Count: 237)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 53.
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 53) ---
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9703
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8931 | Median: 0.9547 | Min: 0.2066
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.24% (1037/9222)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0775
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8637 (Count: 154)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9134 (Count: 137)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9762 (Count: 150)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8901 (Count: 242)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9335 (Count: 160)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9365 (Count: 206)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9537 (Count: 134)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9701 (Count: 132)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7016 (Count: 123)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9597 (Count: 178)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7200 (Count: 151)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9692 (Count: 149)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.8237 (Count: 166)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7375 (Count: 161)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9524 (Count: 180)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9657 (Count: 159)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9751 (Count: 787)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9560 (Count: 352)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8966 (Count: 152)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9285 (Count: 157)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8876 (Count: 221)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9075 (Count: 161)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8524 (Count: 132)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.7942 (Count: 135)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9012 (Count: 135)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9308 (Count: 786)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9899 (Count: 288)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9658 (Count: 170)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8757 (Count: 132)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9147 (Count: 324)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7476 (Count: 105)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8662 (Count: 285)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8602 (Count: 146)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8380 (Count: 273)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8140 (Count: 242)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7323 (Count: 199)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9644 (Count: 790)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8127 (Count: 157)
2025-04-15 15:04:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8556 (Count: 237)
2025-04-15 15:04:47 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 53)
2025-04-15 15:04:47 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 53)
2025-04-15 15:04:47 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 53: Captured validation outputs and targets for visualization.
2025-04-15 15:04:47 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 53: Captured validation outputs and targets for visualization.
2025-04-15 15:06:38 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:06:38 | INFO     | core.training.train - Epoch 54 [Fine-tuning] Train: Loss=9.4103, Acc=0.8068, Prec=0.8058, Rec=0.8068, F1=0.8061 (110.87s)
2025-04-15 15:06:46 | INFO     | core.training.train - Epoch 54 [Fine-tuning] Val:   Loss=2.0104, Acc=0.9687, Prec=0.9699, Rec=0.9687, F1=0.9685 (7.71s)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 54.
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 54) ---
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9687
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8918 | Median: 0.9539 | Min: 0.1998
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.34% (1046/9222)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0769
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8389 (Count: 156)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9243 (Count: 132)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9468 (Count: 151)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8473 (Count: 236)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9573 (Count: 161)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9097 (Count: 206)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9595 (Count: 136)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9541 (Count: 133)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7040 (Count: 113)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9688 (Count: 178)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7497 (Count: 150)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9844 (Count: 150)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.8263 (Count: 159)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7766 (Count: 171)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9407 (Count: 181)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9585 (Count: 159)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9863 (Count: 788)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9694 (Count: 350)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9228 (Count: 153)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9187 (Count: 157)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8920 (Count: 222)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9209 (Count: 162)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8445 (Count: 126)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8791 (Count: 143)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9112 (Count: 137)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9235 (Count: 785)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9827 (Count: 288)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9538 (Count: 169)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8783 (Count: 132)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8858 (Count: 318)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7548 (Count: 107)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8877 (Count: 287)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8715 (Count: 146)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8165 (Count: 271)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8117 (Count: 245)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7503 (Count: 202)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9588 (Count: 789)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8053 (Count: 155)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8048 (Count: 229)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 54.
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 54) ---
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9687
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8918 | Median: 0.9539 | Min: 0.1998
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    11.34% (1046/9222)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0769
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8389 (Count: 156)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9243 (Count: 132)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9468 (Count: 151)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8473 (Count: 236)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9573 (Count: 161)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9097 (Count: 206)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9595 (Count: 136)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9541 (Count: 133)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7040 (Count: 113)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9688 (Count: 178)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7497 (Count: 150)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9844 (Count: 150)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.8263 (Count: 159)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.7766 (Count: 171)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9407 (Count: 181)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9585 (Count: 159)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9863 (Count: 788)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9694 (Count: 350)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9228 (Count: 153)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9187 (Count: 157)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8920 (Count: 222)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9209 (Count: 162)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8445 (Count: 126)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8791 (Count: 143)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9112 (Count: 137)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9235 (Count: 785)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9827 (Count: 288)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9538 (Count: 169)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8783 (Count: 132)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8858 (Count: 318)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7548 (Count: 107)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8877 (Count: 287)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8715 (Count: 146)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8165 (Count: 271)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8117 (Count: 245)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7503 (Count: 202)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9588 (Count: 789)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8053 (Count: 155)
2025-04-15 15:06:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8048 (Count: 229)
2025-04-15 15:06:47 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 54)
2025-04-15 15:06:47 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 54)
2025-04-15 15:06:47 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 54: Captured validation outputs and targets for visualization.
2025-04-15 15:06:47 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 54: Captured validation outputs and targets for visualization.
2025-04-15 15:08:43 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:08:43 | INFO     | core.training.train - Epoch 55 [Fine-tuning] Train: Loss=8.6474, Acc=0.8201, Prec=0.8192, Rec=0.8201, F1=0.8194 (116.45s)
2025-04-15 15:08:52 | INFO     | core.training.train - Epoch 55 [Fine-tuning] Val:   Loss=1.9068, Acc=0.9748, Prec=0.9754, Rec=0.9748, F1=0.9745 (8.07s)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 55): Current confidence=0.8918, Change=-0.0013
2025-04-15 15:08:52 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 55): Current confidence=0.8918, Change=-0.0013
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 55.
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 55) ---
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9748
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8979 | Median: 0.9562 | Min: 0.1941
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    10.26% (946/9222)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0773
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8520 (Count: 159)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9435 (Count: 138)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9626 (Count: 151)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9126 (Count: 247)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9394 (Count: 157)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9587 (Count: 206)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9519 (Count: 136)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9718 (Count: 134)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7142 (Count: 131)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9579 (Count: 178)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7121 (Count: 147)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9764 (Count: 150)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7921 (Count: 158)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.8334 (Count: 178)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9488 (Count: 182)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9605 (Count: 159)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9886 (Count: 789)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9515 (Count: 352)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8738 (Count: 150)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9201 (Count: 158)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8750 (Count: 220)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9241 (Count: 161)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8872 (Count: 139)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8384 (Count: 139)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9203 (Count: 138)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9239 (Count: 787)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9831 (Count: 288)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9764 (Count: 170)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8975 (Count: 134)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9212 (Count: 323)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6608 (Count: 94)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7889 (Count: 272)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8277 (Count: 146)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8751 (Count: 275)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8120 (Count: 241)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7867 (Count: 205)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9569 (Count: 788)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8476 (Count: 161)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8786 (Count: 249)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 55.
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 55) ---
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9748
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.8979 | Median: 0.9562 | Min: 0.1941
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    10.26% (946/9222)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0773
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8520 (Count: 159)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9435 (Count: 138)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9626 (Count: 151)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9126 (Count: 247)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9394 (Count: 157)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9587 (Count: 206)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9519 (Count: 136)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9718 (Count: 134)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7142 (Count: 131)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9579 (Count: 178)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7121 (Count: 147)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9764 (Count: 150)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7921 (Count: 158)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.8334 (Count: 178)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9488 (Count: 182)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9605 (Count: 159)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9886 (Count: 789)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9515 (Count: 352)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8738 (Count: 150)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9201 (Count: 158)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8750 (Count: 220)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9241 (Count: 161)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8872 (Count: 139)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8384 (Count: 139)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9203 (Count: 138)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9239 (Count: 787)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9831 (Count: 288)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9764 (Count: 170)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8975 (Count: 134)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9212 (Count: 323)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.6608 (Count: 94)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.7889 (Count: 272)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8277 (Count: 146)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8751 (Count: 275)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8120 (Count: 241)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7867 (Count: 205)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9569 (Count: 788)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8476 (Count: 161)
2025-04-15 15:08:52 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8786 (Count: 249)
2025-04-15 15:08:52 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 15:08:52 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 15:08:52 | INFO     | core.training.callbacks.model_checkpoint - Epoch 55: val_loss improved from 1.967668 to 1.906832.
2025-04-15 15:08:53 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 55)
2025-04-15 15:08:53 | INFO     | core.training.callbacks.model_checkpoint - Epoch 55: val_loss improved from 1.967668 to 1.906832.
2025-04-15 15:08:53 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 55)
2025-04-15 15:08:54 | INFO     | core.training.callbacks.early_stopping - Epoch 55: EarlyStopping val_loss improved from 1.967668 to 1.906832
2025-04-15 15:08:54 | INFO     | core.training.callbacks.early_stopping - Epoch 55: EarlyStopping val_loss improved from 1.967668 to 1.906832
2025-04-15 15:08:54 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 55: Captured validation outputs and targets for visualization.
2025-04-15 15:08:54 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 55: Captured validation outputs and targets for visualization.
2025-04-15 15:10:50 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:10:50 | INFO     | core.training.train - Epoch 56 [Fine-tuning] Train: Loss=7.6621, Acc=0.8411, Prec=0.8405, Rec=0.8411, F1=0.8407 (116.94s)
2025-04-15 15:10:59 | INFO     | core.training.train - Epoch 56 [Fine-tuning] Val:   Loss=1.8219, Acc=0.9733, Prec=0.9751, Rec=0.9733, F1=0.9732 (8.05s)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 56.
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 56) ---
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9733
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9085 | Median: 0.9647 | Min: 0.2284
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    8.57% (790/9222)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0648
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8918 (Count: 159)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9228 (Count: 136)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9714 (Count: 151)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9220 (Count: 248)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9333 (Count: 157)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9557 (Count: 206)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9410 (Count: 136)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9531 (Count: 134)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6629 (Count: 104)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9690 (Count: 178)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7925 (Count: 154)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9593 (Count: 149)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7861 (Count: 159)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.8636 (Count: 178)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9502 (Count: 181)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9367 (Count: 158)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9765 (Count: 787)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9586 (Count: 348)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9504 (Count: 152)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9180 (Count: 157)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8957 (Count: 222)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9001 (Count: 157)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8532 (Count: 128)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9124 (Count: 140)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9212 (Count: 137)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9564 (Count: 792)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9956 (Count: 288)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9761 (Count: 170)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8835 (Count: 135)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9042 (Count: 321)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7942 (Count: 109)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9058 (Count: 289)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8867 (Count: 146)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8407 (Count: 270)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8541 (Count: 243)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7658 (Count: 205)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9648 (Count: 785)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.7949 (Count: 158)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9212 (Count: 249)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 56.
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 56) ---
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9733
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9085 | Median: 0.9647 | Min: 0.2284
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    8.57% (790/9222)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0648
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8918 (Count: 159)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9228 (Count: 136)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9714 (Count: 151)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9220 (Count: 248)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9333 (Count: 157)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9557 (Count: 206)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9410 (Count: 136)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9531 (Count: 134)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6629 (Count: 104)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9690 (Count: 178)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7925 (Count: 154)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9593 (Count: 149)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.7861 (Count: 159)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.8636 (Count: 178)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9502 (Count: 181)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9367 (Count: 158)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9765 (Count: 787)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9586 (Count: 348)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9504 (Count: 152)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9180 (Count: 157)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8957 (Count: 222)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9001 (Count: 157)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8532 (Count: 128)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9124 (Count: 140)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9212 (Count: 137)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9564 (Count: 792)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9956 (Count: 288)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9761 (Count: 170)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8835 (Count: 135)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9042 (Count: 321)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7942 (Count: 109)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9058 (Count: 289)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8867 (Count: 146)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8407 (Count: 270)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8541 (Count: 243)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7658 (Count: 205)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9648 (Count: 785)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.7949 (Count: 158)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9212 (Count: 249)
2025-04-15 15:10:59 | INFO     | core.training.callbacks.model_checkpoint - Epoch 56: val_loss improved from 1.906832 to 1.821876.
2025-04-15 15:11:00 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 56)
2025-04-15 15:11:00 | INFO     | core.training.callbacks.model_checkpoint - Epoch 56: val_loss improved from 1.906832 to 1.821876.
2025-04-15 15:11:00 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 56)
2025-04-15 15:11:01 | INFO     | core.training.callbacks.early_stopping - Epoch 56: EarlyStopping val_loss improved from 1.906832 to 1.821876
2025-04-15 15:11:01 | INFO     | core.training.callbacks.early_stopping - Epoch 56: EarlyStopping val_loss improved from 1.906832 to 1.821876
2025-04-15 15:11:01 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 56: Captured validation outputs and targets for visualization.
2025-04-15 15:11:01 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 56: Captured validation outputs and targets for visualization.
2025-04-15 15:12:56 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:12:56 | INFO     | core.training.train - Epoch 57 [Fine-tuning] Train: Loss=6.7434, Acc=0.8606, Prec=0.8603, Rec=0.8606, F1=0.8604 (115.52s)
2025-04-15 15:13:04 | INFO     | core.training.train - Epoch 57 [Fine-tuning] Val:   Loss=1.8118, Acc=0.9763, Prec=0.9771, Rec=0.9763, F1=0.9760 (7.63s)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 57.
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 57) ---
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9763
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9059 | Median: 0.9628 | Min: 0.1878
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    8.98% (828/9222)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0705
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8735 (Count: 155)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9297 (Count: 138)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9891 (Count: 151)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9312 (Count: 251)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9379 (Count: 156)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9511 (Count: 206)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9570 (Count: 136)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9673 (Count: 134)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6873 (Count: 123)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9356 (Count: 178)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7540 (Count: 151)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9477 (Count: 149)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.8507 (Count: 166)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.8445 (Count: 179)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9487 (Count: 179)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9731 (Count: 159)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9809 (Count: 789)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9543 (Count: 351)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8856 (Count: 151)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9278 (Count: 157)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9056 (Count: 223)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9190 (Count: 160)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8974 (Count: 139)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9012 (Count: 141)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9055 (Count: 135)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9526 (Count: 793)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9956 (Count: 288)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9904 (Count: 170)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9172 (Count: 135)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9502 (Count: 326)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7056 (Count: 99)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8138 (Count: 275)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8125 (Count: 137)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8479 (Count: 273)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8353 (Count: 242)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7633 (Count: 210)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9443 (Count: 787)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8759 (Count: 162)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8892 (Count: 249)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 57.
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 57) ---
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9763
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9059 | Median: 0.9628 | Min: 0.1878
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    8.98% (828/9222)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0705
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8735 (Count: 155)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9297 (Count: 138)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9891 (Count: 151)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9312 (Count: 251)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9379 (Count: 156)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9511 (Count: 206)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9570 (Count: 136)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9673 (Count: 134)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.6873 (Count: 123)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9356 (Count: 178)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7540 (Count: 151)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9477 (Count: 149)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.8507 (Count: 166)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.8445 (Count: 179)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9487 (Count: 179)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9731 (Count: 159)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9809 (Count: 789)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9543 (Count: 351)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8856 (Count: 151)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9278 (Count: 157)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9056 (Count: 223)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9190 (Count: 160)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8974 (Count: 139)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9012 (Count: 141)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9055 (Count: 135)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9526 (Count: 793)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9956 (Count: 288)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9904 (Count: 170)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9172 (Count: 135)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9502 (Count: 326)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7056 (Count: 99)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8138 (Count: 275)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8125 (Count: 137)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8479 (Count: 273)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8353 (Count: 242)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7633 (Count: 210)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9443 (Count: 787)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8759 (Count: 162)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8892 (Count: 249)
2025-04-15 15:13:04 | INFO     | core.training.callbacks.model_checkpoint - Epoch 57: val_loss improved from 1.821876 to 1.811812.
2025-04-15 15:13:05 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 57)
2025-04-15 15:13:05 | INFO     | core.training.callbacks.model_checkpoint - Epoch 57: val_loss improved from 1.821876 to 1.811812.
2025-04-15 15:13:05 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 57)
2025-04-15 15:13:06 | INFO     | core.training.callbacks.early_stopping - Epoch 57: EarlyStopping val_loss improved from 1.821876 to 1.811812
2025-04-15 15:13:06 | INFO     | core.training.callbacks.early_stopping - Epoch 57: EarlyStopping val_loss improved from 1.821876 to 1.811812
2025-04-15 15:13:06 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 57: Captured validation outputs and targets for visualization.
2025-04-15 15:13:06 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 57: Captured validation outputs and targets for visualization.
2025-04-15 15:14:56 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:14:56 | INFO     | core.training.train - Epoch 58 [Fine-tuning] Train: Loss=6.1500, Acc=0.8735, Prec=0.8731, Rec=0.8735, F1=0.8732 (109.98s)
2025-04-15 15:15:03 | INFO     | core.training.train - Epoch 58 [Fine-tuning] Val:   Loss=1.7496, Acc=0.9785, Prec=0.9791, Rec=0.9785, F1=0.9786 (7.66s)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 58.
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 58) ---
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9785
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9082 | Median: 0.9606 | Min: 0.1695
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    8.39% (774/9222)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0707
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9152 (Count: 157)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9821 (Count: 138)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9859 (Count: 151)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8832 (Count: 242)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9452 (Count: 160)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9556 (Count: 206)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9522 (Count: 137)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9528 (Count: 132)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7119 (Count: 132)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9691 (Count: 178)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7669 (Count: 149)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9609 (Count: 149)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.8393 (Count: 165)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.8878 (Count: 181)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9543 (Count: 181)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9435 (Count: 158)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9823 (Count: 789)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9637 (Count: 351)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9388 (Count: 153)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9274 (Count: 158)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9217 (Count: 223)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9235 (Count: 163)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8858 (Count: 139)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8481 (Count: 138)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9331 (Count: 139)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8974 (Count: 783)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9891 (Count: 288)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9788 (Count: 170)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9285 (Count: 133)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8780 (Count: 320)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8399 (Count: 125)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8778 (Count: 285)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8892 (Count: 149)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8619 (Count: 268)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7745 (Count: 231)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7792 (Count: 207)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9674 (Count: 788)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9140 (Count: 161)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8883 (Count: 247)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 58.
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 58) ---
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9785
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9082 | Median: 0.9606 | Min: 0.1695
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    8.39% (774/9222)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0707
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9152 (Count: 157)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9821 (Count: 138)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9859 (Count: 151)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.8832 (Count: 242)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9452 (Count: 160)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9556 (Count: 206)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9522 (Count: 137)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9528 (Count: 132)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7119 (Count: 132)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9691 (Count: 178)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.7669 (Count: 149)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9609 (Count: 149)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.8393 (Count: 165)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.8878 (Count: 181)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9543 (Count: 181)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9435 (Count: 158)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9823 (Count: 789)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9637 (Count: 351)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9388 (Count: 153)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9274 (Count: 158)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9217 (Count: 223)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9235 (Count: 163)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8858 (Count: 139)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8481 (Count: 138)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9331 (Count: 139)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.8974 (Count: 783)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9891 (Count: 288)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9788 (Count: 170)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9285 (Count: 133)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8780 (Count: 320)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8399 (Count: 125)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8778 (Count: 285)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8892 (Count: 149)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8619 (Count: 268)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7745 (Count: 231)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7792 (Count: 207)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9674 (Count: 788)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9140 (Count: 161)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8883 (Count: 247)
2025-04-15 15:15:04 | INFO     | core.training.callbacks.model_checkpoint - Epoch 58: val_loss improved from 1.811812 to 1.749645.
2025-04-15 15:15:04 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 58)
2025-04-15 15:15:05 | INFO     | core.training.callbacks.model_checkpoint - Epoch 58: val_loss improved from 1.811812 to 1.749645.
2025-04-15 15:15:05 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 58)
2025-04-15 15:15:05 | INFO     | core.training.callbacks.early_stopping - Epoch 58: EarlyStopping val_loss improved from 1.811812 to 1.749645
2025-04-15 15:15:05 | INFO     | core.training.callbacks.early_stopping - Epoch 58: EarlyStopping val_loss improved from 1.811812 to 1.749645
2025-04-15 15:15:05 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 58: Captured validation outputs and targets for visualization.
2025-04-15 15:15:05 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 58: Captured validation outputs and targets for visualization.
2025-04-15 15:16:55 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:16:55 | INFO     | core.training.train - Epoch 59 [Fine-tuning] Train: Loss=5.5080, Acc=0.8855, Prec=0.8852, Rec=0.8855, F1=0.8853 (109.44s)
2025-04-15 15:17:03 | INFO     | core.training.train - Epoch 59 [Fine-tuning] Val:   Loss=1.6266, Acc=0.9816, Prec=0.9823, Rec=0.9816, F1=0.9816 (7.69s)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 59.
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 59) ---
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9816
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9201 | Median: 0.9680 | Min: 0.1384
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    6.38% (588/9222)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0615
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8958 (Count: 159)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9709 (Count: 138)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9791 (Count: 151)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9109 (Count: 250)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9594 (Count: 161)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9665 (Count: 206)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9417 (Count: 135)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9538 (Count: 134)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7397 (Count: 123)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9817 (Count: 179)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8208 (Count: 152)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9812 (Count: 149)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9107 (Count: 167)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.8734 (Count: 179)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9606 (Count: 182)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9630 (Count: 159)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9800 (Count: 788)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9665 (Count: 352)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9406 (Count: 153)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9129 (Count: 157)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8865 (Count: 222)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9551 (Count: 162)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8996 (Count: 139)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9305 (Count: 144)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9586 (Count: 139)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9419 (Count: 783)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9898 (Count: 288)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9707 (Count: 170)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8831 (Count: 133)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9121 (Count: 322)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7692 (Count: 119)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8977 (Count: 287)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9017 (Count: 148)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8724 (Count: 274)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8064 (Count: 237)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8103 (Count: 217)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9426 (Count: 779)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9302 (Count: 162)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9406 (Count: 253)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 59.
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 59) ---
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9816
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9201 | Median: 0.9680 | Min: 0.1384
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    6.38% (588/9222)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0615
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.8958 (Count: 159)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9709 (Count: 138)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9791 (Count: 151)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9109 (Count: 250)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9594 (Count: 161)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9665 (Count: 206)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9417 (Count: 135)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9538 (Count: 134)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7397 (Count: 123)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9817 (Count: 179)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8208 (Count: 152)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9812 (Count: 149)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9107 (Count: 167)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.8734 (Count: 179)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9606 (Count: 182)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9630 (Count: 159)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9800 (Count: 788)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9665 (Count: 352)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9406 (Count: 153)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9129 (Count: 157)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8865 (Count: 222)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9551 (Count: 162)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8996 (Count: 139)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9305 (Count: 144)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9586 (Count: 139)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9419 (Count: 783)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9898 (Count: 288)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9707 (Count: 170)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.8831 (Count: 133)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9121 (Count: 322)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7692 (Count: 119)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8977 (Count: 287)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9017 (Count: 148)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8724 (Count: 274)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8064 (Count: 237)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8103 (Count: 217)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9426 (Count: 779)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9302 (Count: 162)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9406 (Count: 253)
2025-04-15 15:17:03 | INFO     | core.training.callbacks.model_checkpoint - Epoch 59: val_loss improved from 1.749645 to 1.626581.
2025-04-15 15:17:03 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 59)
2025-04-15 15:17:04 | INFO     | core.training.callbacks.model_checkpoint - Epoch 59: val_loss improved from 1.749645 to 1.626581.
2025-04-15 15:17:04 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 59)
2025-04-15 15:17:04 | INFO     | core.training.callbacks.early_stopping - Epoch 59: EarlyStopping val_loss improved from 1.749645 to 1.626581
2025-04-15 15:17:04 | INFO     | core.training.callbacks.early_stopping - Epoch 59: EarlyStopping val_loss improved from 1.749645 to 1.626581
2025-04-15 15:17:04 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 59: Captured validation outputs and targets for visualization.
2025-04-15 15:17:04 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 59: Captured validation outputs and targets for visualization.
2025-04-15 15:18:54 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:18:54 | INFO     | core.training.train - Epoch 60 [Fine-tuning] Train: Loss=5.2401, Acc=0.8962, Prec=0.8960, Rec=0.8962, F1=0.8960 (110.11s)
2025-04-15 15:19:02 | INFO     | core.training.train - Epoch 60 [Fine-tuning] Val:   Loss=1.5979, Acc=0.9807, Prec=0.9815, Rec=0.9807, F1=0.9806 (7.64s)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 60): Current confidence=0.9201, Change=+0.0119
2025-04-15 15:19:03 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 60): Current confidence=0.9201, Change=+0.0119
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 60.
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 60) ---
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9807
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9217 | Median: 0.9673 | Min: 0.1664
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    6.25% (576/9222)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0590
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9201 (Count: 158)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9802 (Count: 138)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9702 (Count: 151)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9051 (Count: 246)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9516 (Count: 156)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9735 (Count: 206)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9669 (Count: 138)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9512 (Count: 134)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7516 (Count: 116)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9789 (Count: 177)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8477 (Count: 151)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9756 (Count: 149)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.8904 (Count: 168)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.8796 (Count: 179)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9416 (Count: 182)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9548 (Count: 159)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9679 (Count: 789)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9602 (Count: 351)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9184 (Count: 152)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9172 (Count: 158)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9371 (Count: 223)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9714 (Count: 163)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8990 (Count: 140)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9410 (Count: 144)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9338 (Count: 139)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9221 (Count: 783)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9893 (Count: 288)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9624 (Count: 170)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9516 (Count: 135)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9013 (Count: 322)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8083 (Count: 124)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8837 (Count: 282)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9100 (Count: 148)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9177 (Count: 278)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8010 (Count: 224)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8041 (Count: 213)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9656 (Count: 795)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9295 (Count: 161)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9314 (Count: 254)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 60.
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 60) ---
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9807
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9217 | Median: 0.9673 | Min: 0.1664
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    6.25% (576/9222)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0590
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9201 (Count: 158)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9802 (Count: 138)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9702 (Count: 151)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9051 (Count: 246)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9516 (Count: 156)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9735 (Count: 206)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9669 (Count: 138)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9512 (Count: 134)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7516 (Count: 116)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9789 (Count: 177)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8477 (Count: 151)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9756 (Count: 149)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.8904 (Count: 168)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.8796 (Count: 179)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9416 (Count: 182)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9548 (Count: 159)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9679 (Count: 789)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9602 (Count: 351)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9184 (Count: 152)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9172 (Count: 158)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9371 (Count: 223)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9714 (Count: 163)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8990 (Count: 140)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9410 (Count: 144)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9338 (Count: 139)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9221 (Count: 783)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9893 (Count: 288)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9624 (Count: 170)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9516 (Count: 135)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9013 (Count: 322)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8083 (Count: 124)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8837 (Count: 282)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9100 (Count: 148)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9177 (Count: 278)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8010 (Count: 224)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8041 (Count: 213)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9656 (Count: 795)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9295 (Count: 161)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9314 (Count: 254)
2025-04-15 15:19:03 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 15:19:03 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 15:19:03 | INFO     | core.training.callbacks.model_checkpoint - Epoch 60: val_loss improved from 1.626581 to 1.597899.
2025-04-15 15:19:03 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 60)
2025-04-15 15:19:03 | INFO     | core.training.callbacks.model_checkpoint - Epoch 60: val_loss improved from 1.626581 to 1.597899.
2025-04-15 15:19:04 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 60)
2025-04-15 15:19:04 | INFO     | core.training.callbacks.early_stopping - Epoch 60: EarlyStopping val_loss improved from 1.626581 to 1.597899
2025-04-15 15:19:04 | INFO     | core.training.callbacks.early_stopping - Epoch 60: EarlyStopping val_loss improved from 1.626581 to 1.597899
2025-04-15 15:19:04 | INFO     | core.training.callbacks.gradcam_callback - Generating GradCAM visualizations at epoch 60
2025-04-15 15:19:04 | INFO     | core.models.model_cbam18 - Using layer4[-1].conv2 as GradCAM target layer
2025-04-15 15:19:04 | INFO     | core.evaluation.interpretability - Using model's recommended GradCAM target layer
2025-04-15 15:19:04 | INFO     | core.evaluation.interpretability - GradCAM initialized with target layer: Conv2d
2025-04-15 15:19:21 | INFO     | core.training.callbacks.gradcam_callback - Generated summary HTML: outputs/cbam_only_resnet18_v2/gradcam/epoch_060/gradcam_summary.html
2025-04-15 15:19:21 | INFO     | core.training.callbacks.gradcam_callback - GradCAM visualizations saved to outputs/cbam_only_resnet18_v2/gradcam/epoch_060
2025-04-15 15:19:21 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 60: Captured validation outputs and targets for visualization.
2025-04-15 15:19:21 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 60: Captured validation outputs and targets for visualization.
2025-04-15 15:21:11 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:21:11 | INFO     | core.training.train - Epoch 61 [Fine-tuning] Train: Loss=4.8206, Acc=0.9033, Prec=0.9032, Rec=0.9033, F1=0.9032 (109.80s)
2025-04-15 15:21:19 | INFO     | core.training.train - Epoch 61 [Fine-tuning] Val:   Loss=1.5582, Acc=0.9844, Prec=0.9845, Rec=0.9844, F1=0.9844 (7.50s)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 61.
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 61) ---
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9844
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9293 | Median: 0.9742 | Min: 0.2181
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    5.26% (485/9222)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0550
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9227 (Count: 161)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9680 (Count: 138)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9768 (Count: 151)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9384 (Count: 245)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9442 (Count: 159)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9889 (Count: 206)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9670 (Count: 139)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9750 (Count: 135)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7793 (Count: 136)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9699 (Count: 178)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8075 (Count: 148)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9845 (Count: 149)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.8730 (Count: 167)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9312 (Count: 180)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9759 (Count: 182)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9700 (Count: 159)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9793 (Count: 789)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9761 (Count: 352)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9135 (Count: 151)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9295 (Count: 157)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9382 (Count: 223)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9191 (Count: 159)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8678 (Count: 134)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8886 (Count: 142)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9416 (Count: 137)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9554 (Count: 792)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9814 (Count: 287)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9716 (Count: 171)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9406 (Count: 135)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9005 (Count: 320)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8812 (Count: 125)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9149 (Count: 290)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9227 (Count: 150)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8979 (Count: 280)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8542 (Count: 238)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7705 (Count: 206)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9722 (Count: 795)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9188 (Count: 161)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8995 (Count: 251)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 61.
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 61) ---
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9844
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9293 | Median: 0.9742 | Min: 0.2181
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    5.26% (485/9222)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0550
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9227 (Count: 161)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9680 (Count: 138)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9768 (Count: 151)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9384 (Count: 245)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9442 (Count: 159)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9889 (Count: 206)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9670 (Count: 139)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9750 (Count: 135)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7793 (Count: 136)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9699 (Count: 178)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8075 (Count: 148)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9845 (Count: 149)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.8730 (Count: 167)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9312 (Count: 180)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9759 (Count: 182)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9700 (Count: 159)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9793 (Count: 789)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9761 (Count: 352)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9135 (Count: 151)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9295 (Count: 157)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9382 (Count: 223)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9191 (Count: 159)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8678 (Count: 134)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8886 (Count: 142)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9416 (Count: 137)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9554 (Count: 792)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9814 (Count: 287)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9716 (Count: 171)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9406 (Count: 135)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9005 (Count: 320)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8812 (Count: 125)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9149 (Count: 290)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9227 (Count: 150)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8979 (Count: 280)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8542 (Count: 238)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.7705 (Count: 206)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9722 (Count: 795)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9188 (Count: 161)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8995 (Count: 251)
2025-04-15 15:21:19 | INFO     | core.training.callbacks.model_checkpoint - Epoch 61: val_loss improved from 1.597899 to 1.558224.
2025-04-15 15:21:20 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 61)
2025-04-15 15:21:20 | INFO     | core.training.callbacks.model_checkpoint - Epoch 61: val_loss improved from 1.597899 to 1.558224.
2025-04-15 15:21:20 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 61)
2025-04-15 15:21:20 | INFO     | core.training.callbacks.early_stopping - Epoch 61: EarlyStopping val_loss improved from 1.597899 to 1.558224
2025-04-15 15:21:20 | INFO     | core.training.callbacks.early_stopping - Epoch 61: EarlyStopping val_loss improved from 1.597899 to 1.558224
2025-04-15 15:21:20 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 61: Captured validation outputs and targets for visualization.
2025-04-15 15:21:20 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 61: Captured validation outputs and targets for visualization.
2025-04-15 15:23:10 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:23:10 | INFO     | core.training.train - Epoch 62 [Fine-tuning] Train: Loss=4.4845, Acc=0.9116, Prec=0.9114, Rec=0.9116, F1=0.9115 (109.47s)
2025-04-15 15:23:18 | INFO     | core.training.train - Epoch 62 [Fine-tuning] Val:   Loss=1.5860, Acc=0.9810, Prec=0.9821, Rec=0.9810, F1=0.9809 (7.48s)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 62.
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 62) ---
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9810
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9278 | Median: 0.9731 | Min: 0.1943
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    5.97% (551/9222)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0533
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9029 (Count: 158)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9679 (Count: 138)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9911 (Count: 151)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9376 (Count: 250)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9395 (Count: 160)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9707 (Count: 206)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9727 (Count: 139)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9579 (Count: 134)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7179 (Count: 114)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9763 (Count: 178)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8460 (Count: 154)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9779 (Count: 150)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9468 (Count: 168)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.8636 (Count: 176)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9619 (Count: 182)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9771 (Count: 159)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9694 (Count: 789)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9762 (Count: 352)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9182 (Count: 151)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8880 (Count: 154)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9169 (Count: 222)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9093 (Count: 159)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9433 (Count: 142)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9302 (Count: 144)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9525 (Count: 138)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9633 (Count: 794)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9914 (Count: 288)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9651 (Count: 171)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9403 (Count: 135)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9407 (Count: 321)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7874 (Count: 116)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8905 (Count: 277)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9325 (Count: 150)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8267 (Count: 270)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8703 (Count: 241)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8171 (Count: 211)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9649 (Count: 794)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9164 (Count: 160)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9444 (Count: 251)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 62.
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 62) ---
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9810
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9278 | Median: 0.9731 | Min: 0.1943
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    5.97% (551/9222)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0533
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9029 (Count: 158)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9679 (Count: 138)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9911 (Count: 151)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9376 (Count: 250)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9395 (Count: 160)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9707 (Count: 206)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9727 (Count: 139)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9579 (Count: 134)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7179 (Count: 114)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9763 (Count: 178)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8460 (Count: 154)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9779 (Count: 150)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9468 (Count: 168)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.8636 (Count: 176)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9619 (Count: 182)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9771 (Count: 159)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9694 (Count: 789)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9762 (Count: 352)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9182 (Count: 151)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8880 (Count: 154)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9169 (Count: 222)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9093 (Count: 159)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9433 (Count: 142)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9302 (Count: 144)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9525 (Count: 138)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9633 (Count: 794)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9914 (Count: 288)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9651 (Count: 171)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9403 (Count: 135)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9407 (Count: 321)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.7874 (Count: 116)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8905 (Count: 277)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9325 (Count: 150)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8267 (Count: 270)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8703 (Count: 241)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8171 (Count: 211)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9649 (Count: 794)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9164 (Count: 160)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9444 (Count: 251)
2025-04-15 15:23:18 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 62)
2025-04-15 15:23:19 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 62)
2025-04-15 15:23:19 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 62: Captured validation outputs and targets for visualization.
2025-04-15 15:23:19 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 62: Captured validation outputs and targets for visualization.
2025-04-15 15:25:09 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:25:09 | INFO     | core.training.train - Epoch 63 [Fine-tuning] Train: Loss=4.4099, Acc=0.9119, Prec=0.9118, Rec=0.9119, F1=0.9118 (110.13s)
2025-04-15 15:25:17 | INFO     | core.training.train - Epoch 63 [Fine-tuning] Val:   Loss=1.5524, Acc=0.9838, Prec=0.9842, Rec=0.9838, F1=0.9839 (7.55s)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 63.
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 63) ---
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9838
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9312 | Median: 0.9723 | Min: 0.2426
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    5.37% (495/9222)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0527
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9289 (Count: 161)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9689 (Count: 138)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9864 (Count: 151)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9568 (Count: 251)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.8960 (Count: 152)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9316 (Count: 206)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9799 (Count: 136)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9560 (Count: 134)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7737 (Count: 138)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9717 (Count: 178)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8138 (Count: 147)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9623 (Count: 149)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9526 (Count: 168)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9112 (Count: 177)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9747 (Count: 181)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9697 (Count: 159)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9596 (Count: 787)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9861 (Count: 352)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9137 (Count: 148)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9134 (Count: 159)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9140 (Count: 223)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9459 (Count: 163)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9419 (Count: 140)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9275 (Count: 144)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9701 (Count: 139)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9748 (Count: 795)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9911 (Count: 288)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9940 (Count: 171)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9024 (Count: 133)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9594 (Count: 326)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8286 (Count: 129)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8553 (Count: 281)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9290 (Count: 150)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8797 (Count: 273)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8703 (Count: 235)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8491 (Count: 216)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9549 (Count: 782)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9120 (Count: 160)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9223 (Count: 253)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 63.
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 63) ---
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9838
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9312 | Median: 0.9723 | Min: 0.2426
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    5.37% (495/9222)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0527
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9289 (Count: 161)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9689 (Count: 138)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9864 (Count: 151)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9568 (Count: 251)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.8960 (Count: 152)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9316 (Count: 206)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9799 (Count: 136)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9560 (Count: 134)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7737 (Count: 138)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9717 (Count: 178)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8138 (Count: 147)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9623 (Count: 149)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9526 (Count: 168)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9112 (Count: 177)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9747 (Count: 181)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9697 (Count: 159)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9596 (Count: 787)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9861 (Count: 352)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9137 (Count: 148)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9134 (Count: 159)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9140 (Count: 223)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9459 (Count: 163)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9419 (Count: 140)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9275 (Count: 144)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9701 (Count: 139)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9748 (Count: 795)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9911 (Count: 288)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9940 (Count: 171)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9024 (Count: 133)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9594 (Count: 326)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8286 (Count: 129)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8553 (Count: 281)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9290 (Count: 150)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8797 (Count: 273)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8703 (Count: 235)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8491 (Count: 216)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9549 (Count: 782)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9120 (Count: 160)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9223 (Count: 253)
2025-04-15 15:25:17 | INFO     | core.training.callbacks.model_checkpoint - Epoch 63: val_loss improved from 1.558224 to 1.552382.
2025-04-15 15:25:17 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 63)
2025-04-15 15:25:18 | INFO     | core.training.callbacks.model_checkpoint - Epoch 63: val_loss improved from 1.558224 to 1.552382.
2025-04-15 15:25:18 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 63)
2025-04-15 15:25:18 | INFO     | core.training.callbacks.early_stopping - Epoch 63: EarlyStopping val_loss improved from 1.558224 to 1.552382
2025-04-15 15:25:18 | INFO     | core.training.callbacks.early_stopping - Epoch 63: EarlyStopping val_loss improved from 1.558224 to 1.552382
2025-04-15 15:25:18 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 63: Captured validation outputs and targets for visualization.
2025-04-15 15:25:18 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 63: Captured validation outputs and targets for visualization.
2025-04-15 15:27:08 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:27:08 | INFO     | core.training.train - Epoch 64 [Fine-tuning] Train: Loss=4.2234, Acc=0.9162, Prec=0.9161, Rec=0.9162, F1=0.9161 (109.67s)
2025-04-15 15:27:16 | INFO     | core.training.train - Epoch 64 [Fine-tuning] Val:   Loss=1.4791, Acc=0.9850, Prec=0.9853, Rec=0.9850, F1=0.9850 (7.48s)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 64.
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 64) ---
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9850
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9354 | Median: 0.9754 | Min: 0.1876
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.62% (426/9222)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0497
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9365 (Count: 159)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9806 (Count: 138)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9879 (Count: 151)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9436 (Count: 247)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9411 (Count: 161)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9797 (Count: 206)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9620 (Count: 138)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9717 (Count: 134)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7981 (Count: 135)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9883 (Count: 178)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8420 (Count: 144)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9681 (Count: 149)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9501 (Count: 168)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9051 (Count: 178)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9714 (Count: 182)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9681 (Count: 159)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9785 (Count: 788)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9698 (Count: 352)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9467 (Count: 153)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9319 (Count: 159)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9296 (Count: 223)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9391 (Count: 163)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8461 (Count: 128)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9377 (Count: 147)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9434 (Count: 139)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9548 (Count: 792)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9933 (Count: 288)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9779 (Count: 170)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9552 (Count: 135)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9270 (Count: 323)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8238 (Count: 126)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9236 (Count: 288)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8833 (Count: 149)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9158 (Count: 280)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8311 (Count: 234)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8670 (Count: 220)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9662 (Count: 788)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9436 (Count: 161)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9055 (Count: 251)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 64.
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 64) ---
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9850
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9354 | Median: 0.9754 | Min: 0.1876
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.62% (426/9222)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0497
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9365 (Count: 159)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9806 (Count: 138)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9879 (Count: 151)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9436 (Count: 247)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9411 (Count: 161)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9797 (Count: 206)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9620 (Count: 138)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9717 (Count: 134)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7981 (Count: 135)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9883 (Count: 178)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8420 (Count: 144)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9681 (Count: 149)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9501 (Count: 168)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9051 (Count: 178)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9714 (Count: 182)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9681 (Count: 159)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9785 (Count: 788)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9698 (Count: 352)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9467 (Count: 153)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9319 (Count: 159)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9296 (Count: 223)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9391 (Count: 163)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8461 (Count: 128)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9377 (Count: 147)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9434 (Count: 139)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9548 (Count: 792)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9933 (Count: 288)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9779 (Count: 170)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9552 (Count: 135)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9270 (Count: 323)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8238 (Count: 126)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9236 (Count: 288)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8833 (Count: 149)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9158 (Count: 280)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8311 (Count: 234)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8670 (Count: 220)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9662 (Count: 788)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9436 (Count: 161)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9055 (Count: 251)
2025-04-15 15:27:16 | INFO     | core.training.callbacks.model_checkpoint - Epoch 64: val_loss improved from 1.552382 to 1.479051.
2025-04-15 15:27:17 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 64)
2025-04-15 15:27:17 | INFO     | core.training.callbacks.model_checkpoint - Epoch 64: val_loss improved from 1.552382 to 1.479051.
2025-04-15 15:27:17 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 64)
2025-04-15 15:27:17 | INFO     | core.training.callbacks.early_stopping - Epoch 64: EarlyStopping val_loss improved from 1.552382 to 1.479051
2025-04-15 15:27:17 | INFO     | core.training.callbacks.early_stopping - Epoch 64: EarlyStopping val_loss improved from 1.552382 to 1.479051
2025-04-15 15:27:17 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 64: Captured validation outputs and targets for visualization.
2025-04-15 15:27:17 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 64: Captured validation outputs and targets for visualization.
2025-04-15 15:29:06 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:29:06 | INFO     | core.training.train - Epoch 65 [Fine-tuning] Train: Loss=4.0192, Acc=0.9221, Prec=0.9220, Rec=0.9221, F1=0.9220 (109.05s)
2025-04-15 15:29:14 | INFO     | core.training.train - Epoch 65 [Fine-tuning] Val:   Loss=1.4655, Acc=0.9870, Prec=0.9872, Rec=0.9870, F1=0.9870 (7.52s)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 65): Current confidence=0.9354, Change=+0.0042
2025-04-15 15:29:15 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 65): Current confidence=0.9354, Change=+0.0042
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 65.
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 65) ---
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9870
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9359 | Median: 0.9752 | Min: 0.1761
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.52% (417/9222)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0511
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9439 (Count: 159)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9810 (Count: 138)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9936 (Count: 151)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9210 (Count: 250)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9357 (Count: 156)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9646 (Count: 206)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9705 (Count: 140)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9640 (Count: 134)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8287 (Count: 146)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9687 (Count: 178)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8222 (Count: 142)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9681 (Count: 149)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9210 (Count: 168)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9455 (Count: 180)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9782 (Count: 182)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9537 (Count: 159)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9857 (Count: 789)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9679 (Count: 352)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9151 (Count: 152)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9185 (Count: 158)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9503 (Count: 223)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9722 (Count: 163)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9160 (Count: 139)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9438 (Count: 143)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9640 (Count: 139)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9725 (Count: 797)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9937 (Count: 288)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9862 (Count: 170)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9581 (Count: 135)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8915 (Count: 321)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8234 (Count: 125)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9002 (Count: 286)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8907 (Count: 147)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9119 (Count: 277)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8534 (Count: 238)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8752 (Count: 218)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9342 (Count: 788)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9289 (Count: 162)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9483 (Count: 254)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 65.
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 65) ---
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9870
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9359 | Median: 0.9752 | Min: 0.1761
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.52% (417/9222)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0511
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9439 (Count: 159)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9810 (Count: 138)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9936 (Count: 151)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9210 (Count: 250)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9357 (Count: 156)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9646 (Count: 206)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9705 (Count: 140)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9640 (Count: 134)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8287 (Count: 146)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9687 (Count: 178)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8222 (Count: 142)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9681 (Count: 149)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9210 (Count: 168)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9455 (Count: 180)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9782 (Count: 182)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9537 (Count: 159)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9857 (Count: 789)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9679 (Count: 352)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9151 (Count: 152)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9185 (Count: 158)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9503 (Count: 223)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9722 (Count: 163)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9160 (Count: 139)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9438 (Count: 143)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9640 (Count: 139)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9725 (Count: 797)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9937 (Count: 288)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9862 (Count: 170)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9581 (Count: 135)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8915 (Count: 321)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8234 (Count: 125)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9002 (Count: 286)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8907 (Count: 147)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9119 (Count: 277)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8534 (Count: 238)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8752 (Count: 218)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9342 (Count: 788)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9289 (Count: 162)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9483 (Count: 254)
2025-04-15 15:29:15 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 15:29:15 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 15:29:15 | INFO     | core.training.callbacks.model_checkpoint - Epoch 65: val_loss improved from 1.479051 to 1.465517.
2025-04-15 15:29:15 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 65)
2025-04-15 15:29:15 | INFO     | core.training.callbacks.model_checkpoint - Epoch 65: val_loss improved from 1.479051 to 1.465517.
2025-04-15 15:29:16 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 65)
2025-04-15 15:29:16 | INFO     | core.training.callbacks.early_stopping - Epoch 65: EarlyStopping val_loss improved from 1.479051 to 1.465517
2025-04-15 15:29:16 | INFO     | core.training.callbacks.early_stopping - Epoch 65: EarlyStopping val_loss improved from 1.479051 to 1.465517
2025-04-15 15:29:16 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 65: Captured validation outputs and targets for visualization.
2025-04-15 15:29:16 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 65: Captured validation outputs and targets for visualization.
2025-04-15 15:31:05 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:31:05 | INFO     | core.training.train - Epoch 66 [Fine-tuning] Train: Loss=4.0102, Acc=0.9231, Prec=0.9231, Rec=0.9231, F1=0.9231 (109.49s)
2025-04-15 15:31:13 | INFO     | core.training.train - Epoch 66 [Fine-tuning] Val:   Loss=1.4879, Acc=0.9847, Prec=0.9850, Rec=0.9847, F1=0.9847 (7.52s)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 66.
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 66) ---
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9847
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9260 | Median: 0.9701 | Min: 0.2226
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    5.77% (532/9222)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0588
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9389 (Count: 160)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9768 (Count: 138)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9805 (Count: 151)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9428 (Count: 249)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9258 (Count: 155)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9879 (Count: 206)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9851 (Count: 139)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9562 (Count: 134)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8039 (Count: 142)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9812 (Count: 178)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8319 (Count: 147)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9889 (Count: 149)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.8963 (Count: 168)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9583 (Count: 182)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9562 (Count: 182)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9399 (Count: 159)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9538 (Count: 788)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9541 (Count: 351)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8903 (Count: 151)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9564 (Count: 159)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9168 (Count: 222)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8865 (Count: 162)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8891 (Count: 138)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8928 (Count: 143)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9403 (Count: 138)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9439 (Count: 792)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9906 (Count: 288)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9732 (Count: 171)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9837 (Count: 135)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8904 (Count: 317)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8492 (Count: 124)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8632 (Count: 282)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9210 (Count: 150)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9100 (Count: 280)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7694 (Count: 222)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8701 (Count: 219)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9830 (Count: 798)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9067 (Count: 159)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9005 (Count: 253)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 66.
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 66) ---
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9847
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9260 | Median: 0.9701 | Min: 0.2226
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    5.77% (532/9222)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0588
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9389 (Count: 160)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9768 (Count: 138)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9805 (Count: 151)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9428 (Count: 249)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9258 (Count: 155)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9879 (Count: 206)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9851 (Count: 139)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9562 (Count: 134)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8039 (Count: 142)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9812 (Count: 178)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8319 (Count: 147)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9889 (Count: 149)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.8963 (Count: 168)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9583 (Count: 182)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9562 (Count: 182)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9399 (Count: 159)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9538 (Count: 788)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9541 (Count: 351)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8903 (Count: 151)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9564 (Count: 159)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9168 (Count: 222)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.8865 (Count: 162)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8891 (Count: 138)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8928 (Count: 143)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9403 (Count: 138)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9439 (Count: 792)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9906 (Count: 288)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9732 (Count: 171)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9837 (Count: 135)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.8904 (Count: 317)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8492 (Count: 124)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8632 (Count: 282)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9210 (Count: 150)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9100 (Count: 280)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.7694 (Count: 222)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8701 (Count: 219)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9830 (Count: 798)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9067 (Count: 159)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9005 (Count: 253)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 66)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 66)
2025-04-15 15:31:14 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 66: Captured validation outputs and targets for visualization.
2025-04-15 15:31:14 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 66: Captured validation outputs and targets for visualization.
2025-04-15 15:33:03 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:33:03 | INFO     | core.training.train - Epoch 67 [Fine-tuning] Train: Loss=3.8564, Acc=0.9268, Prec=0.9267, Rec=0.9268, F1=0.9267 (109.12s)
2025-04-15 15:33:11 | INFO     | core.training.train - Epoch 67 [Fine-tuning] Val:   Loss=1.4305, Acc=0.9872, Prec=0.9875, Rec=0.9872, F1=0.9871 (7.51s)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 67.
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 67) ---
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9872
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9425 | Median: 0.9787 | Min: 0.1876
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.12% (380/9222)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0448
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9424 (Count: 161)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9710 (Count: 138)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9828 (Count: 151)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9340 (Count: 247)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9613 (Count: 161)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9829 (Count: 206)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9747 (Count: 140)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9560 (Count: 134)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7852 (Count: 134)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9706 (Count: 178)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8423 (Count: 145)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9765 (Count: 149)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9140 (Count: 167)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9586 (Count: 182)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9760 (Count: 182)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9661 (Count: 159)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9851 (Count: 789)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9617 (Count: 351)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9450 (Count: 153)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9521 (Count: 159)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9561 (Count: 223)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9630 (Count: 163)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9230 (Count: 139)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9212 (Count: 145)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9618 (Count: 139)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9710 (Count: 795)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9948 (Count: 288)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9832 (Count: 171)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9703 (Count: 135)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9570 (Count: 325)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8101 (Count: 121)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9099 (Count: 292)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9263 (Count: 148)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9044 (Count: 280)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9315 (Count: 248)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8049 (Count: 200)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9561 (Count: 794)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9260 (Count: 161)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9318 (Count: 251)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 67.
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 67) ---
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9872
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9425 | Median: 0.9787 | Min: 0.1876
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.12% (380/9222)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0448
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9424 (Count: 161)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9710 (Count: 138)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9828 (Count: 151)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9340 (Count: 247)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9613 (Count: 161)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9829 (Count: 206)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9747 (Count: 140)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9560 (Count: 134)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7852 (Count: 134)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9706 (Count: 178)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8423 (Count: 145)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9765 (Count: 149)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9140 (Count: 167)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9586 (Count: 182)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9760 (Count: 182)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9661 (Count: 159)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9851 (Count: 789)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9617 (Count: 351)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9450 (Count: 153)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9521 (Count: 159)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9561 (Count: 223)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9630 (Count: 163)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9230 (Count: 139)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9212 (Count: 145)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9618 (Count: 139)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9710 (Count: 795)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9948 (Count: 288)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9832 (Count: 171)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9703 (Count: 135)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9570 (Count: 325)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8101 (Count: 121)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9099 (Count: 292)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9263 (Count: 148)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9044 (Count: 280)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9315 (Count: 248)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8049 (Count: 200)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9561 (Count: 794)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9260 (Count: 161)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9318 (Count: 251)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.model_checkpoint - Epoch 67: val_loss improved from 1.465517 to 1.430506.
2025-04-15 15:33:12 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 67)
2025-04-15 15:33:12 | INFO     | core.training.callbacks.model_checkpoint - Epoch 67: val_loss improved from 1.465517 to 1.430506.
2025-04-15 15:33:12 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 67)
2025-04-15 15:33:13 | INFO     | core.training.callbacks.early_stopping - Epoch 67: EarlyStopping val_loss improved from 1.465517 to 1.430506
2025-04-15 15:33:13 | INFO     | core.training.callbacks.early_stopping - Epoch 67: EarlyStopping val_loss improved from 1.465517 to 1.430506
2025-04-15 15:33:13 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 67: Captured validation outputs and targets for visualization.
2025-04-15 15:33:13 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 67: Captured validation outputs and targets for visualization.
2025-04-15 15:35:02 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:35:02 | INFO     | core.training.train - Epoch 68 [Fine-tuning] Train: Loss=3.6386, Acc=0.9312, Prec=0.9311, Rec=0.9312, F1=0.9311 (109.37s)
2025-04-15 15:35:10 | INFO     | core.training.train - Epoch 68 [Fine-tuning] Val:   Loss=1.4310, Acc=0.9863, Prec=0.9866, Rec=0.9863, F1=0.9863 (7.50s)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 68.
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 68) ---
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9863
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9361 | Median: 0.9737 | Min: 0.2158
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.54% (419/9222)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0509
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9261 (Count: 161)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9539 (Count: 138)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9868 (Count: 151)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9552 (Count: 248)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9552 (Count: 159)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9843 (Count: 206)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9625 (Count: 138)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9728 (Count: 135)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8067 (Count: 132)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9906 (Count: 177)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8614 (Count: 148)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9581 (Count: 149)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9488 (Count: 168)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9292 (Count: 180)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9707 (Count: 182)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9684 (Count: 159)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9871 (Count: 789)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9752 (Count: 352)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9500 (Count: 153)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9189 (Count: 157)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9390 (Count: 223)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9381 (Count: 159)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9179 (Count: 139)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9038 (Count: 146)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9385 (Count: 136)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9573 (Count: 796)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9788 (Count: 288)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9622 (Count: 170)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9552 (Count: 135)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9129 (Count: 322)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8552 (Count: 124)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8982 (Count: 292)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9228 (Count: 148)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9170 (Count: 275)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9226 (Count: 248)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8327 (Count: 214)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9447 (Count: 785)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8945 (Count: 161)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9089 (Count: 253)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 68.
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 68) ---
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9863
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9361 | Median: 0.9737 | Min: 0.2158
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.54% (419/9222)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0509
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9261 (Count: 161)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9539 (Count: 138)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9868 (Count: 151)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9552 (Count: 248)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9552 (Count: 159)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9843 (Count: 206)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9625 (Count: 138)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9728 (Count: 135)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8067 (Count: 132)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9906 (Count: 177)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8614 (Count: 148)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9581 (Count: 149)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9488 (Count: 168)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9292 (Count: 180)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9707 (Count: 182)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9684 (Count: 159)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9871 (Count: 789)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9752 (Count: 352)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9500 (Count: 153)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9189 (Count: 157)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9390 (Count: 223)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9381 (Count: 159)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9179 (Count: 139)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9038 (Count: 146)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9385 (Count: 136)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9573 (Count: 796)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9788 (Count: 288)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9622 (Count: 170)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9552 (Count: 135)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9129 (Count: 322)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8552 (Count: 124)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8982 (Count: 292)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9228 (Count: 148)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9170 (Count: 275)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9226 (Count: 248)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8327 (Count: 214)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9447 (Count: 785)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.8945 (Count: 161)
2025-04-15 15:35:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9089 (Count: 253)
2025-04-15 15:35:11 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 68)
2025-04-15 15:35:11 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 68)
2025-04-15 15:35:11 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 68: Captured validation outputs and targets for visualization.
2025-04-15 15:35:11 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 68: Captured validation outputs and targets for visualization.
2025-04-15 15:37:00 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:37:00 | INFO     | core.training.train - Epoch 69 [Fine-tuning] Train: Loss=3.5079, Acc=0.9335, Prec=0.9334, Rec=0.9335, F1=0.9334 (109.51s)
2025-04-15 15:37:08 | INFO     | core.training.train - Epoch 69 [Fine-tuning] Val:   Loss=1.3752, Acc=0.9893, Prec=0.9895, Rec=0.9893, F1=0.9893 (7.46s)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 69.
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 69) ---
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9893
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9423 | Median: 0.9770 | Min: 0.2731
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.86% (356/9222)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0470
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9448 (Count: 161)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9706 (Count: 138)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9918 (Count: 151)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9599 (Count: 251)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9620 (Count: 162)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9847 (Count: 206)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9707 (Count: 139)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9381 (Count: 134)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8131 (Count: 143)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9730 (Count: 178)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8424 (Count: 144)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9816 (Count: 149)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9214 (Count: 167)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9710 (Count: 181)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9808 (Count: 182)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9450 (Count: 159)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9712 (Count: 789)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9649 (Count: 352)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9620 (Count: 154)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9276 (Count: 158)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9272 (Count: 222)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9688 (Count: 162)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9347 (Count: 141)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9492 (Count: 148)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9287 (Count: 137)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9625 (Count: 796)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9898 (Count: 288)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9827 (Count: 171)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9606 (Count: 135)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9183 (Count: 320)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8378 (Count: 125)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8760 (Count: 287)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9463 (Count: 149)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9100 (Count: 276)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8813 (Count: 238)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9005 (Count: 222)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9559 (Count: 792)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9627 (Count: 162)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9642 (Count: 254)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 69.
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 69) ---
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9893
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9423 | Median: 0.9770 | Min: 0.2731
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.86% (356/9222)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0470
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9448 (Count: 161)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9706 (Count: 138)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9918 (Count: 151)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9599 (Count: 251)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9620 (Count: 162)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9847 (Count: 206)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9707 (Count: 139)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9381 (Count: 134)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8131 (Count: 143)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9730 (Count: 178)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8424 (Count: 144)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9816 (Count: 149)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9214 (Count: 167)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9710 (Count: 181)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9808 (Count: 182)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9450 (Count: 159)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9712 (Count: 789)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9649 (Count: 352)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9620 (Count: 154)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9276 (Count: 158)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9272 (Count: 222)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9688 (Count: 162)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9347 (Count: 141)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9492 (Count: 148)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9287 (Count: 137)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9625 (Count: 796)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9898 (Count: 288)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9827 (Count: 171)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9606 (Count: 135)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9183 (Count: 320)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8378 (Count: 125)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8760 (Count: 287)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9463 (Count: 149)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9100 (Count: 276)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8813 (Count: 238)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9005 (Count: 222)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9559 (Count: 792)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9627 (Count: 162)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9642 (Count: 254)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.model_checkpoint - Epoch 69: val_loss improved from 1.430506 to 1.375221.
2025-04-15 15:37:09 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 69)
2025-04-15 15:37:09 | INFO     | core.training.callbacks.model_checkpoint - Epoch 69: val_loss improved from 1.430506 to 1.375221.
2025-04-15 15:37:09 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 69)
2025-04-15 15:37:10 | INFO     | core.training.callbacks.early_stopping - Epoch 69: EarlyStopping val_loss improved from 1.430506 to 1.375221
2025-04-15 15:37:10 | INFO     | core.training.callbacks.early_stopping - Epoch 69: EarlyStopping val_loss improved from 1.430506 to 1.375221
2025-04-15 15:37:10 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 69: Captured validation outputs and targets for visualization.
2025-04-15 15:37:10 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 69: Captured validation outputs and targets for visualization.
2025-04-15 15:38:59 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:38:59 | INFO     | core.training.train - Epoch 70 [Fine-tuning] Train: Loss=3.4782, Acc=0.9359, Prec=0.9359, Rec=0.9359, F1=0.9359 (109.13s)
2025-04-15 15:39:07 | INFO     | core.training.train - Epoch 70 [Fine-tuning] Val:   Loss=1.3757, Acc=0.9873, Prec=0.9874, Rec=0.9873, F1=0.9873 (7.50s)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 70): Current confidence=0.9423, Change=+0.0062
2025-04-15 15:39:07 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 70): Current confidence=0.9423, Change=+0.0062
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 70.
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 70) ---
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9873
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9365 | Median: 0.9741 | Min: 0.1573
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.29% (396/9222)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0510
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9267 (Count: 160)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9335 (Count: 138)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9773 (Count: 151)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9469 (Count: 251)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9399 (Count: 161)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9561 (Count: 206)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9826 (Count: 140)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9494 (Count: 134)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8202 (Count: 143)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9750 (Count: 178)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8488 (Count: 145)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9657 (Count: 149)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9440 (Count: 168)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9466 (Count: 182)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9859 (Count: 182)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9627 (Count: 159)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9737 (Count: 789)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9732 (Count: 352)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9200 (Count: 153)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9449 (Count: 159)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9098 (Count: 222)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9367 (Count: 163)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9125 (Count: 139)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9084 (Count: 146)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9742 (Count: 139)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9717 (Count: 796)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9927 (Count: 288)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9827 (Count: 171)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9636 (Count: 135)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9054 (Count: 315)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8625 (Count: 127)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8673 (Count: 269)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8971 (Count: 149)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8833 (Count: 276)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9011 (Count: 244)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8263 (Count: 215)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9739 (Count: 796)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9307 (Count: 161)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9410 (Count: 254)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 70.
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 70) ---
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9873
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9365 | Median: 0.9741 | Min: 0.1573
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.29% (396/9222)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0510
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9267 (Count: 160)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9335 (Count: 138)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9773 (Count: 151)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9469 (Count: 251)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9399 (Count: 161)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9561 (Count: 206)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9826 (Count: 140)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9494 (Count: 134)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8202 (Count: 143)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9750 (Count: 178)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8488 (Count: 145)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9657 (Count: 149)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9440 (Count: 168)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9466 (Count: 182)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9859 (Count: 182)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9627 (Count: 159)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9737 (Count: 789)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9732 (Count: 352)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9200 (Count: 153)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9449 (Count: 159)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9098 (Count: 222)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9367 (Count: 163)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9125 (Count: 139)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9084 (Count: 146)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9742 (Count: 139)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9717 (Count: 796)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9927 (Count: 288)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9827 (Count: 171)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9636 (Count: 135)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9054 (Count: 315)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8625 (Count: 127)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8673 (Count: 269)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.8971 (Count: 149)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8833 (Count: 276)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9011 (Count: 244)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8263 (Count: 215)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9739 (Count: 796)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9307 (Count: 161)
2025-04-15 15:39:07 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9410 (Count: 254)
2025-04-15 15:39:07 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 15:39:07 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 15:39:07 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 70)
2025-04-15 15:39:08 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 70)
2025-04-15 15:39:08 | INFO     | core.training.callbacks.gradcam_callback - Generating GradCAM visualizations at epoch 70
2025-04-15 15:39:08 | INFO     | core.models.model_cbam18 - Using layer4[-1].conv2 as GradCAM target layer
2025-04-15 15:39:08 | INFO     | core.evaluation.interpretability - Using model's recommended GradCAM target layer
2025-04-15 15:39:08 | INFO     | core.evaluation.interpretability - GradCAM initialized with target layer: Conv2d
2025-04-15 15:39:25 | INFO     | core.training.callbacks.gradcam_callback - Generated summary HTML: outputs/cbam_only_resnet18_v2/gradcam/epoch_070/gradcam_summary.html
2025-04-15 15:39:25 | INFO     | core.training.callbacks.gradcam_callback - GradCAM visualizations saved to outputs/cbam_only_resnet18_v2/gradcam/epoch_070
2025-04-15 15:39:25 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 70: Captured validation outputs and targets for visualization.
2025-04-15 15:39:25 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 70: Captured validation outputs and targets for visualization.
2025-04-15 15:41:14 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:41:14 | INFO     | core.training.train - Epoch 71 [Fine-tuning] Train: Loss=3.4761, Acc=0.9363, Prec=0.9363, Rec=0.9363, F1=0.9363 (109.42s)
2025-04-15 15:41:22 | INFO     | core.training.train - Epoch 71 [Fine-tuning] Val:   Loss=1.4010, Acc=0.9863, Prec=0.9867, Rec=0.9863, F1=0.9863 (7.55s)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 71.
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 71) ---
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9863
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9370 | Median: 0.9748 | Min: 0.2692
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.68% (432/9222)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0493
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9381 (Count: 159)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9562 (Count: 138)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9879 (Count: 151)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9714 (Count: 251)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9457 (Count: 161)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9432 (Count: 206)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9678 (Count: 138)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9533 (Count: 134)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8425 (Count: 142)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9818 (Count: 178)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8739 (Count: 147)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9852 (Count: 150)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9123 (Count: 167)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9614 (Count: 182)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9869 (Count: 182)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9762 (Count: 159)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9671 (Count: 788)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9711 (Count: 352)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9023 (Count: 151)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8478 (Count: 157)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8941 (Count: 223)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9385 (Count: 161)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8998 (Count: 135)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9593 (Count: 149)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9346 (Count: 138)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9672 (Count: 795)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9778 (Count: 288)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9738 (Count: 171)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9717 (Count: 135)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9589 (Count: 325)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8404 (Count: 126)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9506 (Count: 294)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9703 (Count: 149)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8289 (Count: 262)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9189 (Count: 248)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8538 (Count: 207)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9638 (Count: 792)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9268 (Count: 161)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8607 (Count: 244)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 71.
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 71) ---
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9863
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9370 | Median: 0.9748 | Min: 0.2692
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.68% (432/9222)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0493
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9381 (Count: 159)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9562 (Count: 138)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9879 (Count: 151)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9714 (Count: 251)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9457 (Count: 161)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9432 (Count: 206)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9678 (Count: 138)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9533 (Count: 134)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8425 (Count: 142)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9818 (Count: 178)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8739 (Count: 147)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9852 (Count: 150)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9123 (Count: 167)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9614 (Count: 182)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9869 (Count: 182)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9762 (Count: 159)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9671 (Count: 788)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9711 (Count: 352)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9023 (Count: 151)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8478 (Count: 157)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8941 (Count: 223)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9385 (Count: 161)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8998 (Count: 135)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9593 (Count: 149)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9346 (Count: 138)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9672 (Count: 795)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9778 (Count: 288)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9738 (Count: 171)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9717 (Count: 135)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9589 (Count: 325)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8404 (Count: 126)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9506 (Count: 294)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9703 (Count: 149)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8289 (Count: 262)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9189 (Count: 248)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8538 (Count: 207)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9638 (Count: 792)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9268 (Count: 161)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.8607 (Count: 244)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 71)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 71)
2025-04-15 15:41:23 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 71: Captured validation outputs and targets for visualization.
2025-04-15 15:41:23 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 71: Captured validation outputs and targets for visualization.
2025-04-15 15:43:13 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:43:13 | INFO     | core.training.train - Epoch 72 [Fine-tuning] Train: Loss=3.3095, Acc=0.9397, Prec=0.9397, Rec=0.9397, F1=0.9397 (109.49s)
2025-04-15 15:43:20 | INFO     | core.training.train - Epoch 72 [Fine-tuning] Val:   Loss=1.3198, Acc=0.9892, Prec=0.9893, Rec=0.9892, F1=0.9891 (7.52s)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 72.
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 72) ---
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9892
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9439 | Median: 0.9764 | Min: 0.1868
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.47% (320/9222)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0454
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9314 (Count: 158)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9734 (Count: 138)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9868 (Count: 151)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9558 (Count: 251)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9422 (Count: 162)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9822 (Count: 206)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9541 (Count: 139)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9507 (Count: 134)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7824 (Count: 132)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9885 (Count: 179)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8818 (Count: 149)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9874 (Count: 150)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9624 (Count: 168)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9543 (Count: 180)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9673 (Count: 182)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9762 (Count: 159)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9760 (Count: 789)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9791 (Count: 352)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9372 (Count: 153)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9030 (Count: 157)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9487 (Count: 223)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9446 (Count: 163)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9368 (Count: 138)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9214 (Count: 144)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9403 (Count: 138)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9600 (Count: 795)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9619 (Count: 288)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9822 (Count: 171)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9830 (Count: 135)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9428 (Count: 321)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8757 (Count: 130)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9235 (Count: 294)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9538 (Count: 149)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8894 (Count: 272)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8975 (Count: 241)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8813 (Count: 220)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9624 (Count: 796)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9073 (Count: 161)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9669 (Count: 254)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 72.
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 72) ---
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9892
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9439 | Median: 0.9764 | Min: 0.1868
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.47% (320/9222)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0454
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9314 (Count: 158)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9734 (Count: 138)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9868 (Count: 151)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9558 (Count: 251)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9422 (Count: 162)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9822 (Count: 206)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9541 (Count: 139)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9507 (Count: 134)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7824 (Count: 132)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9885 (Count: 179)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8818 (Count: 149)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9874 (Count: 150)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9624 (Count: 168)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9543 (Count: 180)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9673 (Count: 182)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9762 (Count: 159)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9760 (Count: 789)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9791 (Count: 352)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9372 (Count: 153)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9030 (Count: 157)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9487 (Count: 223)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9446 (Count: 163)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9368 (Count: 138)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9214 (Count: 144)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9403 (Count: 138)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9600 (Count: 795)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9619 (Count: 288)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9822 (Count: 171)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9830 (Count: 135)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9428 (Count: 321)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8757 (Count: 130)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9235 (Count: 294)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9538 (Count: 149)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8894 (Count: 272)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8975 (Count: 241)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8813 (Count: 220)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9624 (Count: 796)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9073 (Count: 161)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9669 (Count: 254)
2025-04-15 15:43:21 | INFO     | core.training.callbacks.model_checkpoint - Epoch 72: val_loss improved from 1.375221 to 1.319786.
2025-04-15 15:43:21 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 72)
2025-04-15 15:43:22 | INFO     | core.training.callbacks.model_checkpoint - Epoch 72: val_loss improved from 1.375221 to 1.319786.
2025-04-15 15:43:22 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 72)
2025-04-15 15:43:22 | INFO     | core.training.callbacks.early_stopping - Epoch 72: EarlyStopping val_loss improved from 1.375221 to 1.319786
2025-04-15 15:43:22 | INFO     | core.training.callbacks.early_stopping - Epoch 72: EarlyStopping val_loss improved from 1.375221 to 1.319786
2025-04-15 15:43:22 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 72: Captured validation outputs and targets for visualization.
2025-04-15 15:43:22 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 72: Captured validation outputs and targets for visualization.
2025-04-15 15:45:12 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:45:12 | INFO     | core.training.train - Epoch 73 [Fine-tuning] Train: Loss=3.2240, Acc=0.9418, Prec=0.9417, Rec=0.9418, F1=0.9417 (109.77s)
2025-04-15 15:45:20 | INFO     | core.training.train - Epoch 73 [Fine-tuning] Val:   Loss=1.3175, Acc=0.9899, Prec=0.9900, Rec=0.9899, F1=0.9899 (7.48s)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 73.
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 73) ---
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9899
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9373 | Median: 0.9699 | Min: 0.1962
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.14% (382/9222)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0526
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9100 (Count: 159)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9760 (Count: 138)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9873 (Count: 151)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9553 (Count: 249)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9371 (Count: 158)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9851 (Count: 206)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9368 (Count: 136)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9547 (Count: 134)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8109 (Count: 144)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9624 (Count: 177)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8565 (Count: 147)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9636 (Count: 149)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9544 (Count: 168)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9570 (Count: 180)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9710 (Count: 182)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9501 (Count: 159)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9679 (Count: 788)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9701 (Count: 352)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9219 (Count: 152)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9395 (Count: 157)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9546 (Count: 222)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9169 (Count: 162)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8823 (Count: 138)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9015 (Count: 145)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9626 (Count: 138)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9352 (Count: 796)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9884 (Count: 288)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9906 (Count: 171)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9808 (Count: 135)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9483 (Count: 326)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8435 (Count: 132)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9104 (Count: 289)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9421 (Count: 150)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9235 (Count: 279)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8835 (Count: 244)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8980 (Count: 220)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9489 (Count: 792)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9230 (Count: 162)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9292 (Count: 254)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 73.
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 73) ---
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9899
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9373 | Median: 0.9699 | Min: 0.1962
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.14% (382/9222)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0526
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9100 (Count: 159)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9760 (Count: 138)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9873 (Count: 151)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9553 (Count: 249)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9371 (Count: 158)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9851 (Count: 206)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9368 (Count: 136)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9547 (Count: 134)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8109 (Count: 144)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9624 (Count: 177)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8565 (Count: 147)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9636 (Count: 149)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9544 (Count: 168)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9570 (Count: 180)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9710 (Count: 182)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9501 (Count: 159)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9679 (Count: 788)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9701 (Count: 352)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9219 (Count: 152)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9395 (Count: 157)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9546 (Count: 222)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9169 (Count: 162)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8823 (Count: 138)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9015 (Count: 145)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9626 (Count: 138)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9352 (Count: 796)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9884 (Count: 288)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9906 (Count: 171)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9808 (Count: 135)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9483 (Count: 326)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8435 (Count: 132)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9104 (Count: 289)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9421 (Count: 150)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9235 (Count: 279)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8835 (Count: 244)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8980 (Count: 220)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9489 (Count: 792)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9230 (Count: 162)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9292 (Count: 254)
2025-04-15 15:45:20 | INFO     | core.training.callbacks.model_checkpoint - Epoch 73: val_loss improved from 1.319786 to 1.317474.
2025-04-15 15:45:20 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 73)
2025-04-15 15:45:21 | INFO     | core.training.callbacks.model_checkpoint - Epoch 73: val_loss improved from 1.319786 to 1.317474.
2025-04-15 15:45:21 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 73)
2025-04-15 15:45:21 | INFO     | core.training.callbacks.early_stopping - Epoch 73: EarlyStopping val_loss improved from 1.319786 to 1.317474
2025-04-15 15:45:21 | INFO     | core.training.callbacks.early_stopping - Epoch 73: EarlyStopping val_loss improved from 1.319786 to 1.317474
2025-04-15 15:45:21 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 73: Captured validation outputs and targets for visualization.
2025-04-15 15:45:21 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 73: Captured validation outputs and targets for visualization.
2025-04-15 15:47:11 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:47:11 | INFO     | core.training.train - Epoch 74 [Fine-tuning] Train: Loss=3.1437, Acc=0.9429, Prec=0.9429, Rec=0.9429, F1=0.9429 (110.15s)
2025-04-15 15:47:19 | INFO     | core.training.train - Epoch 74 [Fine-tuning] Val:   Loss=1.3193, Acc=0.9895, Prec=0.9896, Rec=0.9895, F1=0.9895 (7.61s)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 74.
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 74) ---
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9895
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9420 | Median: 0.9733 | Min: 0.1947
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.58% (330/9222)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0476
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9445 (Count: 161)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9646 (Count: 138)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9833 (Count: 151)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9304 (Count: 247)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9405 (Count: 160)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9903 (Count: 206)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9726 (Count: 140)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9683 (Count: 134)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8397 (Count: 143)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9768 (Count: 177)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8696 (Count: 146)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9772 (Count: 149)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9485 (Count: 168)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9477 (Count: 180)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9672 (Count: 182)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9728 (Count: 159)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9688 (Count: 789)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9733 (Count: 352)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8842 (Count: 152)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9439 (Count: 159)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9242 (Count: 223)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9206 (Count: 161)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9199 (Count: 140)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9549 (Count: 149)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9687 (Count: 139)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9752 (Count: 797)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9850 (Count: 288)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9816 (Count: 170)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9434 (Count: 135)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9155 (Count: 321)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8709 (Count: 124)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9074 (Count: 289)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9186 (Count: 148)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9362 (Count: 281)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9170 (Count: 244)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8267 (Count: 211)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9486 (Count: 796)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9713 (Count: 162)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9524 (Count: 254)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 74.
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 74) ---
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9895
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9420 | Median: 0.9733 | Min: 0.1947
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.58% (330/9222)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0476
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9445 (Count: 161)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9646 (Count: 138)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9833 (Count: 151)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9304 (Count: 247)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9405 (Count: 160)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9903 (Count: 206)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9726 (Count: 140)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9683 (Count: 134)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8397 (Count: 143)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9768 (Count: 177)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8696 (Count: 146)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9772 (Count: 149)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9485 (Count: 168)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9477 (Count: 180)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9672 (Count: 182)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9728 (Count: 159)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9688 (Count: 789)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9733 (Count: 352)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8842 (Count: 152)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9439 (Count: 159)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9242 (Count: 223)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9206 (Count: 161)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9199 (Count: 140)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9549 (Count: 149)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9687 (Count: 139)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9752 (Count: 797)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9850 (Count: 288)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9816 (Count: 170)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9434 (Count: 135)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9155 (Count: 321)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8709 (Count: 124)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9074 (Count: 289)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9186 (Count: 148)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9362 (Count: 281)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9170 (Count: 244)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8267 (Count: 211)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9486 (Count: 796)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9713 (Count: 162)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9524 (Count: 254)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 74)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 74)
2025-04-15 15:47:20 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 74: Captured validation outputs and targets for visualization.
2025-04-15 15:47:20 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 74: Captured validation outputs and targets for visualization.
2025-04-15 15:49:12 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:49:12 | INFO     | core.training.train - Epoch 75 [Fine-tuning] Train: Loss=3.1120, Acc=0.9447, Prec=0.9447, Rec=0.9447, F1=0.9447 (111.83s)
2025-04-15 15:49:20 | INFO     | core.training.train - Epoch 75 [Fine-tuning] Val:   Loss=1.3175, Acc=0.9883, Prec=0.9885, Rec=0.9883, F1=0.9883 (7.79s)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 75): Current confidence=0.9420, Change=+0.0046
2025-04-15 15:49:20 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 75): Current confidence=0.9420, Change=+0.0046
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 75.
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 75) ---
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9883
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9332 | Median: 0.9666 | Min: 0.1991
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.10% (378/9222)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0553
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9221 (Count: 158)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9525 (Count: 137)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9748 (Count: 151)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9558 (Count: 249)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9448 (Count: 157)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9750 (Count: 206)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9689 (Count: 137)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9628 (Count: 134)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8114 (Count: 144)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9789 (Count: 178)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8820 (Count: 147)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9814 (Count: 149)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9397 (Count: 167)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9272 (Count: 180)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9845 (Count: 182)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9557 (Count: 159)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9420 (Count: 788)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9611 (Count: 351)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9473 (Count: 153)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9375 (Count: 157)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9723 (Count: 223)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9572 (Count: 163)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9416 (Count: 140)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8991 (Count: 146)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9607 (Count: 137)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9281 (Count: 791)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9807 (Count: 288)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9744 (Count: 170)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9154 (Count: 134)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9220 (Count: 324)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8379 (Count: 129)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9068 (Count: 292)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9510 (Count: 148)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8937 (Count: 270)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8632 (Count: 244)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8652 (Count: 220)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9491 (Count: 795)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9498 (Count: 162)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9697 (Count: 254)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 75.
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 75) ---
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9883
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9332 | Median: 0.9666 | Min: 0.1991
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    4.10% (378/9222)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0553
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9221 (Count: 158)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9525 (Count: 137)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9748 (Count: 151)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9558 (Count: 249)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9448 (Count: 157)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9750 (Count: 206)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9689 (Count: 137)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9628 (Count: 134)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8114 (Count: 144)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9789 (Count: 178)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8820 (Count: 147)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9814 (Count: 149)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9397 (Count: 167)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9272 (Count: 180)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9845 (Count: 182)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9557 (Count: 159)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9420 (Count: 788)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9611 (Count: 351)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9473 (Count: 153)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9375 (Count: 157)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9723 (Count: 223)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9572 (Count: 163)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9416 (Count: 140)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8991 (Count: 146)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9607 (Count: 137)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9281 (Count: 791)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9807 (Count: 288)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9744 (Count: 170)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9154 (Count: 134)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9220 (Count: 324)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8379 (Count: 129)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9068 (Count: 292)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9510 (Count: 148)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8937 (Count: 270)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8632 (Count: 244)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8652 (Count: 220)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9491 (Count: 795)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9498 (Count: 162)
2025-04-15 15:49:20 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9697 (Count: 254)
2025-04-15 15:49:20 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 15:49:21 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 15:49:21 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 75)
2025-04-15 15:49:21 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 75)
2025-04-15 15:49:21 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 75: Captured validation outputs and targets for visualization.
2025-04-15 15:49:21 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 75: Captured validation outputs and targets for visualization.
2025-04-15 15:51:15 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:51:15 | INFO     | core.training.train - Epoch 76 [Fine-tuning] Train: Loss=3.0613, Acc=0.9448, Prec=0.9448, Rec=0.9448, F1=0.9448 (114.05s)
2025-04-15 15:51:23 | INFO     | core.training.train - Epoch 76 [Fine-tuning] Val:   Loss=1.2625, Acc=0.9903, Prec=0.9904, Rec=0.9903, F1=0.9903 (7.82s)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 76.
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 76) ---
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9903
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9418 | Median: 0.9718 | Min: 0.2121
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.36% (310/9222)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0491
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9465 (Count: 162)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9484 (Count: 138)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9931 (Count: 151)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9637 (Count: 250)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9562 (Count: 162)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9887 (Count: 206)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9723 (Count: 139)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9749 (Count: 134)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8106 (Count: 137)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9874 (Count: 178)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8823 (Count: 151)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9803 (Count: 150)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9193 (Count: 168)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9322 (Count: 182)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9442 (Count: 181)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9780 (Count: 159)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9618 (Count: 789)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9767 (Count: 351)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9210 (Count: 152)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9435 (Count: 159)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9590 (Count: 223)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9322 (Count: 163)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9220 (Count: 138)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9089 (Count: 148)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9125 (Count: 133)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9569 (Count: 795)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9864 (Count: 288)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9732 (Count: 171)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9642 (Count: 135)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9012 (Count: 321)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8779 (Count: 133)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9123 (Count: 287)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9557 (Count: 149)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9568 (Count: 282)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9200 (Count: 246)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8302 (Count: 210)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9496 (Count: 796)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9393 (Count: 162)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9688 (Count: 254)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 76.
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 76) ---
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9903
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9418 | Median: 0.9718 | Min: 0.2121
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.36% (310/9222)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0491
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9465 (Count: 162)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9484 (Count: 138)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9931 (Count: 151)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9637 (Count: 250)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9562 (Count: 162)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9887 (Count: 206)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9723 (Count: 139)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9749 (Count: 134)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8106 (Count: 137)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9874 (Count: 178)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8823 (Count: 151)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9803 (Count: 150)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9193 (Count: 168)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9322 (Count: 182)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9442 (Count: 181)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9780 (Count: 159)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9618 (Count: 789)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9767 (Count: 351)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9210 (Count: 152)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9435 (Count: 159)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9590 (Count: 223)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9322 (Count: 163)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9220 (Count: 138)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9089 (Count: 148)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9125 (Count: 133)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9569 (Count: 795)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9864 (Count: 288)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9732 (Count: 171)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9642 (Count: 135)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9012 (Count: 321)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8779 (Count: 133)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9123 (Count: 287)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9557 (Count: 149)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9568 (Count: 282)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9200 (Count: 246)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8302 (Count: 210)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9496 (Count: 796)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9393 (Count: 162)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9688 (Count: 254)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.model_checkpoint - Epoch 76: val_loss improved from 1.317474 to 1.262476.
2025-04-15 15:51:24 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 76)
2025-04-15 15:51:24 | INFO     | core.training.callbacks.model_checkpoint - Epoch 76: val_loss improved from 1.317474 to 1.262476.
2025-04-15 15:51:25 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 76)
2025-04-15 15:51:25 | INFO     | core.training.callbacks.early_stopping - Epoch 76: EarlyStopping val_loss improved from 1.317474 to 1.262476
2025-04-15 15:51:25 | INFO     | core.training.callbacks.early_stopping - Epoch 76: EarlyStopping val_loss improved from 1.317474 to 1.262476
2025-04-15 15:51:25 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 76: Captured validation outputs and targets for visualization.
2025-04-15 15:51:25 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 76: Captured validation outputs and targets for visualization.
2025-04-15 15:53:17 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:53:17 | INFO     | core.training.train - Epoch 77 [Fine-tuning] Train: Loss=2.9899, Acc=0.9471, Prec=0.9471, Rec=0.9471, F1=0.9471 (112.45s)
2025-04-15 15:53:26 | INFO     | core.training.train - Epoch 77 [Fine-tuning] Val:   Loss=1.2678, Acc=0.9900, Prec=0.9903, Rec=0.9900, F1=0.9901 (8.17s)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 77.
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 77) ---
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9900
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9456 | Median: 0.9756 | Min: 0.2135
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.31% (305/9222)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0446
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9657 (Count: 160)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9793 (Count: 138)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9928 (Count: 151)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9462 (Count: 251)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9532 (Count: 161)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9785 (Count: 206)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9747 (Count: 140)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9726 (Count: 134)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8364 (Count: 137)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9834 (Count: 178)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8992 (Count: 150)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9743 (Count: 149)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9520 (Count: 168)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9530 (Count: 181)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9480 (Count: 181)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9780 (Count: 159)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9748 (Count: 789)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9831 (Count: 352)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9098 (Count: 154)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9467 (Count: 159)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9509 (Count: 223)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9589 (Count: 163)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9184 (Count: 139)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9251 (Count: 144)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9333 (Count: 137)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9595 (Count: 795)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9923 (Count: 288)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9791 (Count: 170)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9462 (Count: 135)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9660 (Count: 326)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9231 (Count: 138)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8871 (Count: 289)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9314 (Count: 148)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9108 (Count: 279)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9098 (Count: 245)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8555 (Count: 214)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9502 (Count: 783)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9200 (Count: 162)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9577 (Count: 254)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 77.
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 77) ---
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9900
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9456 | Median: 0.9756 | Min: 0.2135
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.31% (305/9222)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0446
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9657 (Count: 160)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9793 (Count: 138)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9928 (Count: 151)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9462 (Count: 251)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9532 (Count: 161)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9785 (Count: 206)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9747 (Count: 140)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9726 (Count: 134)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8364 (Count: 137)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9834 (Count: 178)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8992 (Count: 150)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9743 (Count: 149)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9520 (Count: 168)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9530 (Count: 181)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9480 (Count: 181)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9780 (Count: 159)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9748 (Count: 789)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9831 (Count: 352)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9098 (Count: 154)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9467 (Count: 159)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9509 (Count: 223)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9589 (Count: 163)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9184 (Count: 139)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9251 (Count: 144)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9333 (Count: 137)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9595 (Count: 795)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9923 (Count: 288)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9791 (Count: 170)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9462 (Count: 135)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9660 (Count: 326)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9231 (Count: 138)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8871 (Count: 289)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9314 (Count: 148)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9108 (Count: 279)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9098 (Count: 245)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8555 (Count: 214)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9502 (Count: 783)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9200 (Count: 162)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9577 (Count: 254)
2025-04-15 15:53:26 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 77)
2025-04-15 15:53:27 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 77)
2025-04-15 15:53:27 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 77: Captured validation outputs and targets for visualization.
2025-04-15 15:53:27 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 77: Captured validation outputs and targets for visualization.
2025-04-15 15:55:19 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:55:19 | INFO     | core.training.train - Epoch 78 [Fine-tuning] Train: Loss=2.9377, Acc=0.9500, Prec=0.9500, Rec=0.9500, F1=0.9500 (112.68s)
2025-04-15 15:55:27 | INFO     | core.training.train - Epoch 78 [Fine-tuning] Val:   Loss=1.2354, Acc=0.9924, Prec=0.9925, Rec=0.9924, F1=0.9924 (7.69s)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 78.
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 78) ---
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9924
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9462 | Median: 0.9750 | Min: 0.2719
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.84% (262/9222)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0462
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9496 (Count: 160)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9784 (Count: 138)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9886 (Count: 151)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9691 (Count: 250)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9586 (Count: 162)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9861 (Count: 206)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9663 (Count: 140)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9440 (Count: 134)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8654 (Count: 147)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9766 (Count: 178)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8625 (Count: 144)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9822 (Count: 150)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9300 (Count: 167)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9486 (Count: 182)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9394 (Count: 181)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9612 (Count: 159)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9512 (Count: 788)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9675 (Count: 352)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9339 (Count: 153)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9453 (Count: 159)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9329 (Count: 223)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9381 (Count: 162)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9081 (Count: 139)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9316 (Count: 147)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9755 (Count: 139)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9745 (Count: 796)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9871 (Count: 288)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9757 (Count: 170)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9370 (Count: 133)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9080 (Count: 319)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8636 (Count: 135)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9524 (Count: 293)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9592 (Count: 150)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9304 (Count: 279)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8872 (Count: 245)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9210 (Count: 223)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9690 (Count: 797)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9479 (Count: 162)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9193 (Count: 251)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 78.
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 78) ---
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9924
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9462 | Median: 0.9750 | Min: 0.2719
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.84% (262/9222)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0462
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9496 (Count: 160)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9784 (Count: 138)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9886 (Count: 151)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9691 (Count: 250)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9586 (Count: 162)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9861 (Count: 206)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9663 (Count: 140)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9440 (Count: 134)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8654 (Count: 147)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9766 (Count: 178)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8625 (Count: 144)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9822 (Count: 150)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9300 (Count: 167)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9486 (Count: 182)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9394 (Count: 181)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9612 (Count: 159)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9512 (Count: 788)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9675 (Count: 352)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9339 (Count: 153)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9453 (Count: 159)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9329 (Count: 223)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9381 (Count: 162)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9081 (Count: 139)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9316 (Count: 147)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9755 (Count: 139)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9745 (Count: 796)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9871 (Count: 288)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9757 (Count: 170)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9370 (Count: 133)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9080 (Count: 319)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8636 (Count: 135)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9524 (Count: 293)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9592 (Count: 150)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9304 (Count: 279)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8872 (Count: 245)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9210 (Count: 223)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9690 (Count: 797)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9479 (Count: 162)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9193 (Count: 251)
2025-04-15 15:55:28 | INFO     | core.training.callbacks.model_checkpoint - Epoch 78: val_loss improved from 1.262476 to 1.235449.
2025-04-15 15:55:28 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 78)
2025-04-15 15:55:29 | INFO     | core.training.callbacks.model_checkpoint - Epoch 78: val_loss improved from 1.262476 to 1.235449.
2025-04-15 15:55:29 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 78)
2025-04-15 15:55:29 | INFO     | core.training.callbacks.early_stopping - Epoch 78: EarlyStopping val_loss improved from 1.262476 to 1.235449
2025-04-15 15:55:29 | INFO     | core.training.callbacks.early_stopping - Epoch 78: EarlyStopping val_loss improved from 1.262476 to 1.235449
2025-04-15 15:55:29 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 78: Captured validation outputs and targets for visualization.
2025-04-15 15:55:29 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 78: Captured validation outputs and targets for visualization.
2025-04-15 15:57:21 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:57:21 | INFO     | core.training.train - Epoch 79 [Fine-tuning] Train: Loss=2.8388, Acc=0.9506, Prec=0.9506, Rec=0.9506, F1=0.9506 (112.43s)
2025-04-15 15:57:30 | INFO     | core.training.train - Epoch 79 [Fine-tuning] Val:   Loss=1.2519, Acc=0.9893, Prec=0.9894, Rec=0.9893, F1=0.9893 (7.96s)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 79.
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 79) ---
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9893
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9402 | Median: 0.9699 | Min: 0.2836
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.39% (313/9222)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0491
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9304 (Count: 161)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9428 (Count: 135)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9398 (Count: 151)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9309 (Count: 250)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9607 (Count: 161)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9743 (Count: 206)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9660 (Count: 140)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9484 (Count: 134)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8608 (Count: 136)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9839 (Count: 178)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8924 (Count: 143)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9691 (Count: 149)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9434 (Count: 168)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9632 (Count: 182)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9588 (Count: 182)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9440 (Count: 159)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9561 (Count: 788)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9629 (Count: 350)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9038 (Count: 153)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9519 (Count: 159)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9453 (Count: 223)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9572 (Count: 162)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8732 (Count: 135)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9486 (Count: 147)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9628 (Count: 139)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9460 (Count: 793)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9795 (Count: 288)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9824 (Count: 170)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9532 (Count: 135)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9318 (Count: 323)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9115 (Count: 136)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9209 (Count: 292)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9606 (Count: 150)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9019 (Count: 278)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8914 (Count: 245)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9245 (Count: 223)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9605 (Count: 783)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9518 (Count: 162)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9369 (Count: 254)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 79.
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 79) ---
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9893
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9402 | Median: 0.9699 | Min: 0.2836
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.39% (313/9222)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0491
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9304 (Count: 161)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9428 (Count: 135)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9398 (Count: 151)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9309 (Count: 250)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9607 (Count: 161)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9743 (Count: 206)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9660 (Count: 140)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9484 (Count: 134)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8608 (Count: 136)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9839 (Count: 178)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8924 (Count: 143)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9691 (Count: 149)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9434 (Count: 168)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9632 (Count: 182)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9588 (Count: 182)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9440 (Count: 159)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9561 (Count: 788)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9629 (Count: 350)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9038 (Count: 153)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9519 (Count: 159)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9453 (Count: 223)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9572 (Count: 162)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8732 (Count: 135)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9486 (Count: 147)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9628 (Count: 139)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9460 (Count: 793)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9795 (Count: 288)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9824 (Count: 170)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9532 (Count: 135)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9318 (Count: 323)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9115 (Count: 136)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9209 (Count: 292)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9606 (Count: 150)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9019 (Count: 278)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8914 (Count: 245)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9245 (Count: 223)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9605 (Count: 783)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9518 (Count: 162)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9369 (Count: 254)
2025-04-15 15:57:30 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 79)
2025-04-15 15:57:31 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 79)
2025-04-15 15:57:31 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 79: Captured validation outputs and targets for visualization.
2025-04-15 15:57:31 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 79: Captured validation outputs and targets for visualization.
2025-04-15 15:59:24 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 15:59:24 | INFO     | core.training.train - Epoch 80 [Fine-tuning] Train: Loss=2.7870, Acc=0.9521, Prec=0.9521, Rec=0.9521, F1=0.9521 (113.43s)
2025-04-15 15:59:32 | INFO     | core.training.train - Epoch 80 [Fine-tuning] Val:   Loss=1.2193, Acc=0.9918, Prec=0.9918, Rec=0.9918, F1=0.9917 (8.00s)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 80): Current confidence=0.9402, Change=-0.0060
2025-04-15 15:59:33 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 80): Current confidence=0.9402, Change=-0.0060
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 80.
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 80) ---
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9918
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9439 | Median: 0.9731 | Min: 0.1974
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.17% (292/9222)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0480
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9450 (Count: 160)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9787 (Count: 138)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9849 (Count: 151)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9314 (Count: 250)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9360 (Count: 162)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9818 (Count: 206)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9678 (Count: 139)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9602 (Count: 134)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8118 (Count: 144)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9834 (Count: 178)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8688 (Count: 150)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9756 (Count: 149)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9236 (Count: 167)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9694 (Count: 182)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9513 (Count: 182)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9776 (Count: 159)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9580 (Count: 789)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9724 (Count: 352)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9215 (Count: 152)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9474 (Count: 159)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9552 (Count: 223)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9376 (Count: 163)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9241 (Count: 137)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9206 (Count: 146)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9526 (Count: 139)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9580 (Count: 796)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9921 (Count: 288)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9705 (Count: 170)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9553 (Count: 134)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9484 (Count: 325)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8527 (Count: 129)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9418 (Count: 294)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9583 (Count: 151)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9191 (Count: 280)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8721 (Count: 242)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9029 (Count: 216)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9656 (Count: 797)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9620 (Count: 162)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9249 (Count: 251)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 80.
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 80) ---
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9918
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9439 | Median: 0.9731 | Min: 0.1974
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.17% (292/9222)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0480
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9450 (Count: 160)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9787 (Count: 138)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9849 (Count: 151)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9314 (Count: 250)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9360 (Count: 162)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9818 (Count: 206)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9678 (Count: 139)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9602 (Count: 134)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8118 (Count: 144)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9834 (Count: 178)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8688 (Count: 150)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9756 (Count: 149)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9236 (Count: 167)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9694 (Count: 182)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9513 (Count: 182)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9776 (Count: 159)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9580 (Count: 789)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9724 (Count: 352)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9215 (Count: 152)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9474 (Count: 159)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9552 (Count: 223)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9376 (Count: 163)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9241 (Count: 137)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9206 (Count: 146)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9526 (Count: 139)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9580 (Count: 796)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9921 (Count: 288)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9705 (Count: 170)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9553 (Count: 134)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9484 (Count: 325)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8527 (Count: 129)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9418 (Count: 294)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9583 (Count: 151)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9191 (Count: 280)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8721 (Count: 242)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9029 (Count: 216)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9656 (Count: 797)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9620 (Count: 162)
2025-04-15 15:59:33 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9249 (Count: 251)
2025-04-15 15:59:33 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 15:59:33 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 15:59:33 | INFO     | core.training.callbacks.model_checkpoint - Epoch 80: val_loss improved from 1.235449 to 1.219335.
2025-04-15 15:59:33 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 80)
2025-04-15 15:59:34 | INFO     | core.training.callbacks.model_checkpoint - Epoch 80: val_loss improved from 1.235449 to 1.219335.
2025-04-15 15:59:34 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 80)
2025-04-15 15:59:34 | INFO     | core.training.callbacks.early_stopping - Epoch 80: EarlyStopping val_loss improved from 1.235449 to 1.219335
2025-04-15 15:59:34 | INFO     | core.training.callbacks.early_stopping - Epoch 80: EarlyStopping val_loss improved from 1.235449 to 1.219335
2025-04-15 15:59:34 | INFO     | core.training.callbacks.gradcam_callback - Generating GradCAM visualizations at epoch 80
2025-04-15 15:59:34 | INFO     | core.models.model_cbam18 - Using layer4[-1].conv2 as GradCAM target layer
2025-04-15 15:59:34 | INFO     | core.evaluation.interpretability - Using model's recommended GradCAM target layer
2025-04-15 15:59:34 | INFO     | core.evaluation.interpretability - GradCAM initialized with target layer: Conv2d
2025-04-15 15:59:52 | INFO     | core.training.callbacks.gradcam_callback - Generated summary HTML: outputs/cbam_only_resnet18_v2/gradcam/epoch_080/gradcam_summary.html
2025-04-15 15:59:52 | INFO     | core.training.callbacks.gradcam_callback - GradCAM visualizations saved to outputs/cbam_only_resnet18_v2/gradcam/epoch_080
2025-04-15 15:59:52 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 80: Captured validation outputs and targets for visualization.
2025-04-15 15:59:52 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 80: Captured validation outputs and targets for visualization.
2025-04-15 16:01:46 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:01:46 | INFO     | core.training.train - Epoch 81 [Fine-tuning] Train: Loss=2.7782, Acc=0.9516, Prec=0.9516, Rec=0.9516, F1=0.9516 (113.71s)
2025-04-15 16:01:54 | INFO     | core.training.train - Epoch 81 [Fine-tuning] Val:   Loss=1.2312, Acc=0.9918, Prec=0.9919, Rec=0.9918, F1=0.9918 (7.66s)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 81.
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 81) ---
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9918
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9470 | Median: 0.9740 | Min: 0.2613
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.84% (262/9222)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0449
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9439 (Count: 160)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9732 (Count: 138)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9805 (Count: 150)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9734 (Count: 251)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9066 (Count: 161)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9746 (Count: 206)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9698 (Count: 140)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9697 (Count: 134)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8342 (Count: 135)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9873 (Count: 178)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.9061 (Count: 151)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9787 (Count: 149)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9583 (Count: 168)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9454 (Count: 182)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9486 (Count: 182)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9777 (Count: 159)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9648 (Count: 789)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9792 (Count: 352)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9353 (Count: 153)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9112 (Count: 159)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9440 (Count: 223)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9371 (Count: 162)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9101 (Count: 140)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9530 (Count: 147)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9646 (Count: 139)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9805 (Count: 796)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9889 (Count: 288)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9659 (Count: 171)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9600 (Count: 135)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9454 (Count: 322)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9100 (Count: 132)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9223 (Count: 292)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9452 (Count: 151)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9456 (Count: 281)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8861 (Count: 244)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9219 (Count: 218)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9350 (Count: 795)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9830 (Count: 162)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9030 (Count: 251)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 81.
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 81) ---
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9918
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9470 | Median: 0.9740 | Min: 0.2613
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.84% (262/9222)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0449
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9439 (Count: 160)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9732 (Count: 138)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9805 (Count: 150)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9734 (Count: 251)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9066 (Count: 161)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9746 (Count: 206)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9698 (Count: 140)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9697 (Count: 134)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8342 (Count: 135)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9873 (Count: 178)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.9061 (Count: 151)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9787 (Count: 149)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9583 (Count: 168)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9454 (Count: 182)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9486 (Count: 182)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9777 (Count: 159)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9648 (Count: 789)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9792 (Count: 352)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9353 (Count: 153)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9112 (Count: 159)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9440 (Count: 223)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9371 (Count: 162)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9101 (Count: 140)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9530 (Count: 147)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9646 (Count: 139)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9805 (Count: 796)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9889 (Count: 288)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9659 (Count: 171)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9600 (Count: 135)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9454 (Count: 322)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9100 (Count: 132)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9223 (Count: 292)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9452 (Count: 151)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9456 (Count: 281)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8861 (Count: 244)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9219 (Count: 218)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9350 (Count: 795)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9830 (Count: 162)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9030 (Count: 251)
2025-04-15 16:01:54 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 81)
2025-04-15 16:01:55 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 81)
2025-04-15 16:01:55 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 81: Captured validation outputs and targets for visualization.
2025-04-15 16:01:55 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 81: Captured validation outputs and targets for visualization.
2025-04-15 16:03:47 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:03:47 | INFO     | core.training.train - Epoch 82 [Fine-tuning] Train: Loss=2.7508, Acc=0.9521, Prec=0.9521, Rec=0.9521, F1=0.9521 (111.96s)
2025-04-15 16:03:55 | INFO     | core.training.train - Epoch 82 [Fine-tuning] Val:   Loss=1.2418, Acc=0.9902, Prec=0.9903, Rec=0.9902, F1=0.9902 (7.80s)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 82.
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 82) ---
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9902
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9400 | Median: 0.9688 | Min: 0.2616
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.21% (296/9222)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0503
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9601 (Count: 160)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9715 (Count: 138)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9839 (Count: 151)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9597 (Count: 252)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9301 (Count: 161)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9556 (Count: 206)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9802 (Count: 140)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9377 (Count: 134)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8340 (Count: 142)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9868 (Count: 179)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8715 (Count: 147)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9753 (Count: 150)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9559 (Count: 167)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9607 (Count: 181)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9433 (Count: 182)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9549 (Count: 159)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9611 (Count: 789)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9714 (Count: 351)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9340 (Count: 152)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9557 (Count: 158)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8668 (Count: 219)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9640 (Count: 163)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8995 (Count: 138)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8986 (Count: 145)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9619 (Count: 139)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9663 (Count: 795)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9933 (Count: 288)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9799 (Count: 169)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9401 (Count: 134)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9408 (Count: 326)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8667 (Count: 131)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9415 (Count: 291)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9520 (Count: 149)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8800 (Count: 270)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9196 (Count: 245)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9119 (Count: 223)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9298 (Count: 792)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9401 (Count: 162)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9449 (Count: 254)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 82.
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 82) ---
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9902
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9400 | Median: 0.9688 | Min: 0.2616
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.21% (296/9222)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0503
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9601 (Count: 160)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9715 (Count: 138)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9839 (Count: 151)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9597 (Count: 252)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9301 (Count: 161)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9556 (Count: 206)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9802 (Count: 140)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9377 (Count: 134)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8340 (Count: 142)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9868 (Count: 179)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8715 (Count: 147)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9753 (Count: 150)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9559 (Count: 167)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9607 (Count: 181)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9433 (Count: 182)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9549 (Count: 159)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9611 (Count: 789)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9714 (Count: 351)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9340 (Count: 152)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9557 (Count: 158)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.8668 (Count: 219)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9640 (Count: 163)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8995 (Count: 138)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8986 (Count: 145)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9619 (Count: 139)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9663 (Count: 795)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9933 (Count: 288)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9799 (Count: 169)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9401 (Count: 134)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9408 (Count: 326)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8667 (Count: 131)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9415 (Count: 291)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9520 (Count: 149)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8800 (Count: 270)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9196 (Count: 245)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9119 (Count: 223)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9298 (Count: 792)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9401 (Count: 162)
2025-04-15 16:03:55 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9449 (Count: 254)
2025-04-15 16:03:56 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 82)
2025-04-15 16:03:56 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 82)
2025-04-15 16:03:56 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 82: Captured validation outputs and targets for visualization.
2025-04-15 16:03:56 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 82: Captured validation outputs and targets for visualization.
2025-04-15 16:05:48 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:05:48 | INFO     | core.training.train - Epoch 83 [Fine-tuning] Train: Loss=2.7141, Acc=0.9541, Prec=0.9541, Rec=0.9541, F1=0.9541 (111.98s)
2025-04-15 16:05:56 | INFO     | core.training.train - Epoch 83 [Fine-tuning] Val:   Loss=1.1802, Acc=0.9925, Prec=0.9926, Rec=0.9925, F1=0.9925 (7.85s)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 83.
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 83) ---
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9925
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9476 | Median: 0.9724 | Min: 0.2240
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.54% (234/9222)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0450
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9680 (Count: 160)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9793 (Count: 138)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9784 (Count: 151)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9509 (Count: 249)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9366 (Count: 159)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9819 (Count: 206)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9885 (Count: 140)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9472 (Count: 134)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8458 (Count: 142)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9842 (Count: 178)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8805 (Count: 148)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9559 (Count: 150)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9557 (Count: 168)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9525 (Count: 181)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9696 (Count: 182)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9484 (Count: 159)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9635 (Count: 789)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9475 (Count: 352)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9260 (Count: 153)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9645 (Count: 159)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9540 (Count: 223)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9375 (Count: 161)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9374 (Count: 139)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9153 (Count: 149)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9719 (Count: 139)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9700 (Count: 795)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9913 (Count: 288)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9733 (Count: 170)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9746 (Count: 135)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9406 (Count: 326)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8525 (Count: 132)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9421 (Count: 293)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9716 (Count: 150)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9267 (Count: 282)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9248 (Count: 246)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9251 (Count: 220)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9409 (Count: 795)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9592 (Count: 162)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9359 (Count: 250)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 83.
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 83) ---
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9925
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9476 | Median: 0.9724 | Min: 0.2240
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.54% (234/9222)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0450
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9680 (Count: 160)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9793 (Count: 138)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9784 (Count: 151)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9509 (Count: 249)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9366 (Count: 159)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9819 (Count: 206)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9885 (Count: 140)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9472 (Count: 134)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8458 (Count: 142)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9842 (Count: 178)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8805 (Count: 148)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9559 (Count: 150)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9557 (Count: 168)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9525 (Count: 181)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9696 (Count: 182)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9484 (Count: 159)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9635 (Count: 789)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9475 (Count: 352)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9260 (Count: 153)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9645 (Count: 159)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9540 (Count: 223)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9375 (Count: 161)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9374 (Count: 139)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9153 (Count: 149)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9719 (Count: 139)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9700 (Count: 795)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9913 (Count: 288)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9733 (Count: 170)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9746 (Count: 135)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9406 (Count: 326)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8525 (Count: 132)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9421 (Count: 293)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9716 (Count: 150)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9267 (Count: 282)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9248 (Count: 246)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9251 (Count: 220)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9409 (Count: 795)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9592 (Count: 162)
2025-04-15 16:05:56 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9359 (Count: 250)
2025-04-15 16:05:57 | INFO     | core.training.callbacks.model_checkpoint - Epoch 83: val_loss improved from 1.219335 to 1.180153.
2025-04-15 16:05:57 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 83)
2025-04-15 16:05:57 | INFO     | core.training.callbacks.model_checkpoint - Epoch 83: val_loss improved from 1.219335 to 1.180153.
2025-04-15 16:05:57 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 83)
2025-04-15 16:05:58 | INFO     | core.training.callbacks.early_stopping - Epoch 83: EarlyStopping val_loss improved from 1.219335 to 1.180153
2025-04-15 16:05:58 | INFO     | core.training.callbacks.early_stopping - Epoch 83: EarlyStopping val_loss improved from 1.219335 to 1.180153
2025-04-15 16:05:58 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 83: Captured validation outputs and targets for visualization.
2025-04-15 16:05:58 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 83: Captured validation outputs and targets for visualization.
2025-04-15 16:07:52 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:07:52 | INFO     | core.training.train - Epoch 84 [Fine-tuning] Train: Loss=2.6514, Acc=0.9552, Prec=0.9552, Rec=0.9552, F1=0.9552 (114.50s)
2025-04-15 16:08:00 | INFO     | core.training.train - Epoch 84 [Fine-tuning] Val:   Loss=1.1858, Acc=0.9925, Prec=0.9926, Rec=0.9925, F1=0.9925 (7.99s)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 84.
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 84) ---
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9925
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9460 | Median: 0.9723 | Min: 0.2112
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.67% (246/9222)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0465
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9368 (Count: 161)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9723 (Count: 138)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9901 (Count: 151)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9316 (Count: 249)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9565 (Count: 160)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9762 (Count: 206)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9617 (Count: 140)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9705 (Count: 134)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8446 (Count: 142)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9876 (Count: 178)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8684 (Count: 147)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9837 (Count: 150)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9622 (Count: 168)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9442 (Count: 181)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9349 (Count: 182)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9641 (Count: 159)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9586 (Count: 788)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9677 (Count: 352)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9686 (Count: 154)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9585 (Count: 159)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9361 (Count: 223)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9419 (Count: 163)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9369 (Count: 139)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8756 (Count: 147)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9658 (Count: 139)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9740 (Count: 797)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9920 (Count: 288)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9862 (Count: 171)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9409 (Count: 135)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9144 (Count: 323)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9029 (Count: 135)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9081 (Count: 292)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9416 (Count: 146)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9399 (Count: 278)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9086 (Count: 244)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9266 (Count: 223)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9549 (Count: 798)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9416 (Count: 159)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9431 (Count: 254)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 84.
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 84) ---
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9925
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9460 | Median: 0.9723 | Min: 0.2112
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.67% (246/9222)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0465
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9368 (Count: 161)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9723 (Count: 138)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9901 (Count: 151)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9316 (Count: 249)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9565 (Count: 160)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9762 (Count: 206)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9617 (Count: 140)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9705 (Count: 134)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8446 (Count: 142)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9876 (Count: 178)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8684 (Count: 147)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9837 (Count: 150)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9622 (Count: 168)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9442 (Count: 181)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9349 (Count: 182)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9641 (Count: 159)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9586 (Count: 788)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9677 (Count: 352)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9686 (Count: 154)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9585 (Count: 159)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9361 (Count: 223)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9419 (Count: 163)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9369 (Count: 139)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.8756 (Count: 147)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9658 (Count: 139)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9740 (Count: 797)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9920 (Count: 288)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9862 (Count: 171)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9409 (Count: 135)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9144 (Count: 323)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9029 (Count: 135)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9081 (Count: 292)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9416 (Count: 146)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9399 (Count: 278)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9086 (Count: 244)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9266 (Count: 223)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9549 (Count: 798)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9416 (Count: 159)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9431 (Count: 254)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 84)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 84)
2025-04-15 16:08:01 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 84: Captured validation outputs and targets for visualization.
2025-04-15 16:08:01 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 84: Captured validation outputs and targets for visualization.
2025-04-15 16:09:56 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:09:56 | INFO     | core.training.train - Epoch 85 [Fine-tuning] Train: Loss=2.6701, Acc=0.9558, Prec=0.9558, Rec=0.9558, F1=0.9558 (114.15s)
2025-04-15 16:10:04 | INFO     | core.training.train - Epoch 85 [Fine-tuning] Val:   Loss=1.1810, Acc=0.9918, Prec=0.9921, Rec=0.9918, F1=0.9918 (7.93s)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 85): Current confidence=0.9460, Change=-0.0016
2025-04-15 16:10:04 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 85): Current confidence=0.9460, Change=-0.0016
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 85.
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 85) ---
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9918
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9463 | Median: 0.9700 | Min: 0.2397
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.46% (227/9222)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0459
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9199 (Count: 158)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9807 (Count: 138)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9850 (Count: 151)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9644 (Count: 252)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9665 (Count: 160)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9711 (Count: 206)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9780 (Count: 139)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9666 (Count: 134)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.9135 (Count: 150)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9702 (Count: 177)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8611 (Count: 136)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9594 (Count: 149)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9404 (Count: 168)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9315 (Count: 182)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9661 (Count: 182)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9451 (Count: 159)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9356 (Count: 789)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9618 (Count: 349)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9829 (Count: 154)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9296 (Count: 159)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9633 (Count: 223)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9660 (Count: 163)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9272 (Count: 137)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9478 (Count: 148)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9418 (Count: 139)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9639 (Count: 796)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9925 (Count: 288)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9797 (Count: 170)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9596 (Count: 135)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9261 (Count: 323)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9114 (Count: 134)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9424 (Count: 294)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9574 (Count: 150)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9243 (Count: 277)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9277 (Count: 244)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8716 (Count: 222)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9448 (Count: 795)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9752 (Count: 162)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9684 (Count: 254)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 85.
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 85) ---
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9918
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9463 | Median: 0.9700 | Min: 0.2397
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.46% (227/9222)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0459
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9199 (Count: 158)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9807 (Count: 138)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9850 (Count: 151)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9644 (Count: 252)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9665 (Count: 160)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9711 (Count: 206)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9780 (Count: 139)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9666 (Count: 134)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.9135 (Count: 150)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9702 (Count: 177)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8611 (Count: 136)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9594 (Count: 149)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9404 (Count: 168)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9315 (Count: 182)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9661 (Count: 182)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9451 (Count: 159)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9356 (Count: 789)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9618 (Count: 349)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9829 (Count: 154)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9296 (Count: 159)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9633 (Count: 223)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9660 (Count: 163)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9272 (Count: 137)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9478 (Count: 148)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9418 (Count: 139)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9639 (Count: 796)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9925 (Count: 288)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9797 (Count: 170)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9596 (Count: 135)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9261 (Count: 323)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9114 (Count: 134)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9424 (Count: 294)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9574 (Count: 150)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9243 (Count: 277)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9277 (Count: 244)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8716 (Count: 222)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9448 (Count: 795)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9752 (Count: 162)
2025-04-15 16:10:04 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9684 (Count: 254)
2025-04-15 16:10:04 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 16:10:04 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 16:10:05 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 85)
2025-04-15 16:10:05 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 85)
2025-04-15 16:10:05 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 85: Captured validation outputs and targets for visualization.
2025-04-15 16:10:05 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 85: Captured validation outputs and targets for visualization.
2025-04-15 16:11:58 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:11:58 | INFO     | core.training.train - Epoch 86 [Fine-tuning] Train: Loss=2.5850, Acc=0.9566, Prec=0.9566, Rec=0.9566, F1=0.9566 (113.03s)
2025-04-15 16:12:06 | INFO     | core.training.train - Epoch 86 [Fine-tuning] Val:   Loss=1.2068, Acc=0.9897, Prec=0.9902, Rec=0.9897, F1=0.9897 (7.79s)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 86.
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 86) ---
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9897
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9416 | Median: 0.9682 | Min: 0.2139
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.86% (264/9222)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0485
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9577 (Count: 159)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9684 (Count: 138)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9898 (Count: 151)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9497 (Count: 252)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9603 (Count: 162)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9801 (Count: 206)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9821 (Count: 140)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9414 (Count: 134)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8060 (Count: 122)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9764 (Count: 178)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.9144 (Count: 152)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9694 (Count: 149)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9445 (Count: 167)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9283 (Count: 182)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9768 (Count: 182)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9542 (Count: 159)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9565 (Count: 788)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9719 (Count: 352)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9048 (Count: 153)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8979 (Count: 155)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9316 (Count: 223)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9637 (Count: 163)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9237 (Count: 139)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9564 (Count: 147)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9314 (Count: 139)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9615 (Count: 796)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9911 (Count: 288)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9743 (Count: 171)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9607 (Count: 135)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9528 (Count: 325)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8514 (Count: 132)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9302 (Count: 292)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9179 (Count: 144)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9548 (Count: 282)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9286 (Count: 246)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9051 (Count: 218)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9204 (Count: 791)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9581 (Count: 162)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9238 (Count: 253)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 86.
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 86) ---
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9897
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9416 | Median: 0.9682 | Min: 0.2139
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.86% (264/9222)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0485
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9577 (Count: 159)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9684 (Count: 138)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9898 (Count: 151)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9497 (Count: 252)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9603 (Count: 162)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9801 (Count: 206)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9821 (Count: 140)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9414 (Count: 134)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8060 (Count: 122)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9764 (Count: 178)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.9144 (Count: 152)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9694 (Count: 149)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9445 (Count: 167)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9283 (Count: 182)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9768 (Count: 182)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9542 (Count: 159)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9565 (Count: 788)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9719 (Count: 352)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9048 (Count: 153)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8979 (Count: 155)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9316 (Count: 223)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9637 (Count: 163)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9237 (Count: 139)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9564 (Count: 147)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9314 (Count: 139)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9615 (Count: 796)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9911 (Count: 288)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9743 (Count: 171)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9607 (Count: 135)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9528 (Count: 325)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8514 (Count: 132)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9302 (Count: 292)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9179 (Count: 144)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9548 (Count: 282)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9286 (Count: 246)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9051 (Count: 218)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9204 (Count: 791)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9581 (Count: 162)
2025-04-15 16:12:06 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9238 (Count: 253)
2025-04-15 16:12:07 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 86)
2025-04-15 16:12:07 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 86)
2025-04-15 16:12:07 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 86: Captured validation outputs and targets for visualization.
2025-04-15 16:12:07 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 86: Captured validation outputs and targets for visualization.
2025-04-15 16:13:59 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:13:59 | INFO     | core.training.train - Epoch 87 [Fine-tuning] Train: Loss=2.5613, Acc=0.9576, Prec=0.9576, Rec=0.9576, F1=0.9575 (112.29s)
2025-04-15 16:14:08 | INFO     | core.training.train - Epoch 87 [Fine-tuning] Val:   Loss=1.1645, Acc=0.9926, Prec=0.9927, Rec=0.9926, F1=0.9926 (7.85s)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 87.
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 87) ---
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9926
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9438 | Median: 0.9702 | Min: 0.2864
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.81% (259/9222)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0493
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9480 (Count: 160)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9619 (Count: 138)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9826 (Count: 151)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9599 (Count: 251)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9715 (Count: 162)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9890 (Count: 206)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9534 (Count: 138)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9747 (Count: 134)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8219 (Count: 149)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9859 (Count: 179)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8418 (Count: 145)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9586 (Count: 149)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9470 (Count: 168)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9413 (Count: 181)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9800 (Count: 182)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9687 (Count: 159)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9726 (Count: 789)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9420 (Count: 351)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9496 (Count: 154)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9196 (Count: 159)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9380 (Count: 223)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9744 (Count: 163)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9112 (Count: 140)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9674 (Count: 149)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9316 (Count: 137)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9525 (Count: 796)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9884 (Count: 288)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9769 (Count: 170)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9632 (Count: 135)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9296 (Count: 326)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8440 (Count: 127)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9245 (Count: 290)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9625 (Count: 148)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9412 (Count: 280)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9337 (Count: 248)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8757 (Count: 218)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9411 (Count: 795)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9220 (Count: 162)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9518 (Count: 254)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 87.
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 87) ---
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9926
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9438 | Median: 0.9702 | Min: 0.2864
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.81% (259/9222)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0493
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9480 (Count: 160)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9619 (Count: 138)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9826 (Count: 151)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9599 (Count: 251)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9715 (Count: 162)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9890 (Count: 206)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9534 (Count: 138)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9747 (Count: 134)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8219 (Count: 149)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9859 (Count: 179)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8418 (Count: 145)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9586 (Count: 149)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9470 (Count: 168)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9413 (Count: 181)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9800 (Count: 182)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9687 (Count: 159)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9726 (Count: 789)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9420 (Count: 351)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9496 (Count: 154)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9196 (Count: 159)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9380 (Count: 223)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9744 (Count: 163)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9112 (Count: 140)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9674 (Count: 149)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9316 (Count: 137)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9525 (Count: 796)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9884 (Count: 288)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9769 (Count: 170)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9632 (Count: 135)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9296 (Count: 326)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8440 (Count: 127)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9245 (Count: 290)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9625 (Count: 148)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9412 (Count: 280)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9337 (Count: 248)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8757 (Count: 218)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9411 (Count: 795)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9220 (Count: 162)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9518 (Count: 254)
2025-04-15 16:14:08 | INFO     | core.training.callbacks.model_checkpoint - Epoch 87: val_loss improved from 1.180153 to 1.164534.
2025-04-15 16:14:08 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 87)
2025-04-15 16:14:09 | INFO     | core.training.callbacks.model_checkpoint - Epoch 87: val_loss improved from 1.180153 to 1.164534.
2025-04-15 16:14:09 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 87)
2025-04-15 16:14:09 | INFO     | core.training.callbacks.early_stopping - Epoch 87: EarlyStopping val_loss improved from 1.180153 to 1.164534
2025-04-15 16:14:09 | INFO     | core.training.callbacks.early_stopping - Epoch 87: EarlyStopping val_loss improved from 1.180153 to 1.164534
2025-04-15 16:14:09 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 87: Captured validation outputs and targets for visualization.
2025-04-15 16:14:09 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 87: Captured validation outputs and targets for visualization.
2025-04-15 16:16:01 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:16:01 | INFO     | core.training.train - Epoch 88 [Fine-tuning] Train: Loss=2.4798, Acc=0.9589, Prec=0.9589, Rec=0.9589, F1=0.9589 (111.91s)
2025-04-15 16:16:09 | INFO     | core.training.train - Epoch 88 [Fine-tuning] Val:   Loss=1.1509, Acc=0.9921, Prec=0.9923, Rec=0.9921, F1=0.9921 (7.82s)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 88.
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 88) ---
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9921
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9473 | Median: 0.9710 | Min: 0.2860
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.53% (233/9222)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0448
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9488 (Count: 162)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9518 (Count: 138)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9925 (Count: 151)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9373 (Count: 251)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9371 (Count: 158)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9678 (Count: 206)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9793 (Count: 140)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9804 (Count: 134)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8230 (Count: 133)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9755 (Count: 178)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.9092 (Count: 152)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9535 (Count: 149)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9294 (Count: 168)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9640 (Count: 182)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9562 (Count: 182)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9677 (Count: 159)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9627 (Count: 789)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9698 (Count: 352)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9385 (Count: 154)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9453 (Count: 159)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9574 (Count: 223)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9275 (Count: 163)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9404 (Count: 139)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9640 (Count: 147)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9313 (Count: 139)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9629 (Count: 796)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9862 (Count: 288)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9594 (Count: 171)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9741 (Count: 135)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9467 (Count: 325)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8953 (Count: 133)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9270 (Count: 292)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9686 (Count: 149)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9438 (Count: 280)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9207 (Count: 247)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8848 (Count: 215)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9493 (Count: 795)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9733 (Count: 162)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9536 (Count: 253)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 88.
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 88) ---
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9921
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9473 | Median: 0.9710 | Min: 0.2860
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.53% (233/9222)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0448
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9488 (Count: 162)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9518 (Count: 138)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9925 (Count: 151)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9373 (Count: 251)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9371 (Count: 158)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9678 (Count: 206)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9793 (Count: 140)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9804 (Count: 134)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8230 (Count: 133)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9755 (Count: 178)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.9092 (Count: 152)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9535 (Count: 149)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9294 (Count: 168)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9640 (Count: 182)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9562 (Count: 182)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9677 (Count: 159)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9627 (Count: 789)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9698 (Count: 352)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9385 (Count: 154)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9453 (Count: 159)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9574 (Count: 223)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9275 (Count: 163)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9404 (Count: 139)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9640 (Count: 147)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9313 (Count: 139)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9629 (Count: 796)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9862 (Count: 288)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9594 (Count: 171)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9741 (Count: 135)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9467 (Count: 325)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8953 (Count: 133)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9270 (Count: 292)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9686 (Count: 149)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9438 (Count: 280)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9207 (Count: 247)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8848 (Count: 215)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9493 (Count: 795)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9733 (Count: 162)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9536 (Count: 253)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.model_checkpoint - Epoch 88: val_loss improved from 1.164534 to 1.150887.
2025-04-15 16:16:10 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 88)
2025-04-15 16:16:10 | INFO     | core.training.callbacks.model_checkpoint - Epoch 88: val_loss improved from 1.164534 to 1.150887.
2025-04-15 16:16:11 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 88)
2025-04-15 16:16:11 | INFO     | core.training.callbacks.early_stopping - Epoch 88: EarlyStopping val_loss improved from 1.164534 to 1.150887
2025-04-15 16:16:11 | INFO     | core.training.callbacks.early_stopping - Epoch 88: EarlyStopping val_loss improved from 1.164534 to 1.150887
2025-04-15 16:16:11 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 88: Captured validation outputs and targets for visualization.
2025-04-15 16:16:11 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 88: Captured validation outputs and targets for visualization.
2025-04-15 16:18:03 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:18:03 | INFO     | core.training.train - Epoch 89 [Fine-tuning] Train: Loss=2.4897, Acc=0.9601, Prec=0.9601, Rec=0.9601, F1=0.9601 (112.71s)
2025-04-15 16:18:12 | INFO     | core.training.train - Epoch 89 [Fine-tuning] Val:   Loss=1.1439, Acc=0.9921, Prec=0.9922, Rec=0.9921, F1=0.9921 (7.87s)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 89.
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 89) ---
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9921
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9382 | Median: 0.9671 | Min: 0.2341
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.31% (305/9222)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0540
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9393 (Count: 160)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9676 (Count: 138)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9762 (Count: 151)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9171 (Count: 250)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9354 (Count: 160)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9679 (Count: 206)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9652 (Count: 140)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9711 (Count: 134)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7766 (Count: 140)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9794 (Count: 180)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8857 (Count: 153)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9562 (Count: 150)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9322 (Count: 168)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9635 (Count: 182)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9285 (Count: 182)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9154 (Count: 159)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9521 (Count: 789)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9797 (Count: 352)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9071 (Count: 153)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9057 (Count: 159)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9564 (Count: 223)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9529 (Count: 163)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8985 (Count: 138)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9078 (Count: 147)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9519 (Count: 138)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9586 (Count: 797)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9836 (Count: 288)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9847 (Count: 171)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9381 (Count: 135)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9615 (Count: 326)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9153 (Count: 134)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9146 (Count: 291)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9648 (Count: 149)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8604 (Count: 274)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9083 (Count: 243)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9176 (Count: 221)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9442 (Count: 789)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9430 (Count: 162)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9626 (Count: 254)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 89.
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 89) ---
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9921
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9382 | Median: 0.9671 | Min: 0.2341
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    3.31% (305/9222)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0540
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9393 (Count: 160)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9676 (Count: 138)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9762 (Count: 151)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9171 (Count: 250)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9354 (Count: 160)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9679 (Count: 206)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9652 (Count: 140)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9711 (Count: 134)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.7766 (Count: 140)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9794 (Count: 180)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8857 (Count: 153)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9562 (Count: 150)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9322 (Count: 168)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9635 (Count: 182)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9285 (Count: 182)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9154 (Count: 159)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9521 (Count: 789)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9797 (Count: 352)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9071 (Count: 153)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9057 (Count: 159)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9564 (Count: 223)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9529 (Count: 163)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8985 (Count: 138)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9078 (Count: 147)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9519 (Count: 138)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9586 (Count: 797)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9836 (Count: 288)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9847 (Count: 171)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9381 (Count: 135)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9615 (Count: 326)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9153 (Count: 134)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9146 (Count: 291)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9648 (Count: 149)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.8604 (Count: 274)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9083 (Count: 243)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9176 (Count: 221)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9442 (Count: 789)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9430 (Count: 162)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9626 (Count: 254)
2025-04-15 16:18:12 | INFO     | core.training.callbacks.model_checkpoint - Epoch 89: val_loss improved from 1.150887 to 1.143875.
2025-04-15 16:18:12 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 89)
2025-04-15 16:18:13 | INFO     | core.training.callbacks.model_checkpoint - Epoch 89: val_loss improved from 1.150887 to 1.143875.
2025-04-15 16:18:13 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 89)
2025-04-15 16:18:13 | INFO     | core.training.callbacks.early_stopping - Epoch 89: EarlyStopping val_loss improved from 1.150887 to 1.143875
2025-04-15 16:18:13 | INFO     | core.training.callbacks.early_stopping - Epoch 89: EarlyStopping val_loss improved from 1.150887 to 1.143875
2025-04-15 16:18:13 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 89: Captured validation outputs and targets for visualization.
2025-04-15 16:18:13 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 89: Captured validation outputs and targets for visualization.
2025-04-15 16:20:05 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:20:05 | INFO     | core.training.train - Epoch 90 [Fine-tuning] Train: Loss=2.4091, Acc=0.9613, Prec=0.9613, Rec=0.9613, F1=0.9613 (111.66s)
2025-04-15 16:20:13 | INFO     | core.training.train - Epoch 90 [Fine-tuning] Val:   Loss=1.1512, Acc=0.9927, Prec=0.9928, Rec=0.9927, F1=0.9927 (7.82s)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 90): Current confidence=0.9382, Change=-0.0091
2025-04-15 16:20:13 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 90): Current confidence=0.9382, Change=-0.0091
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 90.
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 90) ---
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9927
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9438 | Median: 0.9689 | Min: 0.2188
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.56% (236/9222)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0491
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9679 (Count: 161)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9611 (Count: 138)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9807 (Count: 151)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9466 (Count: 251)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9392 (Count: 159)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9834 (Count: 206)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9810 (Count: 139)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9700 (Count: 134)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8919 (Count: 149)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9632 (Count: 178)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8810 (Count: 145)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9533 (Count: 149)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9349 (Count: 168)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9685 (Count: 182)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9583 (Count: 182)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9406 (Count: 159)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9388 (Count: 788)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9674 (Count: 350)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8991 (Count: 152)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9481 (Count: 158)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9281 (Count: 223)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9628 (Count: 163)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9483 (Count: 140)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9238 (Count: 148)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9611 (Count: 139)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9571 (Count: 795)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9911 (Count: 288)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9881 (Count: 171)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9509 (Count: 135)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9194 (Count: 324)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9149 (Count: 134)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9177 (Count: 288)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9356 (Count: 149)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9383 (Count: 282)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8876 (Count: 244)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8969 (Count: 221)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9537 (Count: 796)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9735 (Count: 162)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9717 (Count: 254)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 90.
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 90) ---
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9927
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9438 | Median: 0.9689 | Min: 0.2188
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.56% (236/9222)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0491
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9679 (Count: 161)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9611 (Count: 138)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9807 (Count: 151)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9466 (Count: 251)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9392 (Count: 159)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9834 (Count: 206)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9810 (Count: 139)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9700 (Count: 134)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8919 (Count: 149)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9632 (Count: 178)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8810 (Count: 145)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9533 (Count: 149)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9349 (Count: 168)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9685 (Count: 182)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9583 (Count: 182)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9406 (Count: 159)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9388 (Count: 788)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9674 (Count: 350)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8991 (Count: 152)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9481 (Count: 158)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9281 (Count: 223)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9628 (Count: 163)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9483 (Count: 140)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9238 (Count: 148)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9611 (Count: 139)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9571 (Count: 795)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9911 (Count: 288)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9881 (Count: 171)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9509 (Count: 135)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9194 (Count: 324)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9149 (Count: 134)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9177 (Count: 288)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9356 (Count: 149)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9383 (Count: 282)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8876 (Count: 244)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8969 (Count: 221)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9537 (Count: 796)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9735 (Count: 162)
2025-04-15 16:20:13 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9717 (Count: 254)
2025-04-15 16:20:13 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 16:20:13 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 16:20:14 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 90)
2025-04-15 16:20:14 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 90)
2025-04-15 16:20:14 | INFO     | core.training.callbacks.gradcam_callback - Generating GradCAM visualizations at epoch 90
2025-04-15 16:20:14 | INFO     | core.models.model_cbam18 - Using layer4[-1].conv2 as GradCAM target layer
2025-04-15 16:20:14 | INFO     | core.evaluation.interpretability - Using model's recommended GradCAM target layer
2025-04-15 16:20:14 | INFO     | core.evaluation.interpretability - GradCAM initialized with target layer: Conv2d
2025-04-15 16:20:32 | INFO     | core.training.callbacks.gradcam_callback - Generated summary HTML: outputs/cbam_only_resnet18_v2/gradcam/epoch_090/gradcam_summary.html
2025-04-15 16:20:32 | INFO     | core.training.callbacks.gradcam_callback - GradCAM visualizations saved to outputs/cbam_only_resnet18_v2/gradcam/epoch_090
2025-04-15 16:20:32 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 90: Captured validation outputs and targets for visualization.
2025-04-15 16:20:32 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 90: Captured validation outputs and targets for visualization.
2025-04-15 16:22:24 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:22:24 | INFO     | core.training.train - Epoch 91 [Fine-tuning] Train: Loss=2.4309, Acc=0.9615, Prec=0.9615, Rec=0.9615, F1=0.9615 (112.22s)
2025-04-15 16:22:32 | INFO     | core.training.train - Epoch 91 [Fine-tuning] Val:   Loss=1.1155, Acc=0.9933, Prec=0.9934, Rec=0.9933, F1=0.9933 (7.92s)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 91.
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 91) ---
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9933
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9475 | Median: 0.9701 | Min: 0.2415
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.19% (202/9222)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0461
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9566 (Count: 157)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9813 (Count: 138)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9835 (Count: 151)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9483 (Count: 249)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9376 (Count: 162)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9821 (Count: 206)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9836 (Count: 139)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9595 (Count: 134)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8787 (Count: 149)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9658 (Count: 178)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8674 (Count: 145)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9566 (Count: 149)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9426 (Count: 168)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9349 (Count: 182)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9569 (Count: 181)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9726 (Count: 159)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9527 (Count: 789)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9689 (Count: 350)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9443 (Count: 154)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9493 (Count: 159)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9678 (Count: 223)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9657 (Count: 163)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9324 (Count: 138)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9574 (Count: 149)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9506 (Count: 139)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9495 (Count: 795)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9897 (Count: 288)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9761 (Count: 171)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9722 (Count: 135)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9397 (Count: 326)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8667 (Count: 128)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9256 (Count: 293)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9479 (Count: 149)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9344 (Count: 280)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9215 (Count: 247)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9253 (Count: 223)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9539 (Count: 798)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9663 (Count: 162)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9524 (Count: 254)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 91.
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 91) ---
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9933
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9475 | Median: 0.9701 | Min: 0.2415
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.19% (202/9222)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0461
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9566 (Count: 157)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9813 (Count: 138)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9835 (Count: 151)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9483 (Count: 249)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9376 (Count: 162)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9821 (Count: 206)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9836 (Count: 139)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9595 (Count: 134)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8787 (Count: 149)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9658 (Count: 178)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8674 (Count: 145)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9566 (Count: 149)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9426 (Count: 168)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9349 (Count: 182)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9569 (Count: 181)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9726 (Count: 159)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9527 (Count: 789)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9689 (Count: 350)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9443 (Count: 154)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9493 (Count: 159)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9678 (Count: 223)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9657 (Count: 163)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9324 (Count: 138)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9574 (Count: 149)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9506 (Count: 139)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9495 (Count: 795)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9897 (Count: 288)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9761 (Count: 171)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9722 (Count: 135)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9397 (Count: 326)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8667 (Count: 128)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9256 (Count: 293)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9479 (Count: 149)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9344 (Count: 280)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9215 (Count: 247)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9253 (Count: 223)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9539 (Count: 798)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9663 (Count: 162)
2025-04-15 16:22:32 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9524 (Count: 254)
2025-04-15 16:22:33 | INFO     | core.training.callbacks.model_checkpoint - Epoch 91: val_loss improved from 1.143875 to 1.115536.
2025-04-15 16:22:33 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 91)
2025-04-15 16:22:33 | INFO     | core.training.callbacks.model_checkpoint - Epoch 91: val_loss improved from 1.143875 to 1.115536.
2025-04-15 16:22:33 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 91)
2025-04-15 16:22:34 | INFO     | core.training.callbacks.early_stopping - Epoch 91: EarlyStopping val_loss improved from 1.143875 to 1.115536
2025-04-15 16:22:34 | INFO     | core.training.callbacks.early_stopping - Epoch 91: EarlyStopping val_loss improved from 1.143875 to 1.115536
2025-04-15 16:22:34 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 91: Captured validation outputs and targets for visualization.
2025-04-15 16:22:34 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 91: Captured validation outputs and targets for visualization.
2025-04-15 16:24:26 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:24:26 | INFO     | core.training.train - Epoch 92 [Fine-tuning] Train: Loss=2.4120, Acc=0.9621, Prec=0.9621, Rec=0.9621, F1=0.9621 (112.11s)
2025-04-15 16:24:34 | INFO     | core.training.train - Epoch 92 [Fine-tuning] Val:   Loss=1.1096, Acc=0.9921, Prec=0.9923, Rec=0.9921, F1=0.9921 (7.84s)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 92.
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 92) ---
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9921
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9421 | Median: 0.9642 | Min: 0.1904
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.53% (233/9222)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0504
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9380 (Count: 159)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9374 (Count: 138)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9697 (Count: 151)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9700 (Count: 251)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9389 (Count: 161)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9643 (Count: 206)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9567 (Count: 139)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9646 (Count: 134)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8285 (Count: 138)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9633 (Count: 178)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.9067 (Count: 152)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9529 (Count: 150)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9351 (Count: 168)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9386 (Count: 182)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9634 (Count: 182)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9561 (Count: 159)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9438 (Count: 789)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9666 (Count: 351)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9250 (Count: 153)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9342 (Count: 159)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9593 (Count: 223)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9517 (Count: 163)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9314 (Count: 140)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9528 (Count: 149)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9480 (Count: 139)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9454 (Count: 795)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9853 (Count: 288)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9793 (Count: 171)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9669 (Count: 135)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9256 (Count: 324)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8725 (Count: 126)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9299 (Count: 292)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9610 (Count: 151)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9543 (Count: 280)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9496 (Count: 249)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8986 (Count: 213)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9455 (Count: 798)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9428 (Count: 162)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9356 (Count: 251)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 92.
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 92) ---
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9921
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9421 | Median: 0.9642 | Min: 0.1904
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.53% (233/9222)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0504
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9380 (Count: 159)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9374 (Count: 138)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9697 (Count: 151)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9700 (Count: 251)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9389 (Count: 161)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9643 (Count: 206)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9567 (Count: 139)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9646 (Count: 134)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8285 (Count: 138)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9633 (Count: 178)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.9067 (Count: 152)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9529 (Count: 150)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9351 (Count: 168)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9386 (Count: 182)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9634 (Count: 182)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9561 (Count: 159)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9438 (Count: 789)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9666 (Count: 351)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9250 (Count: 153)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9342 (Count: 159)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9593 (Count: 223)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9517 (Count: 163)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9314 (Count: 140)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9528 (Count: 149)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9480 (Count: 139)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9454 (Count: 795)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9853 (Count: 288)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9793 (Count: 171)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9669 (Count: 135)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9256 (Count: 324)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8725 (Count: 126)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9299 (Count: 292)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9610 (Count: 151)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9543 (Count: 280)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9496 (Count: 249)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8986 (Count: 213)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9455 (Count: 798)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9428 (Count: 162)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9356 (Count: 251)
2025-04-15 16:24:34 | INFO     | core.training.callbacks.model_checkpoint - Epoch 92: val_loss improved from 1.115536 to 1.109584.
2025-04-15 16:24:35 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 92)
2025-04-15 16:24:35 | INFO     | core.training.callbacks.model_checkpoint - Epoch 92: val_loss improved from 1.115536 to 1.109584.
2025-04-15 16:24:35 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 92)
2025-04-15 16:24:35 | INFO     | core.training.callbacks.early_stopping - Epoch 92: EarlyStopping val_loss improved from 1.115536 to 1.109584
2025-04-15 16:24:35 | INFO     | core.training.callbacks.early_stopping - Epoch 92: EarlyStopping val_loss improved from 1.115536 to 1.109584
2025-04-15 16:24:35 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 92: Captured validation outputs and targets for visualization.
2025-04-15 16:24:35 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 92: Captured validation outputs and targets for visualization.
2025-04-15 16:26:27 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:26:27 | INFO     | core.training.train - Epoch 93 [Fine-tuning] Train: Loss=2.3438, Acc=0.9635, Prec=0.9635, Rec=0.9635, F1=0.9635 (111.79s)
2025-04-15 16:26:35 | INFO     | core.training.train - Epoch 93 [Fine-tuning] Val:   Loss=1.1298, Acc=0.9924, Prec=0.9926, Rec=0.9924, F1=0.9924 (7.67s)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 93.
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 93) ---
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9924
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9395 | Median: 0.9652 | Min: 0.2675
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.91% (268/9222)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0531
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9627 (Count: 161)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9714 (Count: 138)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9798 (Count: 151)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9632 (Count: 252)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9295 (Count: 160)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9808 (Count: 206)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9325 (Count: 139)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9590 (Count: 134)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8693 (Count: 147)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9618 (Count: 177)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8980 (Count: 145)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9646 (Count: 149)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9565 (Count: 168)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9566 (Count: 180)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8933 (Count: 174)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9563 (Count: 159)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9648 (Count: 789)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9635 (Count: 351)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9377 (Count: 154)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9581 (Count: 159)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9344 (Count: 222)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9667 (Count: 163)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9391 (Count: 142)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9518 (Count: 149)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9404 (Count: 139)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9088 (Count: 793)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9862 (Count: 288)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9740 (Count: 171)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9697 (Count: 135)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9419 (Count: 326)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8809 (Count: 133)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8984 (Count: 289)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9566 (Count: 150)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9464 (Count: 281)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8923 (Count: 244)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9508 (Count: 223)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9302 (Count: 795)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9675 (Count: 162)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9300 (Count: 254)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 93.
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 93) ---
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9924
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9395 | Median: 0.9652 | Min: 0.2675
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.91% (268/9222)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0531
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9627 (Count: 161)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9714 (Count: 138)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9798 (Count: 151)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9632 (Count: 252)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9295 (Count: 160)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9808 (Count: 206)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9325 (Count: 139)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9590 (Count: 134)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8693 (Count: 147)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9618 (Count: 177)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8980 (Count: 145)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9646 (Count: 149)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9565 (Count: 168)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9566 (Count: 180)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.8933 (Count: 174)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9563 (Count: 159)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9648 (Count: 789)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9635 (Count: 351)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9377 (Count: 154)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9581 (Count: 159)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9344 (Count: 222)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9667 (Count: 163)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9391 (Count: 142)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9518 (Count: 149)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9404 (Count: 139)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9088 (Count: 793)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9862 (Count: 288)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9740 (Count: 171)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9697 (Count: 135)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9419 (Count: 326)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8809 (Count: 133)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8984 (Count: 289)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9566 (Count: 150)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9464 (Count: 281)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.8923 (Count: 244)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9508 (Count: 223)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9302 (Count: 795)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9675 (Count: 162)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9300 (Count: 254)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 93)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 93)
2025-04-15 16:26:36 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 93: Captured validation outputs and targets for visualization.
2025-04-15 16:26:36 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 93: Captured validation outputs and targets for visualization.
2025-04-15 16:28:29 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:28:29 | INFO     | core.training.train - Epoch 94 [Fine-tuning] Train: Loss=2.3408, Acc=0.9635, Prec=0.9635, Rec=0.9635, F1=0.9635 (112.46s)
2025-04-15 16:28:37 | INFO     | core.training.train - Epoch 94 [Fine-tuning] Val:   Loss=1.1620, Acc=0.9909, Prec=0.9913, Rec=0.9909, F1=0.9909 (7.79s)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 94.
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 94) ---
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9909
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9455 | Median: 0.9708 | Min: 0.2275
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.57% (237/9222)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0457
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9557 (Count: 160)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9484 (Count: 138)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9661 (Count: 151)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9491 (Count: 252)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9366 (Count: 158)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9659 (Count: 206)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9683 (Count: 140)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9476 (Count: 134)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8355 (Count: 127)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9609 (Count: 177)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.9445 (Count: 152)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9477 (Count: 149)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9516 (Count: 168)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9553 (Count: 180)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9685 (Count: 182)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9707 (Count: 159)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9748 (Count: 789)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9722 (Count: 352)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9382 (Count: 154)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9381 (Count: 159)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9383 (Count: 223)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9678 (Count: 163)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9263 (Count: 140)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9579 (Count: 148)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9610 (Count: 139)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9665 (Count: 796)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9832 (Count: 288)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9805 (Count: 171)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9513 (Count: 135)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9359 (Count: 325)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8976 (Count: 134)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9341 (Count: 290)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9613 (Count: 149)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9137 (Count: 276)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9098 (Count: 243)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9505 (Count: 224)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9221 (Count: 795)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9342 (Count: 159)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9369 (Count: 253)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 94.
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 94) ---
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9909
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9455 | Median: 0.9708 | Min: 0.2275
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.57% (237/9222)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0457
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9557 (Count: 160)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9484 (Count: 138)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9661 (Count: 151)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9491 (Count: 252)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9366 (Count: 158)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9659 (Count: 206)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9683 (Count: 140)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9476 (Count: 134)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8355 (Count: 127)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9609 (Count: 177)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.9445 (Count: 152)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9477 (Count: 149)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9516 (Count: 168)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9553 (Count: 180)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9685 (Count: 182)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9707 (Count: 159)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9748 (Count: 789)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9722 (Count: 352)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9382 (Count: 154)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9381 (Count: 159)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9383 (Count: 223)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9678 (Count: 163)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9263 (Count: 140)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9579 (Count: 148)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9610 (Count: 139)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9665 (Count: 796)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9832 (Count: 288)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9805 (Count: 171)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9513 (Count: 135)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9359 (Count: 325)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8976 (Count: 134)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9341 (Count: 290)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9613 (Count: 149)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9137 (Count: 276)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9098 (Count: 243)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9505 (Count: 224)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9221 (Count: 795)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9342 (Count: 159)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9369 (Count: 253)
2025-04-15 16:28:37 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 94)
2025-04-15 16:28:38 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 94)
2025-04-15 16:28:38 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 94: Captured validation outputs and targets for visualization.
2025-04-15 16:28:38 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 94: Captured validation outputs and targets for visualization.
2025-04-15 16:30:30 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:30:30 | INFO     | core.training.train - Epoch 95 [Fine-tuning] Train: Loss=2.3562, Acc=0.9637, Prec=0.9637, Rec=0.9637, F1=0.9637 (112.69s)
2025-04-15 16:30:39 | INFO     | core.training.train - Epoch 95 [Fine-tuning] Val:   Loss=1.1085, Acc=0.9930, Prec=0.9930, Rec=0.9930, F1=0.9930 (8.04s)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 95): Current confidence=0.9455, Change=+0.0060
2025-04-15 16:30:39 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 95): Current confidence=0.9455, Change=+0.0060
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 95.
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 95) ---
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9930
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9409 | Median: 0.9652 | Min: 0.2369
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.54% (234/9222)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0522
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9629 (Count: 161)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9732 (Count: 138)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9836 (Count: 151)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9618 (Count: 251)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9366 (Count: 160)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9709 (Count: 206)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9590 (Count: 139)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9496 (Count: 134)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8595 (Count: 142)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9803 (Count: 178)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8827 (Count: 149)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9285 (Count: 149)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9156 (Count: 166)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9640 (Count: 182)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9167 (Count: 179)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9508 (Count: 159)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9572 (Count: 789)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9542 (Count: 352)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9420 (Count: 154)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8923 (Count: 159)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9375 (Count: 223)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9456 (Count: 161)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9424 (Count: 142)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9218 (Count: 149)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9690 (Count: 139)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9418 (Count: 792)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9767 (Count: 288)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9874 (Count: 171)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9404 (Count: 135)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9308 (Count: 325)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9048 (Count: 136)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9446 (Count: 293)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9839 (Count: 151)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9319 (Count: 278)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9396 (Count: 245)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8787 (Count: 219)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9267 (Count: 796)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9758 (Count: 162)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9663 (Count: 254)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 95.
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 95) ---
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9930
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9409 | Median: 0.9652 | Min: 0.2369
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.54% (234/9222)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0522
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9629 (Count: 161)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9732 (Count: 138)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9836 (Count: 151)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9618 (Count: 251)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9366 (Count: 160)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9709 (Count: 206)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9590 (Count: 139)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9496 (Count: 134)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8595 (Count: 142)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9803 (Count: 178)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8827 (Count: 149)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9285 (Count: 149)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9156 (Count: 166)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9640 (Count: 182)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9167 (Count: 179)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9508 (Count: 159)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9572 (Count: 789)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9542 (Count: 352)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9420 (Count: 154)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.8923 (Count: 159)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9375 (Count: 223)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9456 (Count: 161)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9424 (Count: 142)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9218 (Count: 149)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9690 (Count: 139)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9418 (Count: 792)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9767 (Count: 288)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9874 (Count: 171)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9404 (Count: 135)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9308 (Count: 325)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9048 (Count: 136)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9446 (Count: 293)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9839 (Count: 151)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9319 (Count: 278)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9396 (Count: 245)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8787 (Count: 219)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9267 (Count: 796)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9758 (Count: 162)
2025-04-15 16:30:39 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9663 (Count: 254)
2025-04-15 16:30:39 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 16:30:39 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 16:30:39 | INFO     | core.training.callbacks.model_checkpoint - Epoch 95: val_loss improved from 1.109584 to 1.108524.
2025-04-15 16:30:40 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 95)
2025-04-15 16:30:40 | INFO     | core.training.callbacks.model_checkpoint - Epoch 95: val_loss improved from 1.109584 to 1.108524.
2025-04-15 16:30:40 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 95)
2025-04-15 16:30:40 | INFO     | core.training.callbacks.early_stopping - Epoch 95: EarlyStopping val_loss improved from 1.109584 to 1.108524
2025-04-15 16:30:40 | INFO     | core.training.callbacks.early_stopping - Epoch 95: EarlyStopping val_loss improved from 1.109584 to 1.108524
2025-04-15 16:30:40 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 95: Captured validation outputs and targets for visualization.
2025-04-15 16:30:40 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 95: Captured validation outputs and targets for visualization.
2025-04-15 16:32:33 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:32:33 | INFO     | core.training.train - Epoch 96 [Fine-tuning] Train: Loss=2.2770, Acc=0.9656, Prec=0.9656, Rec=0.9656, F1=0.9656 (112.77s)
2025-04-15 16:32:41 | INFO     | core.training.train - Epoch 96 [Fine-tuning] Val:   Loss=1.1158, Acc=0.9926, Prec=0.9928, Rec=0.9926, F1=0.9926 (7.88s)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 96.
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 96) ---
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9926
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9458 | Median: 0.9681 | Min: 0.1610
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.28% (210/9222)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0470
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9628 (Count: 162)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9676 (Count: 138)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9771 (Count: 151)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9599 (Count: 251)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9321 (Count: 159)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9845 (Count: 206)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9779 (Count: 139)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9605 (Count: 134)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8786 (Count: 149)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9731 (Count: 178)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8724 (Count: 145)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9615 (Count: 149)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9437 (Count: 168)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9173 (Count: 181)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9668 (Count: 182)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9650 (Count: 159)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9467 (Count: 789)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9630 (Count: 352)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9373 (Count: 153)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9422 (Count: 159)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9350 (Count: 223)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9541 (Count: 162)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9195 (Count: 140)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9391 (Count: 148)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9575 (Count: 139)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9706 (Count: 796)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9885 (Count: 288)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9699 (Count: 171)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9461 (Count: 135)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9515 (Count: 325)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8494 (Count: 128)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9444 (Count: 293)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9552 (Count: 150)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9646 (Count: 282)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9289 (Count: 243)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8782 (Count: 214)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9312 (Count: 797)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9659 (Count: 162)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9621 (Count: 254)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 96.
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 96) ---
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9926
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9458 | Median: 0.9681 | Min: 0.1610
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.28% (210/9222)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0470
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9628 (Count: 162)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9676 (Count: 138)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9771 (Count: 151)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9599 (Count: 251)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9321 (Count: 159)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9845 (Count: 206)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9779 (Count: 139)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9605 (Count: 134)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8786 (Count: 149)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9731 (Count: 178)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8724 (Count: 145)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9615 (Count: 149)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9437 (Count: 168)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9173 (Count: 181)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9668 (Count: 182)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9650 (Count: 159)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9467 (Count: 789)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9630 (Count: 352)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9373 (Count: 153)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9422 (Count: 159)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9350 (Count: 223)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9541 (Count: 162)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9195 (Count: 140)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9391 (Count: 148)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9575 (Count: 139)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9706 (Count: 796)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9885 (Count: 288)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9699 (Count: 171)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9461 (Count: 135)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9515 (Count: 325)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8494 (Count: 128)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9444 (Count: 293)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9552 (Count: 150)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9646 (Count: 282)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9289 (Count: 243)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.8782 (Count: 214)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9312 (Count: 797)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9659 (Count: 162)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9621 (Count: 254)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 96)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 96)
2025-04-15 16:32:42 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 96: Captured validation outputs and targets for visualization.
2025-04-15 16:32:42 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 96: Captured validation outputs and targets for visualization.
2025-04-15 16:34:34 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:34:34 | INFO     | core.training.train - Epoch 97 [Fine-tuning] Train: Loss=2.2305, Acc=0.9656, Prec=0.9656, Rec=0.9656, F1=0.9656 (111.90s)
2025-04-15 16:34:42 | INFO     | core.training.train - Epoch 97 [Fine-tuning] Val:   Loss=1.1072, Acc=0.9922, Prec=0.9925, Rec=0.9922, F1=0.9922 (7.78s)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 97.
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 97) ---
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9922
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9432 | Median: 0.9653 | Min: 0.2608
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.36% (218/9222)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0490
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9739 (Count: 162)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9597 (Count: 138)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9838 (Count: 151)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9567 (Count: 251)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9468 (Count: 161)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9680 (Count: 206)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9743 (Count: 139)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9574 (Count: 134)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8129 (Count: 123)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9666 (Count: 179)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.9267 (Count: 151)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9584 (Count: 150)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9638 (Count: 168)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9269 (Count: 181)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9543 (Count: 182)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9327 (Count: 159)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9495 (Count: 789)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9734 (Count: 352)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9128 (Count: 154)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9295 (Count: 159)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9471 (Count: 223)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9677 (Count: 163)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9451 (Count: 140)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9028 (Count: 149)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9295 (Count: 139)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9505 (Count: 795)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9846 (Count: 288)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9855 (Count: 171)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9489 (Count: 135)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9304 (Count: 324)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8858 (Count: 134)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9232 (Count: 293)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9712 (Count: 150)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9533 (Count: 280)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9119 (Count: 243)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9386 (Count: 222)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9285 (Count: 796)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9483 (Count: 162)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9707 (Count: 254)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 97.
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 97) ---
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9922
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9432 | Median: 0.9653 | Min: 0.2608
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.36% (218/9222)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0490
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9739 (Count: 162)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9597 (Count: 138)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9838 (Count: 151)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9567 (Count: 251)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9468 (Count: 161)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9680 (Count: 206)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9743 (Count: 139)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9574 (Count: 134)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8129 (Count: 123)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9666 (Count: 179)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.9267 (Count: 151)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9584 (Count: 150)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9638 (Count: 168)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9269 (Count: 181)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9543 (Count: 182)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9327 (Count: 159)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9495 (Count: 789)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9734 (Count: 352)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9128 (Count: 154)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9295 (Count: 159)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9471 (Count: 223)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9677 (Count: 163)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9451 (Count: 140)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9028 (Count: 149)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9295 (Count: 139)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9505 (Count: 795)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9846 (Count: 288)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9855 (Count: 171)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9489 (Count: 135)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9304 (Count: 324)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8858 (Count: 134)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9232 (Count: 293)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9712 (Count: 150)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9533 (Count: 280)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9119 (Count: 243)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9386 (Count: 222)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9285 (Count: 796)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9483 (Count: 162)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9707 (Count: 254)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.model_checkpoint - Epoch 97: val_loss improved from 1.108524 to 1.107231.
2025-04-15 16:34:43 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 97)
2025-04-15 16:34:43 | INFO     | core.training.callbacks.model_checkpoint - Epoch 97: val_loss improved from 1.108524 to 1.107231.
2025-04-15 16:34:44 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 97)
2025-04-15 16:34:44 | INFO     | core.training.callbacks.early_stopping - Epoch 97: EarlyStopping val_loss improved from 1.108524 to 1.107231
2025-04-15 16:34:44 | INFO     | core.training.callbacks.early_stopping - Epoch 97: EarlyStopping val_loss improved from 1.108524 to 1.107231
2025-04-15 16:34:44 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 97: Captured validation outputs and targets for visualization.
2025-04-15 16:34:44 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 97: Captured validation outputs and targets for visualization.
2025-04-15 16:36:36 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:36:36 | INFO     | core.training.train - Epoch 98 [Fine-tuning] Train: Loss=2.1953, Acc=0.9667, Prec=0.9667, Rec=0.9667, F1=0.9667 (111.88s)
2025-04-15 16:36:44 | INFO     | core.training.train - Epoch 98 [Fine-tuning] Val:   Loss=1.0772, Acc=0.9936, Prec=0.9937, Rec=0.9936, F1=0.9936 (7.86s)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 98.
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 98) ---
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9936
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9463 | Median: 0.9659 | Min: 0.2497
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    1.97% (182/9222)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0473
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9693 (Count: 160)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9628 (Count: 138)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9864 (Count: 151)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9694 (Count: 252)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9321 (Count: 161)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9711 (Count: 206)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9566 (Count: 139)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9561 (Count: 134)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8659 (Count: 141)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9742 (Count: 178)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8999 (Count: 147)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9711 (Count: 149)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9560 (Count: 168)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9514 (Count: 182)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9400 (Count: 182)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9641 (Count: 159)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9515 (Count: 789)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9565 (Count: 351)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9466 (Count: 154)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9618 (Count: 159)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9492 (Count: 223)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9335 (Count: 162)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9462 (Count: 140)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9438 (Count: 149)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9482 (Count: 139)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9568 (Count: 795)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9906 (Count: 288)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9704 (Count: 171)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9482 (Count: 135)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9390 (Count: 325)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8916 (Count: 132)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9255 (Count: 292)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9533 (Count: 148)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9499 (Count: 282)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9454 (Count: 248)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9288 (Count: 222)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9278 (Count: 796)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9545 (Count: 162)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9494 (Count: 254)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 98.
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 98) ---
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9936
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9463 | Median: 0.9659 | Min: 0.2497
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    1.97% (182/9222)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0473
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9693 (Count: 160)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9628 (Count: 138)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9864 (Count: 151)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9694 (Count: 252)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9321 (Count: 161)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9711 (Count: 206)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9566 (Count: 139)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9561 (Count: 134)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8659 (Count: 141)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9742 (Count: 178)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8999 (Count: 147)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9711 (Count: 149)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9560 (Count: 168)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9514 (Count: 182)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9400 (Count: 182)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9641 (Count: 159)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9515 (Count: 789)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9565 (Count: 351)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9466 (Count: 154)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9618 (Count: 159)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9492 (Count: 223)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9335 (Count: 162)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9462 (Count: 140)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9438 (Count: 149)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9482 (Count: 139)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9568 (Count: 795)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9906 (Count: 288)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9704 (Count: 171)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9482 (Count: 135)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9390 (Count: 325)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8916 (Count: 132)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9255 (Count: 292)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9533 (Count: 148)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9499 (Count: 282)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9454 (Count: 248)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9288 (Count: 222)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9278 (Count: 796)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9545 (Count: 162)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9494 (Count: 254)
2025-04-15 16:36:44 | INFO     | core.training.callbacks.model_checkpoint - Epoch 98: val_loss improved from 1.107231 to 1.077230.
2025-04-15 16:36:45 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 98)
2025-04-15 16:36:45 | INFO     | core.training.callbacks.model_checkpoint - Epoch 98: val_loss improved from 1.107231 to 1.077230.
2025-04-15 16:36:45 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 98)
2025-04-15 16:36:45 | INFO     | core.training.callbacks.early_stopping - Epoch 98: EarlyStopping val_loss improved from 1.107231 to 1.077230
2025-04-15 16:36:45 | INFO     | core.training.callbacks.early_stopping - Epoch 98: EarlyStopping val_loss improved from 1.107231 to 1.077230
2025-04-15 16:36:45 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 98: Captured validation outputs and targets for visualization.
2025-04-15 16:36:45 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 98: Captured validation outputs and targets for visualization.
2025-04-15 16:38:37 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:38:37 | INFO     | core.training.train - Epoch 99 [Fine-tuning] Train: Loss=2.1900, Acc=0.9659, Prec=0.9659, Rec=0.9659, F1=0.9659 (111.87s)
2025-04-15 16:38:45 | INFO     | core.training.train - Epoch 99 [Fine-tuning] Val:   Loss=1.1406, Acc=0.9917, Prec=0.9918, Rec=0.9917, F1=0.9916 (7.75s)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 99.
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 99) ---
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9917
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9414 | Median: 0.9662 | Min: 0.2996
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.81% (259/9222)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0502
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9344 (Count: 160)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9845 (Count: 138)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9812 (Count: 151)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9484 (Count: 250)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9275 (Count: 160)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9816 (Count: 206)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9786 (Count: 140)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9726 (Count: 134)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8388 (Count: 139)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9657 (Count: 178)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8905 (Count: 149)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9549 (Count: 150)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9515 (Count: 168)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9308 (Count: 180)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9549 (Count: 182)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9760 (Count: 159)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9526 (Count: 789)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9720 (Count: 352)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8715 (Count: 153)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9188 (Count: 159)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9602 (Count: 223)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9544 (Count: 161)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9458 (Count: 142)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9494 (Count: 149)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9469 (Count: 139)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9602 (Count: 796)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9781 (Count: 288)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9760 (Count: 171)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9487 (Count: 135)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9359 (Count: 325)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8429 (Count: 122)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8934 (Count: 289)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9198 (Count: 147)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9724 (Count: 283)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9200 (Count: 247)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9205 (Count: 221)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9331 (Count: 794)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9671 (Count: 162)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9216 (Count: 254)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 99.
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 99) ---
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9917
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9414 | Median: 0.9662 | Min: 0.2996
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.81% (259/9222)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0502
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9344 (Count: 160)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9845 (Count: 138)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9812 (Count: 151)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9484 (Count: 250)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9275 (Count: 160)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9816 (Count: 206)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9786 (Count: 140)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9726 (Count: 134)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8388 (Count: 139)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9657 (Count: 178)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.8905 (Count: 149)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9549 (Count: 150)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9515 (Count: 168)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9308 (Count: 180)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9549 (Count: 182)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9760 (Count: 159)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9526 (Count: 789)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9720 (Count: 352)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.8715 (Count: 153)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9188 (Count: 159)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9602 (Count: 223)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9544 (Count: 161)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.9458 (Count: 142)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9494 (Count: 149)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9469 (Count: 139)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9602 (Count: 796)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9781 (Count: 288)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9760 (Count: 171)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9487 (Count: 135)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9359 (Count: 325)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.8429 (Count: 122)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.8934 (Count: 289)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9198 (Count: 147)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9724 (Count: 283)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9200 (Count: 247)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9205 (Count: 221)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9331 (Count: 794)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9671 (Count: 162)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9216 (Count: 254)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 99)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'last_model.pth' (Epoch 99)
2025-04-15 16:38:46 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 99: Captured validation outputs and targets for visualization.
2025-04-15 16:38:46 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 99: Captured validation outputs and targets for visualization.
2025-04-15 16:40:38 | INFO     | utils.mps_utils - MPS profiler stopped and resources released
2025-04-15 16:40:38 | INFO     | core.training.train - Epoch 100 [Fine-tuning] Train: Loss=2.2121, Acc=0.9671, Prec=0.9671, Rec=0.9671, F1=0.9671 (111.49s)
2025-04-15 16:40:46 | INFO     | core.training.train - Epoch 100 [Fine-tuning] Val:   Loss=1.0704, Acc=0.9936, Prec=0.9937, Rec=0.9936, F1=0.9936 (7.66s)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 100): Current confidence=0.9414, Change=-0.0049
2025-04-15 16:40:46 | INFO     | core.training.callbacks.adaptive_weight - AdaptiveWeightAdjustment (Epoch 100): Current confidence=0.9414, Change=-0.0049
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 100.
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 100) ---
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9936
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9435 | Median: 0.9625 | Min: 0.2182
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.18% (201/9222)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0503
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9402 (Count: 160)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9758 (Count: 138)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9848 (Count: 151)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9539 (Count: 252)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9641 (Count: 161)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9679 (Count: 206)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9691 (Count: 139)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9611 (Count: 134)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8484 (Count: 131)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9730 (Count: 177)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.9187 (Count: 151)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9511 (Count: 150)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9444 (Count: 168)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9498 (Count: 182)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9448 (Count: 182)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9646 (Count: 159)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9335 (Count: 789)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9650 (Count: 352)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9550 (Count: 153)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9453 (Count: 159)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9500 (Count: 223)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9416 (Count: 163)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8990 (Count: 140)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9546 (Count: 149)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9405 (Count: 139)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9385 (Count: 794)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9736 (Count: 288)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9710 (Count: 171)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9620 (Count: 135)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9597 (Count: 326)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9316 (Count: 137)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9378 (Count: 293)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9597 (Count: 151)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9361 (Count: 281)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9355 (Count: 247)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9210 (Count: 220)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9312 (Count: 796)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9678 (Count: 162)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9426 (Count: 254)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor - ConfidenceMonitor: Processing 9222 validation samples for epoch 100.
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor - --- Confidence Metrics (Epoch 100) ---
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -   Accuracy:             0.9936
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -   Mean Confidence:      0.9435 | Median: 0.9625 | Min: 0.2182
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -   Low Conf (<0.70):    2.18% (201/9222)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -   ECE (15 bins):         0.0503
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -   Per-Class Mean Confidence (Correct Predictions):
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 0: 0.9402 (Count: 160)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 1: 0.9758 (Count: 138)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 2: 0.9848 (Count: 151)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 3: 0.9539 (Count: 252)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 4: 0.9641 (Count: 161)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 5: 0.9679 (Count: 206)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 6: 0.9691 (Count: 139)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 7: 0.9611 (Count: 134)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 8: 0.8484 (Count: 131)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 9: 0.9730 (Count: 177)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 10: 0.9187 (Count: 151)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 11: 0.9511 (Count: 150)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 12: 0.9444 (Count: 168)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 13: 0.9498 (Count: 182)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 14: 0.9448 (Count: 182)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 15: 0.9646 (Count: 159)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 16: 0.9335 (Count: 789)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 17: 0.9650 (Count: 352)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 18: 0.9550 (Count: 153)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 19: 0.9453 (Count: 159)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 20: 0.9500 (Count: 223)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 21: 0.9416 (Count: 163)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 22: 0.8990 (Count: 140)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 23: 0.9546 (Count: 149)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 24: 0.9405 (Count: 139)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 25: 0.9385 (Count: 794)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 26: 0.9736 (Count: 288)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 27: 0.9710 (Count: 171)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 28: 0.9620 (Count: 135)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 29: 0.9597 (Count: 326)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 30: 0.9316 (Count: 137)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 31: 0.9378 (Count: 293)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 32: 0.9597 (Count: 151)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 33: 0.9361 (Count: 281)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 34: 0.9355 (Count: 247)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 35: 0.9210 (Count: 220)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 36: 0.9312 (Count: 796)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 37: 0.9678 (Count: 162)
2025-04-15 16:40:46 | INFO     | core.training.callbacks.confidence_monitor -     Class 38: 0.9426 (Count: 254)
2025-04-15 16:40:46 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 16:40:46 | WARNING  | core.training.callbacks.swa - SWACallback: No val_loader, test_loader, or train_loader found in any context. BN stats update skipped.
2025-04-15 16:40:46 | INFO     | core.training.callbacks.model_checkpoint - Epoch 100: val_loss improved from 1.077230 to 1.070414.
2025-04-15 16:40:47 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 100)
2025-04-15 16:40:47 | INFO     | core.training.callbacks.model_checkpoint - Epoch 100: val_loss improved from 1.077230 to 1.070414.
2025-04-15 16:40:47 | INFO     | core.training.callbacks.model_checkpoint - Checkpoint saved: 'best_model.pth' (Epoch 100)
2025-04-15 16:40:47 | INFO     | core.training.callbacks.early_stopping - Epoch 100: EarlyStopping val_loss improved from 1.077230 to 1.070414
2025-04-15 16:40:47 | INFO     | core.training.callbacks.early_stopping - Epoch 100: EarlyStopping val_loss improved from 1.077230 to 1.070414
2025-04-15 16:40:47 | INFO     | core.training.callbacks.gradcam_callback - Generating GradCAM visualizations at epoch 100
2025-04-15 16:40:47 | INFO     | core.models.model_cbam18 - Using layer4[-1].conv2 as GradCAM target layer
2025-04-15 16:40:47 | INFO     | core.evaluation.interpretability - Using model's recommended GradCAM target layer
2025-04-15 16:40:47 | INFO     | core.evaluation.interpretability - GradCAM initialized with target layer: Conv2d
2025-04-15 16:41:05 | INFO     | core.training.callbacks.gradcam_callback - Generated summary HTML: outputs/cbam_only_resnet18_v2/gradcam/epoch_100/gradcam_summary.html
2025-04-15 16:41:05 | INFO     | core.training.callbacks.gradcam_callback - GradCAM visualizations saved to outputs/cbam_only_resnet18_v2/gradcam/epoch_100
2025-04-15 16:41:05 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 100: Captured validation outputs and targets for visualization.
2025-04-15 16:41:05 | INFO     | core.training.callbacks.visualization_data_saver - Epoch 100: Captured validation outputs and targets for visualization.
2025-04-15 16:41:05 | INFO     | core.training.train - Including metrics for 39 classes in final logs
2025-04-15 16:41:05 | INFO     | core.training.callbacks.confidence_monitor - Saved confidence history to outputs/cbam_only_resnet18_v2/metrics/confidence_history.json
2025-04-15 16:41:05 | INFO     | core.visualization.flows.confidence_viz - Saved confidence timeline plot to outputs/cbam_only_resnet18_v2/reports/plots/confidence/confidence_timeline.png
2025-04-15 16:41:06 | INFO     | core.visualization.flows.confidence_viz - Saved confidence distribution plot to outputs/cbam_only_resnet18_v2/reports/plots/confidence/confidence_by_class.png
2025-04-15 16:41:06 | INFO     | core.visualization.flows.confidence_viz - Generated 2 confidence visualization plots in outputs/cbam_only_resnet18_v2/reports/plots/confidence
2025-04-15 16:41:06 | INFO     | core.training.callbacks.confidence_monitor - Generated confidence visualizations in outputs/cbam_only_resnet18_v2/reports/plots/confidence
2025-04-15 16:41:06 | INFO     | core.training.callbacks.confidence_monitor - Saved confidence history to outputs/cbam_only_resnet18_v2/metrics/confidence_history.json
2025-04-15 16:41:06 | INFO     | core.visualization.flows.confidence_viz - Saved confidence timeline plot to outputs/cbam_only_resnet18_v2/reports/plots/confidence/confidence_timeline.png
2025-04-15 16:41:06 | INFO     | core.visualization.flows.confidence_viz - Saved confidence distribution plot to outputs/cbam_only_resnet18_v2/reports/plots/confidence/confidence_by_class.png
2025-04-15 16:41:06 | INFO     | core.visualization.flows.confidence_viz - Generated 2 confidence visualization plots in outputs/cbam_only_resnet18_v2/reports/plots/confidence
2025-04-15 16:41:06 | INFO     | core.training.callbacks.confidence_monitor - Generated confidence visualizations in outputs/cbam_only_resnet18_v2/reports/plots/confidence
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Added class metrics from logs to final metrics
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Added confusion matrix from logs to final metrics
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Found class metrics in final metrics, processing them for report
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Processed metrics for 3 classes
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Saved metrics.json to outputs/cbam_only_resnet18_v2/metrics/metrics.json
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Saved history.json to outputs/cbam_only_resnet18_v2/metrics/history.json
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Saved class names to outputs/cbam_only_resnet18_v2/class_names.txt
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Saved confusion matrix to outputs/cbam_only_resnet18_v2/evaluation_artifacts/confusion_matrix.npy
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Final metrics saved to outputs/cbam_only_resnet18_v2/metrics/training_metrics.json
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Added class metrics from logs to final metrics
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Added confusion matrix from logs to final metrics
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Found class metrics in final metrics, processing them for report
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Processed metrics for 3 classes
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Saved metrics.json to outputs/cbam_only_resnet18_v2/metrics/metrics.json
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Saved history.json to outputs/cbam_only_resnet18_v2/metrics/history.json
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Saved class names to outputs/cbam_only_resnet18_v2/class_names.txt
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Saved confusion matrix to outputs/cbam_only_resnet18_v2/evaluation_artifacts/confusion_matrix.npy
2025-04-15 16:41:06 | INFO     | core.training.callbacks.metrics_logger - Final metrics saved to outputs/cbam_only_resnet18_v2/metrics/training_metrics.json
2025-04-15 16:41:06 | INFO     | core.training.callbacks.swa - SWA phase completed.
2025-04-15 16:41:06 | INFO     | core.training.callbacks.swa - Saved SWA model to outputs/cbam_only_resnet18_v2/swa/swa_model.pth
2025-04-15 16:41:06 | INFO     | core.training.callbacks.swa - SWA phase completed.
2025-04-15 16:41:06 | INFO     | core.training.callbacks.swa - Saved SWA model to outputs/cbam_only_resnet18_v2/swa/swa_model.pth
2025-04-15 16:41:06 | INFO     | core.training.callbacks.early_stopping - Training completed without early stopping.
2025-04-15 16:41:06 | INFO     | core.training.callbacks.early_stopping - Training completed without early stopping.
2025-04-15 16:41:06 | INFO     | core.training.callbacks.shap_callback - Running SHAP analysis at the end of training...
2025-04-15 16:41:06 | WARNING  | core.training.callbacks.shap_callback - No dataloader found for test split and no data_module available
2025-04-15 16:41:06 | INFO     | core.training.callbacks.shap_callback - Falling back to validation dataset for SHAP analysis
2025-04-15 16:41:06 | INFO     | core.training.callbacks.shap_callback - SHAP results will be saved to: outputs/cbam_only_resnet18_v2/reports/plots/shap_analysis
2025-04-15 16:41:06 | INFO     | core.training.callbacks.shap_callback - Using 39 class names from logs
2025-04-15 16:41:06 | INFO     | core.training.callbacks.shap_callback - Checking input tensor format before SHAP analysis...
2025-04-15 16:41:06 | INFO     | core.training.callbacks.shap_callback - Input tensor shape: torch.Size([128, 3, 224, 224]), dtype: torch.float32
2025-04-15 16:41:06 | INFO     | core.training.callbacks.shap_callback - Target tensor shape: torch.Size([128]), dtype: torch.int64
2025-04-15 16:41:06 | INFO     | core.evaluation.shap_evaluation - Initializing SHAP interpreter for model interpretation
2025-04-15 16:41:06 | INFO     | core.evaluation.shap_interpreter - Creating 20 random background samples
2025-04-15 16:41:06 | INFO     | core.evaluation.shap_interpreter - Using DeepExplainer for ResNet-based architecture
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Initialized SHAP interpreter for CBAMResNet18Model
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_evaluation - Generating SHAP explanations for 20 samples
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Creating 100 random background samples
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Using DeepExplainer for ResNet-based architecture
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Initialized SHAP interpreter for CBAMResNet18Model
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 1/20: Background_without_leaves
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 0: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 2/20: Potato_healthy
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 1: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 3/20: Soybean_healthy
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 2: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 4/20: Grape_leaf_blight
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 3: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 5/20: Peach_bacterial_spot
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 4: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 6/20: Tomato_leaf_mold
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 5: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 7/20: Soybean_healthy
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 6: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 8/20: Corn_gray_leaf_spot
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 7: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 9/20: Corn_northern_leaf_blight
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 8: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 10/20: Potato_healthy
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 9: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 11/20: Apple_healthy
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 10: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 12/20: Squash_powdery_mildew
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 11: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 13/20: Tomato_spider_mites_two-spotted_spider_mite
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 12: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:07 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 14/20: Tomato_target_spot
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 13: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 15/20: Peach_healthy
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 14: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 16/20: Raspberry_healthy
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 15: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 17/20: Raspberry_healthy
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 16: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 18/20: Orange_haunglongbing
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 17: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 19/20: Tomato_leaf_mold
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 18: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 20/20: Tomato_mosaic_virus
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 19: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Calculating feature importance across 100 samples
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Using KernelExplainer as safer alternative to DeepExplainer
2025-04-15 16:41:08 | WARNING  | core.evaluation.shap_interpreter - Runtime error in SHAP calculation: Can't call numpy() on Tensor that requires grad. Use tensor.detach().numpy() instead.
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Using simple KernelExplainer fallback
2025-04-15 16:41:08 | ERROR    | core.evaluation.shap_interpreter - Error in feature_importance: Instance must have 1 or 2 dimensions!
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 1083, in feature_importance
    sample_numpy = reduced_sample_tensor.cpu().numpy()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Can't call numpy() on Tensor that requires grad. Use tensor.detach().numpy() instead.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 1121, in feature_importance
    all_shap_values = kernel_explainer.shap_values(sample_numpy, nsamples=50)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_kernel.py", line 298, in shap_values
    raise DimensionError(emsg)
shap.utils._exceptions.DimensionError: Instance must have 1 or 2 dimensions!
2025-04-15 16:41:08 | ERROR    | core.training.callbacks.shap_callback - Error in SHAP callback: Instance must have 1 or 2 dimensions!
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 1083, in feature_importance
    sample_numpy = reduced_sample_tensor.cpu().numpy()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Can't call numpy() on Tensor that requires grad. Use tensor.detach().numpy() instead.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/training/callbacks/shap_callback.py", line 277, in on_train_end
    results = evaluate_with_shap(
              ^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/evaluation/shap_evaluation.py", line 88, in evaluate_with_shap
    batch_results = batch_explain_with_shap(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 1566, in batch_explain_with_shap
    interpreter.feature_importance(
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 1121, in feature_importance
    all_shap_values = kernel_explainer.shap_values(sample_numpy, nsamples=50)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_kernel.py", line 298, in shap_values
    raise DimensionError(emsg)
shap.utils._exceptions.DimensionError: Instance must have 1 or 2 dimensions!
2025-04-15 16:41:08 | INFO     | core.training.callbacks.shap_callback - Running SHAP analysis at the end of training...
2025-04-15 16:41:08 | WARNING  | core.training.callbacks.shap_callback - No dataloader found for test split and no data_module available
2025-04-15 16:41:08 | INFO     | core.training.callbacks.shap_callback - Falling back to validation dataset for SHAP analysis
2025-04-15 16:41:08 | INFO     | core.training.callbacks.shap_callback - SHAP results will be saved to: outputs/cbam_only_resnet18_v2/reports/plots/shap_analysis
2025-04-15 16:41:08 | INFO     | core.training.callbacks.shap_callback - Using 39 class names from logs
2025-04-15 16:41:08 | INFO     | core.training.callbacks.shap_callback - Checking input tensor format before SHAP analysis...
2025-04-15 16:41:08 | INFO     | core.training.callbacks.shap_callback - Input tensor shape: torch.Size([128, 3, 224, 224]), dtype: torch.float32
2025-04-15 16:41:08 | INFO     | core.training.callbacks.shap_callback - Target tensor shape: torch.Size([128]), dtype: torch.int64
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_evaluation - Initializing SHAP interpreter for model interpretation
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Creating 20 random background samples
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Using DeepExplainer for ResNet-based architecture
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Initialized SHAP interpreter for CBAMResNet18Model
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_evaluation - Generating SHAP explanations for 20 samples
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Creating 100 random background samples
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Using DeepExplainer for ResNet-based architecture
2025-04-15 16:41:08 | INFO     | core.evaluation.shap_interpreter - Initialized SHAP interpreter for CBAMResNet18Model
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 1/20: Background_without_leaves
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 0: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 2/20: Potato_healthy
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 1: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 3/20: Soybean_healthy
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 2: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 4/20: Grape_leaf_blight
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 3: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 5/20: Peach_bacterial_spot
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 4: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 6/20: Tomato_leaf_mold
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 5: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 7/20: Soybean_healthy
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 6: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 8/20: Corn_gray_leaf_spot
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 7: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 9/20: Corn_northern_leaf_blight
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 8: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 10/20: Potato_healthy
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 9: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 11/20: Apple_healthy
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 10: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 12/20: Squash_powdery_mildew
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 11: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 13/20: Tomato_spider_mites_two-spotted_spider_mite
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 12: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 14/20: Tomato_target_spot
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 13: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 15/20: Peach_healthy
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 14: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 16/20: Raspberry_healthy
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 15: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 17/20: Raspberry_healthy
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 16: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 18/20: Orange_haunglongbing
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 17: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 19/20: Tomato_leaf_mold
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 18: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Generating SHAP for sample 20/20: Tomato_mosaic_virus
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in visualize_shap: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 545, in visualize_shap
    shap_values = self.explainer.shap_values(input_with_grad.clone())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/__init__.py", line 164, in shap_values
    return self.explainer.shap_values(X, ranked_outputs, output_rank_order, check_additivity=check_additivity)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 189, in shap_values
    sample_phis = self.gradient(feature_ind, joint_x)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_deep/deep_pytorch.py", line 102, in gradient
    outputs = self.model(*X)
              ^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/base.py", line 128, in forward
    features = self.backbone(x)
               ^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/cbam_resnet18.py", line 439, in forward
    x = self.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/backbones/blocks.py", line 72, in forward
    out = self.ca(out) * out
          ^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/models/attention.py", line 44, in forward
    avg_out = self.mlp(self.avg_pool(x))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
           ^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1793, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
             ^^^^^^^^^^^^^^^^^^
RuntimeError: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error generating SHAP for sample 19: Output 0 of BackwardHookFunctionBackward is a view and is being modified inplace. This view was created inside a custom Function (or because an input was returned as-is) and the autograd logic to handle view+inplace would override the custom backward associated with the custom Function, leading to incorrect gradients. This behavior is forbidden. You can fix this by cloning the output of the custom Function.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Calculating feature importance across 100 samples
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Using KernelExplainer as safer alternative to DeepExplainer
2025-04-15 16:41:09 | WARNING  | core.evaluation.shap_interpreter - Runtime error in SHAP calculation: Can't call numpy() on Tensor that requires grad. Use tensor.detach().numpy() instead.
2025-04-15 16:41:09 | INFO     | core.evaluation.shap_interpreter - Using simple KernelExplainer fallback
2025-04-15 16:41:09 | ERROR    | core.evaluation.shap_interpreter - Error in feature_importance: Instance must have 1 or 2 dimensions!
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 1083, in feature_importance
    sample_numpy = reduced_sample_tensor.cpu().numpy()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Can't call numpy() on Tensor that requires grad. Use tensor.detach().numpy() instead.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 1121, in feature_importance
    all_shap_values = kernel_explainer.shap_values(sample_numpy, nsamples=50)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_kernel.py", line 298, in shap_values
    raise DimensionError(emsg)
shap.utils._exceptions.DimensionError: Instance must have 1 or 2 dimensions!
2025-04-15 16:41:09 | ERROR    | core.training.callbacks.shap_callback - Error in SHAP callback: Instance must have 1 or 2 dimensions!
Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 1083, in feature_importance
    sample_numpy = reduced_sample_tensor.cpu().numpy()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Can't call numpy() on Tensor that requires grad. Use tensor.detach().numpy() instead.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jeremy/plantdoc/core/training/callbacks/shap_callback.py", line 277, in on_train_end
    results = evaluate_with_shap(
              ^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/evaluation/shap_evaluation.py", line 88, in evaluate_with_shap
    batch_results = batch_explain_with_shap(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 1566, in batch_explain_with_shap
    interpreter.feature_importance(
  File "/Users/jeremy/plantdoc/core/evaluation/shap_interpreter.py", line 1121, in feature_importance
    all_shap_values = kernel_explainer.shap_values(sample_numpy, nsamples=50)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jeremy/miniforge3/envs/plantdoc-mps/lib/python3.11/site-packages/shap/explainers/_kernel.py", line 298, in shap_values
    raise DimensionError(emsg)
shap.utils._exceptions.DimensionError: Instance must have 1 or 2 dimensions!
2025-04-15 16:41:09 | INFO     | core.training.callbacks.visualization_data_saver - VisualizationDataSaver: Saving visualization data at the end of training
2025-04-15 16:41:09 | INFO     | core.training.callbacks.visualization_data_saver - Available keys: dict_keys(['total_time', 'best_val_loss', 'best_val_acc', 'best_epoch', 'best_monitor_metric_value', 'model', 'optimizer', 'history', 'config', 'class_metrics', 'confusion_matrix', 'train_loader', 'val_loader', 'data_module', 'class_names'])
2025-04-15 16:41:09 | INFO     | core.training.callbacks.visualization_data_saver - Saved predictions to outputs/cbam_only_resnet18_v2/evaluation_artifacts/predictions.npy and legacy location
2025-04-15 16:41:09 | INFO     | core.training.callbacks.visualization_data_saver - Saved true_labels to outputs/cbam_only_resnet18_v2/evaluation_artifacts/true_labels.npy and legacy location
2025-04-15 16:41:09 | INFO     | core.training.callbacks.visualization_data_saver - Saved scores to outputs/cbam_only_resnet18_v2/evaluation_artifacts/scores.npy and legacy location
2025-04-15 16:41:09 | INFO     | core.training.callbacks.visualization_data_saver - Saved subset_true_labels to outputs/cbam_only_resnet18_v2/evaluation_artifacts/subset_true_labels.npy and legacy location
2025-04-15 16:41:09 | INFO     | core.training.callbacks.visualization_data_saver - Saved subset of true labels (20) to match test_images size
2025-04-15 16:41:09 | INFO     | core.training.callbacks.visualization_data_saver - Saved predictions, true labels, and scores for 9222 samples
2025-04-15 16:41:09 | INFO     | core.training.callbacks.visualization_data_saver - Using backbone.backbone.layer4[-1] for CBAM feature extraction
2025-04-15 16:41:09 | INFO     | core.training.callbacks.visualization_data_saver - Using backbone.global_pool for feature extraction
2025-04-15 16:41:09 | INFO     | core.training.callbacks.visualization_data_saver - Set up feature extraction hooks for model type: cbam_only_resnet18
2025-04-15 16:41:09 | INFO     | core.training.callbacks.visualization_data_saver - Running validation batches to extract features...
2025-04-15 16:41:09 | INFO     | core.training.callbacks.visualization_data_saver - Need to extract features for 9222 samples to match true_labels
2025-04-15 16:41:09 | INFO     | core.training.callbacks.visualization_data_saver - Processing batch 1 with 128 inputs on device mps:0
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Successfully extracted features from batch 1
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Processing batch 2 with 128 inputs on device mps:0
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Successfully extracted features from batch 2
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Processing batch 3 with 128 inputs on device mps:0
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Successfully extracted features from batch 3
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Processing batch 4 with 128 inputs on device mps:0
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Successfully extracted features from batch 4
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Processing batch 5 with 128 inputs on device mps:0
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Successfully extracted features from batch 5
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Processed 5 batches with approx. 640 samples for feature extraction
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Saved features to outputs/cbam_only_resnet18_v2/evaluation_artifacts/features.npy and legacy location
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Features shape: torch.Size([128, 512, 7, 7])
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Saved test_images to outputs/cbam_only_resnet18_v2/evaluation_artifacts/test_images.npy and legacy location
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Saved 20 test images for visualization
2025-04-15 16:41:10 | INFO     | core.training.callbacks.visualization_data_saver - Found transforms for augmentation examples: <core.data.transforms.AlbumentationsWrapper object at 0x35c2b1490>
2025-04-15 16:41:10 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:41:11 | INFO     | scripts.generate_augmentations - Created augmentation grid: outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_1.png
2025-04-15 16:41:11 | INFO     | core.training.callbacks.visualization_data_saver - Saved augmentation example to outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_1.png
2025-04-15 16:41:11 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:41:12 | INFO     | scripts.generate_augmentations - Created augmentation grid: outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_2.png
2025-04-15 16:41:12 | INFO     | core.training.callbacks.visualization_data_saver - Saved augmentation example to outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_2.png
2025-04-15 16:41:12 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:41:13 | INFO     | scripts.generate_augmentations - Created augmentation grid: outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_3.png
2025-04-15 16:41:13 | INFO     | core.training.callbacks.visualization_data_saver - Saved augmentation example to outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_3.png
2025-04-15 16:41:13 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:41:14 | INFO     | scripts.generate_augmentations - Created augmentation grid: outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_4.png
2025-04-15 16:41:14 | INFO     | core.training.callbacks.visualization_data_saver - Saved augmentation example to outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_4.png
2025-04-15 16:41:14 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:41:15 | INFO     | scripts.generate_augmentations - Created augmentation grid: outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_5.png
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Saved augmentation example to outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_5.png
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Using default dataset directory: /Users/jeremy/plantdoc/data/processed
2025-04-15 16:41:15 | INFO     | core.visualization.flows.confusion_flow - Copied 12 dataset analysis images to outputs/cbam_only_resnet18_v2/reports/plots/dataset_analysis
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Successfully copied dataset analysis from /Users/jeremy/plantdoc/data/processed
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Loaded confusion matrix with shape (39, 39)
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Using 39 class names for confusion flow
2025-04-15 16:41:15 | INFO     | core.visualization.flows.confusion_flow - Saved confusion flow diagram to outputs/cbam_only_resnet18_v2/reports/plots/confusion_flow/confusion_flow.png
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Generated confusion flow visualization at outputs/cbam_only_resnet18_v2/reports/plots/confusion_flow/confusion_flow.png
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Finished saving data for enhanced visualizations
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - VisualizationDataSaver: Saving visualization data at the end of training
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Available keys: dict_keys(['total_time', 'best_val_loss', 'best_val_acc', 'best_epoch', 'best_monitor_metric_value', 'model', 'optimizer', 'history', 'config', 'class_metrics', 'confusion_matrix', 'train_loader', 'val_loader', 'data_module', 'class_names'])
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Saved predictions to outputs/cbam_only_resnet18_v2/evaluation_artifacts/predictions.npy and legacy location
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Saved true_labels to outputs/cbam_only_resnet18_v2/evaluation_artifacts/true_labels.npy and legacy location
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Saved scores to outputs/cbam_only_resnet18_v2/evaluation_artifacts/scores.npy and legacy location
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Saved subset_true_labels to outputs/cbam_only_resnet18_v2/evaluation_artifacts/subset_true_labels.npy and legacy location
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Saved subset of true labels (20) to match test_images size
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Saved predictions, true labels, and scores for 9222 samples
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Using backbone.backbone.layer4[-1] for CBAM feature extraction
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Using backbone.global_pool for feature extraction
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Set up feature extraction hooks for model type: cbam_only_resnet18
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Running validation batches to extract features...
2025-04-15 16:41:15 | INFO     | core.training.callbacks.visualization_data_saver - Need to extract features for 9222 samples to match true_labels
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Processing batch 1 with 128 inputs on device mps:0
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Successfully extracted features from batch 1
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Processing batch 2 with 128 inputs on device mps:0
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Successfully extracted features from batch 2
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Processing batch 3 with 128 inputs on device mps:0
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Successfully extracted features from batch 3
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Processing batch 4 with 128 inputs on device mps:0
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Successfully extracted features from batch 4
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Processing batch 5 with 128 inputs on device mps:0
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Successfully extracted features from batch 5
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Processed 5 batches with approx. 640 samples for feature extraction
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Saved features to outputs/cbam_only_resnet18_v2/evaluation_artifacts/features.npy and legacy location
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Features shape: torch.Size([128, 512, 7, 7])
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Saved test_images to outputs/cbam_only_resnet18_v2/evaluation_artifacts/test_images.npy and legacy location
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Saved 20 test images for visualization
2025-04-15 16:41:16 | INFO     | core.training.callbacks.visualization_data_saver - Found transforms for augmentation examples: <core.data.transforms.AlbumentationsWrapper object at 0x35c2b1490>
2025-04-15 16:41:16 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:41:17 | INFO     | scripts.generate_augmentations - Created augmentation grid: outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_1.png
2025-04-15 16:41:17 | INFO     | core.training.callbacks.visualization_data_saver - Saved augmentation example to outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_1.png
2025-04-15 16:41:17 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:41:18 | INFO     | scripts.generate_augmentations - Created augmentation grid: outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_2.png
2025-04-15 16:41:18 | INFO     | core.training.callbacks.visualization_data_saver - Saved augmentation example to outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_2.png
2025-04-15 16:41:18 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:41:19 | INFO     | scripts.generate_augmentations - Created augmentation grid: outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_3.png
2025-04-15 16:41:19 | INFO     | core.training.callbacks.visualization_data_saver - Saved augmentation example to outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_3.png
2025-04-15 16:41:19 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:41:20 | INFO     | scripts.generate_augmentations - Created augmentation grid: outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_4.png
2025-04-15 16:41:20 | INFO     | core.training.callbacks.visualization_data_saver - Saved augmentation example to outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_4.png
2025-04-15 16:41:20 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:41:21 | INFO     | scripts.generate_augmentations - Created augmentation grid: outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_5.png
2025-04-15 16:41:21 | INFO     | core.training.callbacks.visualization_data_saver - Saved augmentation example to outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_example_5.png
2025-04-15 16:41:21 | INFO     | core.training.callbacks.visualization_data_saver - Using default dataset directory: /Users/jeremy/plantdoc/data/processed
2025-04-15 16:41:21 | INFO     | core.visualization.flows.confusion_flow - Copied 12 dataset analysis images to outputs/cbam_only_resnet18_v2/reports/plots/dataset_analysis
2025-04-15 16:41:21 | INFO     | core.training.callbacks.visualization_data_saver - Successfully copied dataset analysis from /Users/jeremy/plantdoc/data/processed
2025-04-15 16:41:21 | INFO     | core.training.callbacks.visualization_data_saver - Loaded confusion matrix with shape (39, 39)
2025-04-15 16:41:21 | INFO     | core.training.callbacks.visualization_data_saver - Using 39 class names for confusion flow
2025-04-15 16:41:22 | INFO     | core.visualization.flows.confusion_flow - Saved confusion flow diagram to outputs/cbam_only_resnet18_v2/reports/plots/confusion_flow/confusion_flow.png
2025-04-15 16:41:22 | INFO     | core.training.callbacks.visualization_data_saver - Generated confusion flow visualization at outputs/cbam_only_resnet18_v2/reports/plots/confusion_flow/confusion_flow.png
2025-04-15 16:41:22 | INFO     | core.training.callbacks.visualization_data_saver - Finished saving data for enhanced visualizations
2025-04-15 16:41:22 | INFO     | core.training.train - ===== Training Finished in 03h 14m 43.95s =====
2025-04-15 16:41:22 | INFO     | core.training.train - Best Epoch: 100, Best Val Loss: 1.0704 (Loss: 1.0704, Acc: 0.9936)
2025-04-15 16:41:22 | INFO     | core.training.train - Successfully calculated metrics for 39 classes
2025-04-15 16:42:22 | INFO     | __main__ - Training completed. Best validation accuracy: 0.9936
2025-04-15 16:42:22 | INFO     | utils.experiment_registry - Updated experiment info for outputs/cbam_only_resnet18_v2
2025-04-15 16:42:22 | INFO     | __main__ - Updated experiment registry with training results
2025-04-15 16:42:22 | INFO     | __main__ - Generating plots...
2025-04-15 16:42:22 | INFO     | reports.generate_plots - Generating plots for experiment in /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2
2025-04-15 16:42:22 | INFO     | reports.generate_plots - Output directory: /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots
2025-04-15 16:42:22 | INFO     | reports.generate_plots - Found history file at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/metrics/history.json
2025-04-15 16:42:22 | INFO     | reports.generate_plots - Found metrics file at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/metrics/metrics.json
2025-04-15 16:42:22 | INFO     | reports.generate_plots - Looking for confusion matrix in the following locations:
2025-04-15 16:42:22 | INFO     | reports.generate_plots -   - /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts/confusion_matrix.npy
2025-04-15 16:42:22 | INFO     | reports.generate_plots - Found confusion matrix at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts/confusion_matrix.npy
2025-04-15 16:42:22 | INFO     | reports.generate_plots - Using evaluation artifacts directory: /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts
2025-04-15 16:42:22 | INFO     | reports.generate_plots - Found artifact predictions.npy at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts/predictions.npy
2025-04-15 16:42:22 | INFO     | reports.generate_plots - Found artifact features.npy at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts/features.npy
2025-04-15 16:42:22 | INFO     | reports.generate_plots - Found artifact true_labels.npy at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts/true_labels.npy
2025-04-15 16:42:22 | INFO     | reports.generate_plots - Found artifact scores.npy at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts/scores.npy
2025-04-15 16:42:22 | INFO     | reports.generate_plots - Found artifact test_images.npy at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts/test_images.npy
2025-04-15 16:42:22 | INFO     | reports.generate_plots - Found the following artifacts:
2025-04-15 16:42:22 | INFO     | reports.generate_plots -   - predictions: 
2025-04-15 16:42:22 | INFO     | reports.generate_plots -   - features: 
2025-04-15 16:42:22 | INFO     | reports.generate_plots -   - true_labels: 
2025-04-15 16:42:22 | INFO     | reports.generate_plots -   - scores: 
2025-04-15 16:42:22 | INFO     | reports.generate_plots -   - test_images: 
2025-04-15 16:42:22 | INFO     | reports.generate_plots -   - misclassified_indices: 
2025-04-15 16:42:22 | INFO     | reports.generate_plots -   - per_class_metrics: 
2025-04-15 16:42:22 | INFO     | reports.generate_plots -   - calibration_data: 
2025-04-15 16:42:22 | INFO     | reports.generate_plots -   - embeddings: 
2025-04-15 16:42:22 | INFO     | reports.generate_plots - No visualization_theme found in config, using default dark theme
2025-04-15 16:42:22 | INFO     | reports.generate_plots - No matching SHAP visualizations found
2025-04-15 16:42:22 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:23 | INFO     | core.visualization.base_visualization - Saved training history plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/training_history.png
2025-04-15 16:42:23 | INFO     | reports.generate_plots - Saved training history plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/training_history.png
2025-04-15 16:42:23 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:23 | INFO     | core.visualization.base_visualization - Saved learning rate plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/learning_rate.png
2025-04-15 16:42:23 | INFO     | reports.generate_plots - Saved learning rate plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/learning_rate.png
2025-04-15 16:42:23 | INFO     | reports.generate_plots - Using enhanced confusion matrix visualization
2025-04-15 16:42:23 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:24 | INFO     | core.visualization.visualization - Saved enhanced confusion matrix plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/confusion_matrix.png
2025-04-15 16:42:24 | INFO     | reports.generate_plots - Saved confusion matrix plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/confusion_matrix.png
2025-04-15 16:42:24 | INFO     | reports.generate_plots - Using enhanced visualization
2025-04-15 16:42:24 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:25 | INFO     | core.visualization.visualization - Saved ROC curve plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/roc_curves.png
2025-04-15 16:42:25 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:26 | INFO     | core.visualization.visualization - Saved precision-recall curve plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/precision_recall_curves.png
2025-04-15 16:42:26 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:26 | INFO     | core.visualization.visualization - Saved confidence distribution plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/confidence_distribution.png
2025-04-15 16:42:26 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:26 | INFO     | core.visualization.visualization - Saved histogram plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/confidence_histogram.png
2025-04-15 16:42:26 | INFO     | reports.generate_plots - Generated confidence histogram
2025-04-15 16:42:26 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:27 | INFO     | core.visualization.visualization - Saved categorical plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/prediction_distribution.png
2025-04-15 16:42:27 | INFO     | reports.generate_plots - Generated prediction distribution
2025-04-15 16:42:28 | INFO     | reports.generate_plots - Created classification examples grid with 11 images
2025-04-15 16:42:28 | INFO     | reports.generate_plots - Generated classification examples grid
2025-04-15 16:42:28 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:28 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:28 | INFO     | core.visualization.visualization - Saved augmentation grid to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/augmentation.png
2025-04-15 16:42:28 | INFO     | reports.generate_plots - Generated augmentation visualization
2025-04-15 16:42:28 | INFO     | reports.generate_plots - Computing feature space visualization from raw features
2025-04-15 16:42:28 | INFO     | reports.generate_plots - Reshaped features from (128, 512, 7, 7) to (128, 25088)
2025-04-15 16:42:28 | WARNING  | reports.generate_plots - Features length (128) doesn't match labels length (9222). Truncating to the minimum length.
2025-04-15 16:42:28 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:30 | INFO     | core.visualization.visualization - Saved feature space visualization to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/feature_space.png
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Generated feature space visualization at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/feature_space.png
2025-04-15 16:42:30 | WARNING  | reports.generate_plots - Error applying augmentation Grayscale: Input image tensor permitted channel values are [1, 3], but found 224
2025-04-15 16:42:30 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:30 | INFO     | core.visualization.visualization - Saved augmentation grid to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_grid.png
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Generated augmentation grid at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_grid.png
2025-04-15 16:42:30 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Finished generating plots for report
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Plots generated for experiment: /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2
2025-04-15 16:42:30 | INFO     | __main__ - Generating training report...
2025-04-15 16:42:30 | INFO     | reports.generate_report - Using experiment directory: /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2
2025-04-15 16:42:30 | INFO     | reports.generate_report - Generating report for experiment in /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2
2025-04-15 16:42:30 | INFO     | reports.generate_report - Output directory: /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports
2025-04-15 16:42:30 | INFO     | reports.generate_report - Generating plots for report
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Generating plots for experiment in /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Output directory: /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Found history file at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/metrics/history.json
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Found metrics file at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/metrics/metrics.json
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Looking for confusion matrix in the following locations:
2025-04-15 16:42:30 | INFO     | reports.generate_plots -   - /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts/confusion_matrix.npy
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Found confusion matrix at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts/confusion_matrix.npy
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Using evaluation artifacts directory: /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Found artifact predictions.npy at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts/predictions.npy
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Found artifact features.npy at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts/features.npy
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Found artifact true_labels.npy at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts/true_labels.npy
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Found artifact scores.npy at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts/scores.npy
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Found artifact test_images.npy at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/evaluation_artifacts/test_images.npy
2025-04-15 16:42:30 | INFO     | reports.generate_plots - Found the following artifacts:
2025-04-15 16:42:30 | INFO     | reports.generate_plots -   - predictions: 
2025-04-15 16:42:30 | INFO     | reports.generate_plots -   - features: 
2025-04-15 16:42:30 | INFO     | reports.generate_plots -   - true_labels: 
2025-04-15 16:42:30 | INFO     | reports.generate_plots -   - scores: 
2025-04-15 16:42:30 | INFO     | reports.generate_plots -   - test_images: 
2025-04-15 16:42:30 | INFO     | reports.generate_plots -   - misclassified_indices: 
2025-04-15 16:42:30 | INFO     | reports.generate_plots -   - per_class_metrics: 
2025-04-15 16:42:30 | INFO     | reports.generate_plots -   - calibration_data: 
2025-04-15 16:42:30 | INFO     | reports.generate_plots -   - embeddings: 
2025-04-15 16:42:30 | INFO     | reports.generate_plots - No visualization_theme found in config, using default dark theme
2025-04-15 16:42:30 | INFO     | reports.generate_plots - No matching SHAP visualizations found
2025-04-15 16:42:30 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:31 | INFO     | core.visualization.base_visualization - Saved training history plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/training_history.png
2025-04-15 16:42:31 | INFO     | reports.generate_plots - Saved training history plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/training_history.png
2025-04-15 16:42:31 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:31 | INFO     | core.visualization.base_visualization - Saved learning rate plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/learning_rate.png
2025-04-15 16:42:31 | INFO     | reports.generate_plots - Saved learning rate plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/learning_rate.png
2025-04-15 16:42:31 | INFO     | reports.generate_plots - Using enhanced confusion matrix visualization
2025-04-15 16:42:31 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:32 | INFO     | core.visualization.visualization - Saved enhanced confusion matrix plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/confusion_matrix.png
2025-04-15 16:42:32 | INFO     | reports.generate_plots - Saved confusion matrix plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/confusion_matrix.png
2025-04-15 16:42:32 | INFO     | reports.generate_plots - Using enhanced visualization
2025-04-15 16:42:32 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:33 | INFO     | core.visualization.visualization - Saved ROC curve plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/roc_curves.png
2025-04-15 16:42:33 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:33 | INFO     | core.visualization.visualization - Saved precision-recall curve plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/precision_recall_curves.png
2025-04-15 16:42:33 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:34 | INFO     | core.visualization.visualization - Saved confidence distribution plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/confidence_distribution.png
2025-04-15 16:42:34 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:34 | INFO     | core.visualization.visualization - Saved histogram plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/confidence_histogram.png
2025-04-15 16:42:34 | INFO     | reports.generate_plots - Generated confidence histogram
2025-04-15 16:42:34 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:35 | INFO     | core.visualization.visualization - Saved categorical plot to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/prediction_distribution.png
2025-04-15 16:42:35 | INFO     | reports.generate_plots - Generated prediction distribution
2025-04-15 16:42:36 | INFO     | reports.generate_plots - Created classification examples grid with 11 images
2025-04-15 16:42:36 | INFO     | reports.generate_plots - Generated classification examples grid
2025-04-15 16:42:36 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:36 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:36 | INFO     | core.visualization.visualization - Saved augmentation grid to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/augmentation.png
2025-04-15 16:42:36 | INFO     | reports.generate_plots - Generated augmentation visualization
2025-04-15 16:42:36 | INFO     | reports.generate_plots - Computing feature space visualization from raw features
2025-04-15 16:42:36 | INFO     | reports.generate_plots - Reshaped features from (128, 512, 7, 7) to (128, 25088)
2025-04-15 16:42:36 | WARNING  | reports.generate_plots - Features length (128) doesn't match labels length (9222). Truncating to the minimum length.
2025-04-15 16:42:36 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:37 | INFO     | core.visualization.visualization - Saved feature space visualization to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/feature_space.png
2025-04-15 16:42:37 | INFO     | reports.generate_plots - Generated feature space visualization at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/feature_space.png
2025-04-15 16:42:37 | WARNING  | reports.generate_plots - Error applying augmentation Grayscale: Input image tensor permitted channel values are [1, 3], but found 224
2025-04-15 16:42:37 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:38 | INFO     | core.visualization.visualization - Saved augmentation grid to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_grid.png
2025-04-15 16:42:38 | INFO     | reports.generate_plots - Generated augmentation grid at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/plots/augmentation/augmentation_grid.png
2025-04-15 16:42:38 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:42:38 | INFO     | reports.generate_plots - Finished generating plots for report
2025-04-15 16:42:38 | INFO     | reports.generate_plots - Plots generated for experiment: /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2
2025-04-15 16:42:38 | INFO     | reports.generate_report - Found training metrics at /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/metrics/training_metrics.json
2025-04-15 16:42:38 | INFO     | reports.generate_report - Rendered template training_report.html to /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/training_report.html
2025-04-15 16:42:38 | WARNING  | reports.generate_report - Assets directory /Users/jeremy/plantdoc/reports/templates/assets does not exist
2025-04-15 16:42:38 | INFO     | reports.generate_report - Report generated: /Users/jeremy/plantdoc/outputs/cbam_only_resnet18_v2/reports/training_report.html
2025-04-15 16:42:38 | INFO     | __main__ - Generating attention visualizations...
2025-04-15 16:43:08 | INFO     | __main__ - Generating attention visualizations for 15 samples
2025-04-15 16:43:08 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:09 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:10 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Raspberry_healthy_spatial.png
2025-04-15 16:43:10 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Raspberry_healthy_channel.png
2025-04-15 16:43:12 | ERROR    | __main__ - Error generating visualization for class Raspberry_healthy: 'NoneType' object is not iterable
2025-04-15 16:43:12 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:12 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:13 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Tomato_Tomato_mosaic_virus_spatial.png
2025-04-15 16:43:13 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Tomato_Tomato_mosaic_virus_channel.png
2025-04-15 16:43:15 | ERROR    | __main__ - Error generating visualization for class Tomato_Tomato_mosaic_virus: 'NoneType' object is not iterable
2025-04-15 16:43:15 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:15 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:16 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Orange_Haunglongbing_Citrus_greening_spatial.png
2025-04-15 16:43:16 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Orange_Haunglongbing_Citrus_greening_channel.png
2025-04-15 16:43:18 | ERROR    | __main__ - Error generating visualization for class Orange_Haunglongbing_Citrus_greening: 'NoneType' object is not iterable
2025-04-15 16:43:18 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:18 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:18 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Corn_Common_rust_spatial.png
2025-04-15 16:43:19 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Corn_Common_rust_channel.png
2025-04-15 16:43:20 | ERROR    | __main__ - Error generating visualization for class Corn_Common_rust: 'NoneType' object is not iterable
2025-04-15 16:43:20 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:20 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:21 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Tomato_Septoria_leaf_spot_spatial.png
2025-04-15 16:43:22 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Tomato_Septoria_leaf_spot_channel.png
2025-04-15 16:43:23 | ERROR    | __main__ - Error generating visualization for class Tomato_Septoria_leaf_spot: 'NoneType' object is not iterable
2025-04-15 16:43:23 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:23 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:24 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Pepper_bell_healthy_spatial.png
2025-04-15 16:43:24 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Pepper_bell_healthy_channel.png
2025-04-15 16:43:26 | ERROR    | __main__ - Error generating visualization for class Pepper_bell_healthy: 'NoneType' object is not iterable
2025-04-15 16:43:26 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:26 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:27 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Grape_healthy_spatial.png
2025-04-15 16:43:27 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Grape_healthy_channel.png
2025-04-15 16:43:29 | ERROR    | __main__ - Error generating visualization for class Grape_healthy: 'NoneType' object is not iterable
2025-04-15 16:43:29 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:29 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:30 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Squash_Powdery_mildew_spatial.png
2025-04-15 16:43:30 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Squash_Powdery_mildew_channel.png
2025-04-15 16:43:31 | ERROR    | __main__ - Error generating visualization for class Squash_Powdery_mildew: 'NoneType' object is not iterable
2025-04-15 16:43:31 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:31 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:32 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Potato_Late_blight_spatial.png
2025-04-15 16:43:33 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Potato_Late_blight_channel.png
2025-04-15 16:43:34 | ERROR    | __main__ - Error generating visualization for class Potato_Late_blight: 'NoneType' object is not iterable
2025-04-15 16:43:34 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:34 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:35 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Soybean_healthy_spatial.png
2025-04-15 16:43:35 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Soybean_healthy_channel.png
2025-04-15 16:43:37 | ERROR    | __main__ - Error generating visualization for class Soybean_healthy: 'NoneType' object is not iterable
2025-04-15 16:43:37 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:37 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:38 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Blueberry_healthy_spatial.png
2025-04-15 16:43:38 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Blueberry_healthy_channel.png
2025-04-15 16:43:40 | ERROR    | __main__ - Error generating visualization for class Blueberry_healthy: 'NoneType' object is not iterable
2025-04-15 16:43:40 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:40 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:40 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Grape_Leaf_blight_Isariopsis_Leaf_Spot_spatial.png
2025-04-15 16:43:41 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Grape_Leaf_blight_Isariopsis_Leaf_Spot_channel.png
2025-04-15 16:43:43 | ERROR    | __main__ - Error generating visualization for class Grape_Leaf_blight_Isariopsis_Leaf_Spot: 'NoneType' object is not iterable
2025-04-15 16:43:43 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:43 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:43 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Tomato_Tomato_Yellow_Leaf_Curl_Virus_spatial.png
2025-04-15 16:43:44 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Tomato_Tomato_Yellow_Leaf_Curl_Virus_channel.png
2025-04-15 16:43:45 | ERROR    | __main__ - Error generating visualization for class Tomato_Tomato_Yellow_Leaf_Curl_Virus: 'NoneType' object is not iterable
2025-04-15 16:43:45 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:45 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:46 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Corn_healthy_spatial.png
2025-04-15 16:43:47 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Corn_healthy_channel.png
2025-04-15 16:43:48 | ERROR    | __main__ - Error generating visualization for class Corn_healthy: 'NoneType' object is not iterable
2025-04-15 16:43:48 | INFO     | __main__ - Prepared image: original size (224, 224), tensor shape torch.Size([3, 224, 224])
2025-04-15 16:43:48 | INFO     | core.visualization.base_visualization - Applied dark theme with #121212 background
2025-04-15 16:43:49 | INFO     | core.visualization.attention_viz - Saved spatial attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Tomato_Spider_mites_Two-spotted_spider_mite_spatial.png
2025-04-15 16:43:49 | INFO     | core.visualization.attention_viz - Saved channel attention visualization to outputs/cbam_only_resnet18_v2/attention_visualizations/Tomato_Spider_mites_Two-spotted_spider_mite_channel.png
2025-04-15 16:43:51 | ERROR    | __main__ - Error generating visualization for class Tomato_Spider_mites_Two-spotted_spider_mite: 'NoneType' object is not iterable
2025-04-15 16:43:51 | INFO     | __main__ - Attention visualizations saved to outputs/cbam_only_resnet18_v2/attention_visualizations

=== Ended: 2025-04-15T17:26:15Z ===
